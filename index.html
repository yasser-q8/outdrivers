<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠÙŠÙ† - Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ© (Ø¨Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø³Ù†ÙˆØ§Øª)</title>
    <link rel="icon" href="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" type="image/jpeg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø£ØµÙ„ÙŠØ© ÙƒÙ…Ø§ Ù‡ÙŠ (Ù„Ù… ÙŠØªÙ… Ø­Ø°Ù Ø£ÙŠ Ø´ÙŠØ¡) */
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            direction: rtl;
            color: #333;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            padding: 25px;
        }
        
        .header {
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            margin: 0 0 15px 0;
            font-size: 28px;
        }
        
        .header p {
            margin: 0;
            opacity: 0.9;
            font-size: 16px;
        }
        
        .company-logo {
            position: absolute;
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid white;
            overflow: hidden;
        }
        
        .company-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .month-upload-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 2px dashed #d32f2f;
        }
        
        .upload-section {
            background: #e8f5e9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 2px dashed #4caf50;
            text-align: center;
        }
        
        .upload-btn {
            background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }
        
        .upload-btn:hover {
            background: linear-gradient(135deg, #c62828 0%, #b71c1c 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(211, 47, 47, 0.4);
        }
        
        .month-upload-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .month-upload-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
            background: white;
            padding: 12px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .month-label {
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
        }
        
        .year-input {
            width: 100%;
            padding: 6px;
            border: 1px solid #ccc;
            border-radius: 4px;
            text-align: center;
            font-size: 14px;
        }
        
        .month-upload-btn {
            background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);
            color: white;
            border: none;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            font-size: 14px;
        }
        
        .month-upload-btn:hover {
            background: linear-gradient(135deg, #388e3c 0%, #1b5e20 100%);
            transform: translateY(-2px);
        }
        
        .month-upload-btn.uploaded {
            background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%);
        }
        
        .all-months-btn {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            grid-column: span 4;
            margin-top: 10px;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: linear-gradient(135deg, #5856d6 0%, #4a47d1 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 15px;
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(88, 86, 214, 0.4);
        }
        
        .control-btn.pdf-btn {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #5ac8fa 0%, #007aff 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,122,255,0.2);
            animation: float 3s ease-in-out infinite;
        }
        
        .stat-card:nth-child(2) {
            animation-delay: 0.2s;
            background: linear-gradient(135deg, #ff2d55 0%, #d5006d 100%);
        }
        
        .stat-card:nth-child(3) {
            animation-delay: 0.4s;
            background: linear-gradient(135deg, #ff9500 0%, #ff5e3a 100%);
        }
        
        .stat-card:nth-child(4) {
            animation-delay: 0.6s;
            background: linear-gradient(135deg, #4cd964 0%, #2ba245 100%);
        }
        
        .stat-card:nth-child(5) {
            animation-delay: 0.8s;
            background: linear-gradient(135deg, #5856d6 0%, #3634a3 100%);
        }
        
        .stat-card:nth-child(6) {
            animation-delay: 1s;
            background: linear-gradient(135deg, #ffcc00 0%, #ff9500 100%);
        }
        
        .stat-card h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            opacity: 0.9;
        }
        
        .stat-card .value {
            font-size: 28px;
            font-weight: bold;
            margin: 0;
        }
        
        .search-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        
        .search-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .search-input {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            width: 100%;
            transition: border-color 0.3s;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #d32f2f;
        }
        
        .search-btn {
            background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            transition: all 0.3s;
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(211, 47, 47, 0.4);
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .report-table th {
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 15px;
            position: sticky;
            top: 0;
        }
        
        .report-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
            text-align: center;
            font-size: 14px;
        }
        
        .report-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .report-table tr:hover {
            background-color: #ffebee;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #d32f2f;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .error {
            background: #ff3b30;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 25px;
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .tab:hover {
            background: #e0e0e0;
        }
        
        .tab.active {
            background: white;
            border-bottom: 3px solid #d32f2f;
            color: #d32f2f;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .detailed-report {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .detailed-report::-webkit-scrollbar {
            width: 8px;
        }
        
        .detailed-report::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .detailed-report::-webkit-scrollbar-thumb {
            background: #d32f2f;
            border-radius: 4px;
        }
        
        .detailed-report::-webkit-scrollbar-thumb:hover {
            background: #b71c1c;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            background: #f8f9fa;
            border-radius: 10px;
            color: #666;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .page-btn {
            background: #f0f0f0;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .page-btn:hover {
            background: #d32f2f;
            color: white;
        }
        
        .page-btn.active {
            background: #d32f2f;
            color: white;
        }
        
        .comparison-section {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        
        .period-checkboxes {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin: 15px 0;
            max-height: 200px;
            overflow-y: auto;
            padding: 10px;
            background: white;
            border-radius: 8px;
        }
        
        .period-checkbox {
            display: flex;
            align-items: center;
            gap: 5px;
            font-size: 13px;
        }
        
        .comparison-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .comparison-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .comparison-table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #424242 0%, #212121 100%);
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: 600;
            font-size: 14px;
            border: 1px solid #ddd;
        }
        
        .comparison-table td {
            padding: 10px 12px;
            border: 1px solid #e0e0e0;
            text-align: center;
            font-size: 13px;
        }
        
        .comparison-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .comparison-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .comparison-table .month-header {
            background: linear-gradient(135deg, #5c6bc0 0%, #3949ab 100%);
            color: white;
            font-weight: bold;
        }
        
        .comparison-table .total-row {
            background: linear-gradient(135deg, #ffcc80 0%, #ffb74d 100%);
            font-weight: bold;
        }
        
        .comparison-table .manager-total {
            background: #e8eaf6;
            font-weight: bold;
        }
        
        .restaurant-comparison-table-container {
            overflow-x: auto;
            margin-top: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .restaurant-comparison-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }
        
        .restaurant-comparison-table th {
            background: linear-gradient(135deg, #388e3c 0%, #2e7d32 100%);
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: 600;
            font-size: 13px;
            border: 1px solid #ddd;
        }
        
        .restaurant-comparison-table td {
            padding: 10px 12px;
            border: 1px solid #e0e0e0;
            text-align: center;
            font-size: 12px;
        }
        
        .restaurant-comparison-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .restaurant-comparison-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .restaurant-comparison-table .restaurant-name {
            font-weight: bold;
            background: #f0f0f0;
            text-align: right;
            padding-right: 20px;
        }
        
        .restaurant-comparison-table .month-column {
            background: #e3f2fd;
            font-weight: bold;
        }
        
        .restaurant-comparison-table .car-salary {
            background: #fff3e0;
            font-weight: bold;
        }
        
        .restaurant-comparison-table .bike-salary {
            background: #e8f5e9;
            font-weight: bold;
        }
        
        .restaurant-comparison-table .restaurant-total {
            background: #f3e5f5;
            font-weight: bold;
        }
        
        .restaurant-comparison-table .grand-total {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
            font-weight: bold;
        }
        
        .manager-selector {
            margin: 15px 0;
            text-align: center;
        }
        
        .manager-select {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            min-width: 200px;
            background: white;
            cursor: pointer;
        }
        
        .manager-select:focus {
            outline: none;
            border-color: #d32f2f;
        }
        
        @media (max-width: 768px) {
            .month-upload-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .all-months-btn {
                grid-column: span 2;
            }
            
            .period-checkboxes {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .report-table {
                display: block;
                overflow-x: auto;
            }
            
            .company-logo {
                position: relative;
                left: 0;
                top: 0;
                transform: none;
                margin: 0 auto 15px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                padding: 12px;
                font-size: 14px;
            }
            
            .comparison-table, .restaurant-comparison-table {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="company-logo">
                <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" alt="Ø´Ø¹Ø§Ø± Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©">
            </div>
            <h1>ğŸ“Š Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠÙŠÙ† (Ø¨Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø³Ù†ÙˆØ§Øª)</h1>
            <p>Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ© | Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† ÙˆØ§Ù„Ù…Ø·Ø§Ø¹Ù…</p>
        </div>
        
        <div class="month-upload-section">
            <h3 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">ğŸ“… ØªØ­Ù…ÙŠÙ„ Ù…Ù„ÙØ§Øª Ø§Ù„Ø£Ø´Ù‡Ø± Ù…Ø¹ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ø³Ù†Ø©</h3>
            <div class="month-upload-grid" id="monthUploadGrid">
                <!-- ÙŠØªÙ… ØªÙˆÙ„ÙŠØ¯ Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø¹Ø¨Ø± JavaScript -->
            </div>
            <button class="month-upload-btn all-months-btn" onclick="loadAllPeriods()">ğŸ“Š ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
        </div>
        
        <div id="loading" class="loading">
            <div class="loader"></div>
            <p>Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
        </div>
        
        <div id="error" class="error"></div>
        
        <div id="controls" style="display: none;">
            <!-- ØªØ­Ø³ÙŠÙ† Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„ØªÙ†Ù‚Ù„ -->
            <div class="tabs">
                <div class="tab active" onclick="switchTab('report')" style="background: linear-gradient(135deg, #5c6bc0 0%, #3949ab 100%); color: white; border-bottom: 3px solid #3949ab;">
                    ğŸ“‹ ØªÙ‚Ø±ÙŠØ± Ù…ÙˆØ¬Ø²
                </div>
                <div class="tab" onclick="switchTab('detailed')" style="background: linear-gradient(135deg, #42a5f5 0%, #1976d2 100%); color: white; border-bottom: 3px solid #1976d2;">
                    ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„
                </div>
                <div class="tab" onclick="switchTab('comparison')" style="background: linear-gradient(135deg, #66bb6a 0%, #388e3c 100%); color: white; border-bottom: 3px solid #388e3c;">
                    ğŸ“ˆ Ù…Ù‚Ø§Ø±Ù†Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©
                </div>
            </div>
            
            <div id="report-tab" class="tab-content active">
                <div class="controls">
                    <button class="control-btn" onclick="downloadExcel()">ğŸ“¥ ØªØµØ¯ÙŠØ± Excel</button>
                    <button class="control-btn pdf-btn" onclick="downloadPDFReport()">ğŸ“„ Ø­ÙØ¸ PDF</button>
                    <button class="control-btn" onclick="resetView()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                </div>
                
                <div id="stats" class="stats" style="display: none;"></div>
                
                <div id="reportContainer"></div>
            </div>
            
            <div id="detailed-tab" class="tab-content">
                <div class="controls">
                    <button class="control-btn" onclick="downloadExcel()">ğŸ“¥ ØªØµØ¯ÙŠØ± Excel</button>
                    <button class="control-btn pdf-btn" onclick="downloadDetailedPDF()">ğŸ“„ Ø­ÙØ¸ PDF Ù…ÙØµÙ„</button>
                    <button class="control-btn" onclick="resetView()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                </div>
                
                <div class="search-section">
                    <div class="search-grid">
                        <input type="text" id="searchCompany" class="search-input" placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©" oninput="searchData()">
                        <input type="text" id="searchDistributor" class="search-input" placeholder="ğŸ‘¤ Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹" oninput="searchData()">
                        <input type="text" id="searchVehicle" class="search-input" placeholder="ğŸš— Ø¨Ø­Ø« Ø¨Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø© (Ø³ÙŠØ§Ø±Ø©/Ø³ÙŠÙƒÙ„)" oninput="searchData()">
                        <input type="text" id="searchRestaurant" class="search-input" placeholder="ğŸª Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…" oninput="searchData()">
                        <input type="text" id="searchManager" class="search-input" placeholder="ğŸ‘¨â€ğŸ’¼ Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„" oninput="searchData()">
                    </div>
                    <button class="search-btn" onclick="searchData()">Ø¨Ø­Ø«</button>
                    <button class="search-btn" onclick="clearSearch()" style="background: #757575; margin-right: 10px;">Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«</button>
                </div>
                
                <div id="detailedReportContainer"></div>
            </div>
            
            <div id="comparison-tab" class="tab-content">
                <div class="comparison-section">
                    <h3 style="text-align: center; color: #2c3e50; margin-bottom: 15px;">Ù…Ù‚Ø§Ø±Ù†Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø¨ÙŠÙ† Ø§Ù„ÙØªØ±Ø§Øª (Ø´Ù‡Ø± + Ø³Ù†Ø©)</h3>
                    <p style="text-align: center; color: #666; margin-bottom: 15px;">Ø§Ø®ØªØ± Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ù…Ù‚Ø§Ø±Ù†ØªÙ‡Ø§:</p>
                    
                    <div id="periodCheckboxes" class="period-checkboxes">
                        <!-- ØªÙ…Ù„Ø£ Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ§Ù‹ Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø© -->
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="search-btn" onclick="compareSelectedPeriods()">Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</button>
                        <button class="search-btn" onclick="compareAllPeriods()" style="background: #ff9800;">Ù…Ù‚Ø§Ø±Ù†Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØªØ±Ø§Øª</button>
                        <button class="search-btn" onclick="generateComparisonTable()" style="background: #9c27b0;">ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨</button>
                        <button class="search-btn" onclick="downloadComparisonTablePDF()" style="background: #d32f2f;">ğŸ“„ ØªØµØ¯ÙŠØ± Ø¬Ø¯ÙˆÙ„ PDF (Ø£ÙÙ‚ÙŠ)</button>
                    </div>
                    
                    <div id="managerSelector" class="manager-selector" style="display: none;">
                        <select class="manager-select" id="managerSelect" onchange="generateRestaurantComparisonTable()">
                            <option value="">Ø§Ø®ØªØ± Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„</option>
                        </select>
                        <button class="search-btn" onclick="generateRestaurantComparisonTable()" style="margin-right: 10px; background: #5c6bc0;">ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</button>
                        <button class="search-btn" onclick="downloadRestaurantComparisonPDF()" style="background: #388e3c;">ğŸ“„ ØªØµØ¯ÙŠØ± Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø·Ø§Ø¹Ù… PDF</button>
                    </div>
                </div>
                
                <div id="comparisonResult"></div>
            </div>
        </div>
    </div>

    <!-- ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø·ÙˆØ± (Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø§Ø´Ø©) -->
    <div class="signature-card" style="text-align: center; margin-top: 20px; color: #d32f2f; font-size: 12px;">
        <span class="name">Yasser Elkhateeb</span> - <span class="title">Ù…Ø·ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ 67011143</span>
    </div>

    <script>
        // ==================== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© ====================
        let allData = [];                       // Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø³Ø·Ø­Ø©
        let periodData = {};                     // Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù‚Ø³Ù…Ø© Ø­Ø³Ø¨ Ø§Ù„ÙØªØ±Ø© (Ù…ÙØªØ§Ø­ = "Ø´Ù‡Ø± Ø³Ù†Ø©")
        let uploadedPeriods = {};                 // Ù„ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙØªØ±Ø§Øª Ø§Ù„Ù…Ø±ÙÙˆØ¹Ø© (Ù„Ù„Ø¹Ø±Ø¶)
        let currentPeriod = 'Ø§Ù„ÙƒÙ„';                // Ø§Ù„ÙØªØ±Ø© Ø§Ù„Ù…Ø¹Ø±ÙˆØ¶Ø© Ø­Ø§Ù„ÙŠØ§Ù‹
        let currentPage = 1;
        const itemsPerPage = 50;
        let filteredData = [];
        
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù… (ÙƒÙ…Ø§ Ù‡ÙŠ)
        const restaurantData = {
            "Ø§Ø³ÙˆØ§Ù‚ Ø§Ù„Ù‚Ø±ÙŠÙ†": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ© Ø¨Ù†Øª Ø§Ù„Ø¯ÙŠÙƒ": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ© ØªÙƒØ§ Ùˆ ÙØ±Ø§ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ - Ù„ÙŠØ§Ù„ÙŠ Ø§Ù„Ø´Ø±Ù‚": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ - Ù…Ø¬Ù…Ø¹ Ù…ÙƒØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ Ø§Ù„Ø²ÙˆÙŠØ®": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆØªÙ„ÙŠØª": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆÙŠØ§": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø®ÙŠÙˆÙ„": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø§Ù„Ø¯Ø³Ù…Ø© ÙˆØ¨Ù†ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø±": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„Ø±Ø­Ø§Ø¨": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„Ø±Ù‚Ø©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø§Ù„Ø±Ù‚Ø¹ÙŠ": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø±ÙŠ": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø³Ù†Ø¯Ø¨Ø§Ø¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø´Ø±Ù‚": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„Ø´ÙˆÙŠØ® ÙˆØ§Ø±Ù‡": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„Ø¶Ø¨Ø§Ø¹ÙŠØ©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø¹Ø§Ø±Ø¶ÙŠØ© Ø§Ù„Ø­Ø±ÙÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„ÙØ­Ø§Ø­ÙŠÙ„": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ© ÙØ±Ø¹ 2": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„ÙÙ†Ø·Ø§Ø³": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„ÙÙŠØ­Ø§Ø¡": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ù‚Ø§Ø¯Ø³ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ù…Ø·Ø§Ø±": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ù…Ù†Ù‚Ù": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ù†Ø§ÙÙˆØ±Ø©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø£Ø¨ÙˆØ­Ù„ÙŠÙØ©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡ Ø§Ù„ØªØ¹Ø§ÙˆÙ†ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø´Ù‡Ø¯Ø§Ø¡": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø¹Ø¯Ø§Ù† ÙˆØ§Ù„Ù‚ØµÙˆØ±": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù‚ÙŠØ±ÙˆØ§Ù†": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ÙˆÙØ±Ø©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø£Ø¨Ùˆ ÙØ·ÙŠØ±Ø©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø¬Ø§Ø¨Ø± Ø§Ù„Ø£Ø­Ù…Ø¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø­ÙˆÙ„ÙŠ Ø§Ù„ØªØ±ÙÙŠÙ‡ÙŠ": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø®ÙŠØ·Ø§Ù† Ø§Ù„Ø¹ØµÙŠÙ…ÙŠ": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø³Ù„ÙˆÙ‰": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ù„ÙŠØ¨": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø³ÙŠØ¯ ÙŠØ§Ø³ÙŠÙ†": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø´Ø±Ù‚ Ø§Ù„Ø§Ø­Ù…Ø¯ÙŠ": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø³Ø§Ù„Ù…": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø³Ø§Ù„Ù… - Ø§Ù„Ø¹Ø±ÙŠÙ†": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "ØºØ±Ø¨ Ø£Ø¨Ùˆ ÙØ·ÙŠØ±Ø© Ø§Ù„Ø­Ø±ÙÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "ÙƒØ¨Ø¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ù…Ø§Ø±ÙŠÙ†Ø§ Ù…ÙˆÙ„ - Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ø§Ø±ÙŠÙ†Ø§": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø§ÙÙ†ÙŠÙˆØ²": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ù…Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙˆØª": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ù…Ø¯ÙŠÙ†Ø© Ø³Ø¹Ø¯ Ø§Ù„Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ù…Ø¯ÙŠÙ†Ø© ØµØ¨Ø§Ø­ Ø§Ù„Ø§Ø­Ù…Ø¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ù…Ø´Ø±Ù": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ù…ÙˆÙ„ 360": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ù†Ø§Ø¯ÙŠ Ø§Ù„ØµÙ„ÙŠØ¨Ø®Ø§Øª": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ù‡Ø¯ÙŠØ©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù‚Ø±ÙŠÙ†": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ© Ø¨Ù†Øª Ø§Ù„Ø¯ÙŠÙƒ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ© ØªÙƒØ§ Ùˆ ÙØ±Ø§ÙŠØ¯ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ - Ù„ÙŠØ§Ù„ÙŠ Ø§Ù„Ø´Ø±Ù‚ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ - Ù…Ø¬Ù…Ø¹ Ù…ÙƒØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆØªÙ„ÙŠØª - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆÙŠØ§ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø®ÙŠÙˆÙ„ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø§Ù„Ø¯Ø³Ù…Ø© ÙˆØ¨Ù†ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø± - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„Ø±Ø­Ø§Ø¨ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„Ø±Ù‚Ø© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø§Ù„Ø±Ù‚Ø¹ÙŠ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø±ÙŠ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø³Ù†Ø¯Ø¨Ø§Ø¯ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø´Ø±Ù‚ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„Ø´ÙˆÙŠØ® ÙˆØ§Ø±Ù‡ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„Ø¶Ø¨Ø§Ø¹ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø¹Ø§Ø±Ø¶ÙŠØ© Ø§Ù„Ø­Ø±ÙÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„ÙØ­Ø§Ø­ÙŠÙ„ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ© ÙØ±Ø¹ 2 - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„ÙÙ†Ø·Ø§Ø³ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„ÙÙŠØ­Ø§Ø¡ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ù‚Ø§Ø¯Ø³ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ù…Ø·Ø§Ø± - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ù…Ù†Ù‚Ù - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ù†Ø§ÙÙˆØ±Ø© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø£Ø¨ÙˆØ­Ù„ÙŠÙØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡ Ø§Ù„ØªØ¹Ø§ÙˆÙ†ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø´Ù‡Ø¯Ø§Ø¡ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø¹Ø¯Ø§Ù† ÙˆØ§Ù„Ù‚ØµÙˆØ± - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù‚ÙŠØ±ÙˆØ§Ù† - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ÙˆÙØ±Ø© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø£Ø¨Ùˆ ÙØ·ÙŠØ±Ø© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø¬Ø§Ø¨Ø± Ø§Ù„Ø£Ø­Ù…Ø¯ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø­ÙˆÙ„ÙŠ Ø§Ù„ØªØ±ÙÙŠÙ‡ÙŠ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø®ÙŠØ·Ø§Ù† Ø§Ù„Ø¹ØµÙŠÙ…ÙŠ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø³Ù„ÙˆÙ‰ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ù„ÙŠØ¨ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø³ÙŠØ¯ ÙŠØ§Ø³ÙŠÙ† - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ† - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø´Ø±Ù‚ Ø§Ù„Ø§Ø­Ù…Ø¯ÙŠ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø³Ø§Ù„Ù… - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø³Ø§Ù„Ù… - Ø§Ù„Ø¹Ø±ÙŠÙ† - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "ØºØ±Ø¨ Ø£Ø¨Ùˆ ÙØ·ÙŠØ±Ø© Ø§Ù„Ø­Ø±ÙÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "ÙƒØ¨Ø¯ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ù…Ø§Ø±ÙŠÙ†Ø§ Ù…ÙˆÙ„ - Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ø§Ø±ÙŠÙ†Ø§ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø§ÙÙ†ÙŠÙˆØ² - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ù…Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙˆØª - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ù…Ø¯ÙŠÙ†Ø© Ø³Ø¹Ø¯ Ø§Ù„Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ù…Ø¯ÙŠÙ†Ø© ØµØ¨Ø§Ø­ Ø§Ù„Ø§Ø­Ù…Ø¯ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ù…Ø´Ø±Ù - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ù…ÙˆÙ„ 360 - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ù†Ø§Ø¯ÙŠ Ø§Ù„ØµÙ„ÙŠØ¨Ø®Ø§Øª - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ù‡Ø¯ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" }
        };

        // Ø¹Ù†Ø§ØµØ± DOM
        const loadingDiv = document.getElementById('loading');
        const errorDiv = document.getElementById('error');
        const controlsDiv = document.getElementById('controls');
        const reportContainer = document.getElementById('reportContainer');
        const detailedReportContainer = document.getElementById('detailedReportContainer');
        const statsDiv = document.getElementById('stats');
        const managerSelector = document.getElementById('managerSelector');
        const managerSelect = document.getElementById('managerSelect');
        const periodCheckboxesDiv = document.getElementById('periodCheckboxes');
        const monthUploadGrid = document.getElementById('monthUploadGrid');

        // Ø£Ø³Ù…Ø§Ø¡ Ø§Ù„Ø£Ø´Ù‡Ø± (Ù„Ø¥Ù†Ø´Ø§Ø¡ ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø±ÙØ¹)
        const monthNames = [
            'ÙŠÙ†Ø§ÙŠØ±', 'ÙØ¨Ø±Ø§ÙŠØ±', 'Ù…Ø§Ø±Ø³', 'Ø£Ø¨Ø±ÙŠÙ„', 'Ù…Ø§ÙŠÙˆ', 'ÙŠÙˆÙ†ÙŠÙˆ',
            'ÙŠÙˆÙ„ÙŠÙˆ', 'Ø£ØºØ³Ø·Ø³', 'Ø³Ø¨ØªÙ…Ø¨Ø±', 'Ø£ÙƒØªÙˆØ¨Ø±', 'Ù†ÙˆÙÙ…Ø¨Ø±', 'Ø¯ÙŠØ³Ù…Ø¨Ø±'
        ];

        // Ø¥Ù†Ø´Ø§Ø¡ Ø´Ø¨ÙƒØ© Ø±ÙØ¹ Ø§Ù„Ø£Ø´Ù‡Ø± Ù…Ø¹ Ø­Ù‚ÙˆÙ„ Ø§Ù„Ø³Ù†Ø©
        function initMonthUploadGrid() {
            let html = '';
            monthNames.forEach(month => {
                const monthId = month + 'File';
                html += `
                    <div class="month-upload-item">
                        <div class="month-label">${month}</div>
                        <input type="number" class="year-input" id="year-${month}" value="2025" min="2020" max="2030" step="1">
                        <input type="file" id="${monthId}" accept=".xlsx, .xls" style="display: none;" onchange="handlePeriodUpload('${month}', this)">
                        <button class="month-upload-btn" onclick="document.getElementById('${monthId}').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                    </div>
                `;
            });
            monthUploadGrid.innerHTML = html;
        }
        initMonthUploadGrid();

        // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
        let searchTimeout;
        const searchInputs = ['searchCompany', 'searchDistributor', 'searchVehicle', 'searchRestaurant', 'searchManager'];
        
        searchInputs.forEach(id => {
            document.getElementById(id).addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(searchData, 300);
            });
        });

        // ========== Ø¯ÙˆØ§Ù„ Ø±ÙØ¹ ÙˆÙ…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ù…Ù„ÙØ§Øª ==========
        async function handlePeriodUpload(month, input) {
            const file = input.files[0];
            if (!file) return;
            
            // Ø§Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø³Ù†Ø© Ù…Ù† Ø­Ù‚Ù„ Ø§Ù„Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ù…Ø¬Ø§ÙˆØ±
            const yearInput = document.getElementById(`year-${month}`);
            const year = yearInput.value;
            const periodKey = `${month} ${year}`;
            
            showLoading();
            hideError();
            
            try {
                const workbook = await readExcelFile(file);
                const data = await processMonthData(workbook, month); // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ­Ù…Ù„ Ø´Ù‡Ø± ÙÙ‚Ø· (Ù†Ø¶ÙŠÙ Ø§Ù„Ø³Ù†Ø© Ù„Ø§Ø­Ù‚Ø§Ù‹)
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø³Ù†Ø© Ù„ÙƒÙ„ Ø³Ø¬Ù„
                data.forEach(item => {
                    item.periodKey = periodKey;
                    item.year = year;
                    item.month = month;
                    // ÙŠÙ…ÙƒÙ† Ø§Ù„Ø§Ø­ØªÙØ§Ø¸ Ø¨Ø§Ù„Ø´Ù‡Ø± Ø§Ù„Ø£ØµÙ„ÙŠ ÙˆØ¹Ø±Ø¶ period ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
                });
                
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø±
                const button = input.previousElementSibling; // Ø§Ù„Ø²Ø± Ù‚Ø¨Ù„ hidden input
                button.classList.add('uploaded');
                button.textContent = 'âœ“ ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„';
                
                // ØªØ®Ø²ÙŠÙ† Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªØ­Øª Ø§Ù„Ù…ÙØªØ§Ø­ (Ø´Ù‡Ø± Ø³Ù†Ø©)
                periodData[periodKey] = data;
                uploadedPeriods[periodKey] = true;
                
                // Ø¯Ù…Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙƒÙ„ÙŠØ©
                updateAllData();
                
                // ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØªØ±Ø§Øª
                updatePeriodCheckboxes();
                
                // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø£ÙˆÙ„ Ù…Ù„Ù
                if (Object.keys(uploadedPeriods).length > 0 && controlsDiv.style.display === 'none') {
                    controlsDiv.style.display = 'block';
                    showReport('Ø§Ù„ÙƒÙ„');
                }
                
            } catch (error) {
                showError(`Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù ${month}: ${error.message}`);
            } finally {
                hideLoading();
            }
        }

        async function loadAllPeriods() {
            showLoading();
            hideError();
            
            try {
                if (Object.keys(periodData).length === 0) {
                    showError('ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ Ù…Ù„ÙØ§Øª Ø§Ù„ÙØªØ±Ø§Øª Ø£ÙˆÙ„Ø§Ù‹');
                    return;
                }
                
                updateAllData();
                showReport('Ø§Ù„ÙƒÙ„');
                
            } catch (error) {
                showError(`Ø­Ø¯Ø« Ø®Ø·Ø£: ${error.message}`);
            } finally {
                hideLoading();
            }
        }

        function readExcelFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        resolve(workbook);
                    } catch (error) {
                        reject(error);
                    }
                };
                
                reader.onerror = function() {
                    reject(new Error('ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù'));
                };
                
                reader.readAsArrayBuffer(file);
            });
        }

        async function processMonthData(workbook, month) {
            const monthData = [];
            
            workbook.SheetNames.forEach(sheetName => {
                if (sheetName.toLowerCase().includes('list')) return;
                
                const worksheet = workbook.Sheets[sheetName];
                const data = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                
                let companyName = '';
                if (data[1] && data[1][6]) {
                    companyName = String(data[1][6]).trim();
                    if (companyName) {
                        companyName = companyName.replace(/^\s*Ø´Ø±ÙƒØ©\s*/i, '').replace(/\s*Ø´Ø±ÙƒØ©\s*$/i, '').trim();
                    }
                }
                
                if (!companyName) {
                    for (let i = 0; i < Math.min(5, data.length); i++) {
                        for (let j = 0; j < data[i]?.length; j++) {
                            const cell = data[i][j];
                            if (typeof cell === 'string') {
                                const cellLower = cell.toLowerCase();
                                if ((cellLower.includes('Ø´Ø±ÙƒØ©') || cellLower.includes('Ù…Ø¤Ø³Ø³Ø©') || cellLower.includes('Ù…ÙƒØªØ¨')) && !cellLower.includes('Ù†Ø§ÙŠÙ')) {
                                    let extractedName = cell.trim();
                                    extractedName = extractedName.replace(/^\s*(Ø´Ø±ÙƒØ©|Ù…Ø¤Ø³Ø³Ø©|Ù…ÙƒØªØ¨)\s*/i, '').replace(/\s*(Ø´Ø±ÙƒØ©|Ù…Ø¤Ø³Ø³Ø©|Ù…ÙƒØªØ¨)\s*$/i, '').trim();
                                    if (extractedName !== '') {
                                        companyName = extractedName;
                                        break;
                                    }
                                }
                            }
                        }
                        if (companyName) break;
                    }
                }
                
                if (!companyName) companyName = sheetName;
                
                const startRow = findDataStartRow(data);
                if (startRow === -1) return;
                
                const headers = data[startRow];
                
                for (let i = startRow + 1; i < data.length; i++) {
                    const row = data[i];
                    if (!row || row.length < 2) continue;
                    
                    const distributorData = extractDistributorData(row, headers, companyName, month, sheetName);
                    if (distributorData && distributorData.Ø§Ø³Ù… && distributorData.Ø§Ø³Ù….trim() !== '') {
                        monthData.push(distributorData);
                    }
                }
            });
            
            return monthData;
        }

        function findDataStartRow(data) {
            for (let i = 0; i < Math.min(20, data.length); i++) {
                const row = data[i];
                if (!row) continue;
                for (let j = 0; j < Math.min(10, row.length); j++) {
                    const cell = row[j];
                    if (typeof cell === 'string') {
                        const cellLower = cell.toLowerCase();
                        if (cellLower.includes('Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹') || cellLower.includes('Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…')) {
                            return i;
                        }
                    }
                }
            }
            return -1;
        }

        function extractDistributorData(row, headers, companyName, month, sheetName) {
            if (!row[0] || String(row[0]).trim() === '') return null;
            
            const data = {
                Ø±Ù‚Ù…: '',
                Ø§Ø³Ù…: '',
                Ù…Ø·Ø¹Ù…: '',
                Ø§ÙŠØ§Ù…: 0,
                Ø³Ø§Ø¹Ø§Øª: 0,
                Ø±Ø§ØªØ¨: 0,
                Ø´Ø±ÙƒØ©: companyName,
                Ø´Ù‡Ø±: month,  // Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ù„Ø§Ø­Ù‚Ø§Ù‹ Ø¨Ø§Ù„ÙØªØ±Ø©
                Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©: 'Ø³ÙŠØ§Ø±Ø©',
                Ù…Ù„Ø§Ø­Ø¸Ø§Øª: '',
                Ø´ÙŠØª: sheetName,
                Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„: '',
                Ù…Ø¯ÙŠØ±_Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ''
            };
            
            const columnMap = {};
            headers.forEach((header, index) => {
                if (header && typeof header === 'string') {
                    const headerLower = header.toLowerCase().trim();
                    columnMap[headerLower] = index;
                }
            });
            
            data.Ø§Ø³Ù… = getCellValue(row, columnMap, ['Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹', 'Ø§Ø³Ù…', 'Ø§Ù„Ù…ÙˆØ²Ø¹', 'Ø§Ù„Ø§Ø³Ù…', 'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù']);
            data.Ù…Ø·Ø¹Ù… = getCellValue(row, columnMap, ['Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…', 'Ø§Ù„Ù…Ø·Ø¹Ù…', 'Ù…Ø·Ø¹Ù…', 'Ø§Ù„Ù…Ø·Ø¹Ù… / Ø§Ù„ÙØ±Ø¹']);
            
            const daysValue = getCellValue(row, columnMap, ['Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø¯ÙˆØ§Ù…', 'Ø£ÙŠØ§Ù… Ø§Ù„Ø¯ÙˆØ§Ù…', 'Ø§ÙŠØ§Ù…', 'Ø£ÙŠØ§Ù…', 'Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…', 'Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„']);
            if (daysValue && daysValue !== '' && !isNaN(parseFloat(daysValue))) {
                data.Ø§ÙŠØ§Ù… = parseFloat(daysValue);
            }
            
            const hoursValue = getCellValue(row, columnMap, ['Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª', 'Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„', 'Ø³Ø§Ø¹Ø§Øª', 'Ø§Ù„Ø³Ø§Ø¹Ø§Øª', 'Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª', 'Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„']);
            if (hoursValue && hoursValue !== '' && !isNaN(parseFloat(hoursValue))) {
                data.Ø³Ø§Ø¹Ø§Øª = parseFloat(hoursValue);
            }
            
            const salaryValue = getCellValue(row, columnMap, ['Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ù…Ø³ØªØ­Ù‚', 'Ø±Ø§ØªØ¨', 'Ø§Ù„Ø±Ø§ØªØ¨', 'Ø£Ø¬Ø± Ø§Ù„Ø³Ø§Ø¹Ø©', 'Ø§Ù„Ù…Ø³ØªØ­Ù‚', 'Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ']);
            if (salaryValue && salaryValue !== '' && !isNaN(parseFloat(salaryValue))) {
                data.Ø±Ø§ØªØ¨ = parseFloat(salaryValue);
            }
            
            data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© = getCellValue(row, columnMap, ['Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©', 'Ø§Ù„Ù…Ø±ÙƒØ¨Ø©', 'Ù†ÙˆØ¹', 'ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ù†Ù‚Ù„', 'Ù†ÙˆØ¹ ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ù†Ù‚Ù„']) || 'Ø³ÙŠØ§Ø±Ø©';
            data.Ù…Ù„Ø§Ø­Ø¸Ø§Øª = getCellValue(row, columnMap, ['Ù…Ù„Ø§Ø­Ø¸Ø§Øª', 'Ù…Ù„Ø§Ø­Ø¸Ø©']) || '';
            
            if (data.Ø§Ø³Ù…) data.Ø§Ø³Ù… = data.Ø§Ø³Ù….trim();
            if (data.Ù…Ø·Ø¹Ù…) {
                data.Ù…Ø·Ø¹Ù… = data.Ù…Ø·Ø¹Ù….trim();
                const restaurantInfo = restaurantData[data.Ù…Ø·Ø¹Ù…];
                if (restaurantInfo) {
                    data.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ = restaurantInfo.manager;
                    data.Ù…Ø¯ÙŠØ±_Ø§Ù„Ù…Ù†Ø·Ù‚Ø© = restaurantInfo.areaManager;
                }
            }
            if (data.Ø´Ø±ÙƒØ©) data.Ø´Ø±ÙƒØ© = data.Ø´Ø±ÙƒØ©.trim();
            
            if (data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.toLowerCase().includes('Ø³ÙŠÙƒÙ„') || data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.toLowerCase().includes('Ø¯Ø±Ø§Ø¬Ø©')) {
                data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© = 'Ø³ÙŠÙƒÙ„';
            } else if (data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.toLowerCase().includes('Ø³ÙŠØ§Ø±Ø©') || data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.toLowerCase().includes('Ù…Ø±ÙƒØ¨Ø©')) {
                data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© = 'Ø³ÙŠØ§Ø±Ø©';
            }
            
            return data;
        }

        function getCellValue(row, columnMap, possibleHeaders) {
            for (const header of possibleHeaders) {
                if (columnMap[header.toLowerCase()] !== undefined) {
                    const value = row[columnMap[header.toLowerCase()]];
                    if (value !== undefined && value !== null && value !== '') {
                        return String(value).trim();
                    }
                }
            }
            return '';
        }

        function updateAllData() {
            allData = [];
            Object.values(periodData).forEach(periodDataArray => {
                allData = [...allData, ...periodDataArray];
            });
        }

        // ØªØ­Ø¯ÙŠØ« Ù…Ø±Ø¨Ø¹Ø§Øª Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙØªØ±Ø§Øª
        function updatePeriodCheckboxes() {
            const periods = Object.keys(periodData).sort();
            let html = '';
            periods.forEach(period => {
                html += `
                    <label class="period-checkbox">
                        <input type="checkbox" value="${period}" class="compare-period"> ${period}
                    </label>
                `;
            });
            periodCheckboxesDiv.innerHTML = html;
        }

        // Ø¯ÙˆØ§Ù„ Ø¹Ø±Ø¶ Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ±
        function showReport(period) {
            currentPeriod = period;
            if (period === 'Ø§Ù„ÙƒÙ„') {
                filteredData = allData;
            } else {
                filteredData = periodData[period] || [];
            }
            
            displayReport(filteredData);
            updateStats(filteredData, period);
            
            if (document.getElementById('detailed-tab').classList.contains('active')) {
                currentPage = 1;
                updateDetailedReport(filteredData);
            }
        }

        function displayReport(data) {
            if (data.length === 0) {
                reportContainer.innerHTML = `<div class="no-data"><h3>âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</h3></div>`;
                return;
            }
            
            let html = `
                <div style="margin-bottom: 20px; text-align: center;">
                    <h3>ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± ${currentPeriod === 'Ø§Ù„ÙƒÙ„' ? 'Ø§Ù„Ù…Ø¬Ù…Ø¹' : 'Ù„Ù„ÙØªØ±Ø© ' + currentPeriod}</h3>
                    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ ${data.length} Ø³Ø¬Ù„</p>
                </div>
                <div class="detailed-report">
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Ù…</th><th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹</th><th>Ø§Ù„Ù…Ø·Ø¹Ù…</th><th>Ø£ÙŠØ§Ù…</th><th>Ø³Ø§Ø¹Ø§Øª</th>
                                <th>Ø§Ù„Ø±Ø§ØªØ¨</th><th>Ø§Ù„Ø´Ø±ÙƒØ©</th><th>Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</th><th>Ø§Ù„ÙØªØ±Ø©</th><th>Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            data.slice(0, 100).forEach((item, idx) => {
                html += `<tr>
                    <td>${idx+1}</td>
                    <td>${item.Ø§Ø³Ù… || ''}</td>
                    <td>${item.Ù…Ø·Ø¹Ù… || ''}</td>
                    <td>${item.Ø§ÙŠØ§Ù… || ''}</td>
                    <td>${item.Ø³Ø§Ø¹Ø§Øª || ''}</td>
                    <td>${item.Ø±Ø§ØªØ¨ ? item.Ø±Ø§ØªØ¨.toFixed(3) : ''}</td>
                    <td>${item.Ø´Ø±ÙƒØ© || ''}</td>
                    <td>${item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© || ''}</td>
                    <td>${item.periodKey || item.Ø´Ù‡Ø±}</td>
                    <td>${item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ || ''}</td>
                </tr>`;
            });
            
            html += `</tbody></table></div>`;
            if (data.length > 100) html += `<p>ÙŠØªÙ… Ø¹Ø±Ø¶ Ø£ÙˆÙ„ 100 Ø³Ø¬Ù„</p>`;
            reportContainer.innerHTML = html;
        }

        function updateDetailedReport(data) {
            if (data.length === 0) {
                detailedReportContainer.innerHTML = `<div class="no-data"><h3>âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</h3></div>`;
                return;
            }
            
            const start = (currentPage - 1) * itemsPerPage;
            const end = Math.min(start + itemsPerPage, data.length);
            const pageData = data.slice(start, end);
            
            let html = `
                <div style="margin-bottom:20px; text-align:center;">
                    <h3>ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙØµÙ„ - ${currentPeriod === 'Ø§Ù„ÙƒÙ„' ? 'Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØªØ±Ø§Øª' : currentPeriod}</h3>
                    <p>Ø¹Ø±Ø¶ ${start+1} Ø¥Ù„Ù‰ ${end} Ù…Ù† ${data.length}</p>
                </div>
                <div class="detailed-report">
                    <table class="report-table">
                        <thead><tr>
                            <th>Ù…</th><th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹</th><th>Ø§Ù„Ù…Ø·Ø¹Ù…</th><th>Ø£ÙŠØ§Ù…</th><th>Ø³Ø§Ø¹Ø§Øª</th>
                            <th>Ø§Ù„Ø±Ø§ØªØ¨</th><th>Ø§Ù„Ø´Ø±ÙƒØ©</th><th>Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</th><th>Ø§Ù„ÙØªØ±Ø©</th><th>Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„</th><th>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th>
                        </tr></thead>
                        <tbody>
            `;
            
            pageData.forEach((item, idx) => {
                html += `<tr>
                    <td>${start + idx + 1}</td>
                    <td><strong>${item.Ø§Ø³Ù… || ''}</strong></td>
                    <td>${item.Ù…Ø·Ø¹Ù… || ''}</td>
                    <td><span style="color:#1976d2;">${item.Ø§ÙŠØ§Ù… || ''}</span></td>
                    <td><span style="color:#388e3c;">${item.Ø³Ø§Ø¹Ø§Øª || ''}</span></td>
                    <td><strong style="color:#d32f2f;">${item.Ø±Ø§ØªØ¨ ? item.Ø±Ø§ØªØ¨.toFixed(3) : ''}</strong></td>
                    <td>${item.Ø´Ø±ÙƒØ© || ''}</td>
                    <td>${item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„' ? 'ğŸš² Ø³ÙŠÙƒÙ„' : 'ğŸš— Ø³ÙŠØ§Ø±Ø©'}</td>
                    <td>${item.periodKey || item.Ø´Ù‡Ø±}</td>
                    <td>${item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ || ''}</td>
                    <td>${item.Ù…Ø¯ÙŠØ±_Ø§Ù„Ù…Ù†Ø·Ù‚Ø© || ''}</td>
                </tr>`;
            });
            
            html += `</tbody></table></div>`;
            
            const totalPages = Math.ceil(data.length / itemsPerPage);
            if (totalPages > 1) {
                html += `<div class="pagination">`;
                if (currentPage > 1) html += `<button class="page-btn" onclick="changePage(1)">Ø§Ù„Ø£ÙˆÙ„Ù‰</button>`;
                for (let i = Math.max(1, currentPage-2); i <= Math.min(totalPages, currentPage+2); i++) {
                    html += `<button class="page-btn ${i===currentPage?'active':''}" onclick="changePage(${i})">${i}</button>`;
                }
                if (currentPage < totalPages) html += `<button class="page-btn" onclick="changePage(${currentPage+1})">Ø§Ù„ØªØ§Ù„ÙŠ</button>`;
                html += `</div>`;
            }
            
            detailedReportContainer.innerHTML = html;
        }

        function changePage(page) {
            currentPage = page;
            updateDetailedReport(filteredData);
        }

        function updateStats(data, period) {
            if (!statsDiv || data.length === 0) { statsDiv.style.display = 'none'; return; }
            
            const totalEmployees = data.length;
            const totalDays = data.reduce((s, i) => s + (i.Ø§ÙŠØ§Ù… || 0), 0);
            const totalHours = data.reduce((s, i) => s + (i.Ø³Ø§Ø¹Ø§Øª || 0), 0);
            const totalSalary = data.reduce((s, i) => s + (i.Ø±Ø§ØªØ¨ || 0), 0);
            const avgSalary = totalEmployees ? totalSalary / totalEmployees : 0;
            const uniqueCompanies = new Set(data.map(i => i.Ø´Ø±ÙƒØ©).filter(Boolean)).size;
            const uniqueRestaurants = new Set(data.map(i => i.Ù…Ø·Ø¹Ù…).filter(Boolean)).size;
            const cars = data.filter(i => i.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©').length;
            const bikes = data.filter(i => i.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„').length;
            const uniqueManagers = new Set(data.map(i => i.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„).filter(Boolean)).size;
            
            statsDiv.innerHTML = `
                <div class="stat-card"><h3>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†</h3><p class="value">${totalEmployees}</p></div>
                <div class="stat-card"><h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„</h3><p class="value">${totalDays}</p></div>
                <div class="stat-card"><h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</h3><p class="value">${totalHours}</p></div>
                <div class="stat-card"><h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</h3><p class="value">${totalSalary.toFixed(3)}</p></div>
                <div class="stat-card"><h3>Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø§ØªØ¨</h3><p class="value">${avgSalary.toFixed(3)}</p></div>
                <div class="stat-card"><h3>Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø±ÙƒØ§Øª</h3><p class="value">${uniqueCompanies}</p></div>
                <div class="stat-card"><h3>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</h3><p class="value">${uniqueRestaurants}</p></div>
                <div class="stat-card"><h3>Ø³ÙŠØ§Ø±Ø§Øª ğŸš—</h3><p class="value">${cars}</p></div>
                <div class="stat-card"><h3>Ø³ÙŠÙƒÙ„ ğŸš²</h3><p class="value">${bikes}</p></div>
                <div class="stat-card"><h3>Ø¹Ø¯Ø¯ Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„</h3><p class="value">${uniqueManagers}</p></div>
            `;
            statsDiv.style.display = 'grid';
        }

        function searchData() {
            const company = document.getElementById('searchCompany').value.toLowerCase();
            const distributor = document.getElementById('searchDistributor').value.toLowerCase();
            const vehicle = document.getElementById('searchVehicle').value.toLowerCase();
            const restaurant = document.getElementById('searchRestaurant').value.toLowerCase();
            const manager = document.getElementById('searchManager').value.toLowerCase();
            
            let dataToFilter = currentPeriod === 'Ø§Ù„ÙƒÙ„' ? allData : (periodData[currentPeriod] || []);
            
            filteredData = dataToFilter.filter(item => {
                let match = true;
                if (company && item.Ø´Ø±ÙƒØ©) match = match && item.Ø´Ø±ÙƒØ©.toLowerCase().includes(company);
                if (distributor && item.Ø§Ø³Ù…) match = match && item.Ø§Ø³Ù….toLowerCase().includes(distributor);
                if (vehicle && item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©) match = match && item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.toLowerCase().includes(vehicle);
                if (restaurant && item.Ù…Ø·Ø¹Ù…) match = match && item.Ù…Ø·Ø¹Ù….toLowerCase().includes(restaurant);
                if (manager && item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„) match = match && item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„.toLowerCase().includes(manager);
                return match;
            });
            
            currentPage = 1;
            updateDetailedReport(filteredData);
            updateStats(filteredData, currentPeriod);
        }

        function clearSearch() {
            document.querySelectorAll('.search-input').forEach(inp => inp.value = '');
            filteredData = currentPeriod === 'Ø§Ù„ÙƒÙ„' ? allData : (periodData[currentPeriod] || []);
            currentPage = 1;
            updateDetailedReport(filteredData);
            updateStats(filteredData, currentPeriod);
        }

        // Ø¯ÙˆØ§Ù„ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© (ØªØ¹Ù…Ù„ Ù…Ø¹ Ø§Ù„ÙØªØ±Ø§Øª)
        function compareSelectedPeriods() {
            const selected = Array.from(document.querySelectorAll('.compare-period:checked')).map(cb => cb.value);
            if (selected.length < 2) { alert('Ø§Ø®ØªØ± ÙØªØ±ØªÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„'); return; }
            showPeriodComparison(selected);
        }

        function compareAllPeriods() {
            const all = Object.keys(periodData);
            if (all.length < 2) { alert('ÙŠØ¬Ø¨ ØªØ­Ù…ÙŠÙ„ ÙØªØ±ØªÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„'); return; }
            document.querySelectorAll('.compare-period').forEach(cb => cb.checked = true);
            showPeriodComparison(all);
        }

        function showPeriodComparison(periods) {
            const compDiv = document.getElementById('comparisonResult');
            let html = `<div class="comparison-results">`;
            periods.forEach(p => {
                const data = periodData[p] || [];
                const st = calculateMonthStats(data);
                html += `<div class="comparison-card"><h4>${p}</h4>
                    <p>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†: ${st.totalEmployees}</p>
                    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨: ${st.totalSalary.toFixed(3)}</p>
                    <p>Ø³ÙŠØ§Ø±Ø§Øª: ${st.cars} / Ø³ÙŠÙƒÙ„: ${st.bikes}</p>
                </div>`;
            });
            html += `</div>`;
            if (periods.length > 1) {
                const all = periods.flatMap(p => periodData[p] || []);
                const tot = calculateMonthStats(all);
                html += `<div style="background:#fff8e1; padding:20px; margin-top:20px;">
                    <h4>ğŸ“ˆ Ø¥Ø¬Ù…Ø§Ù„ÙŠ ${periods.length} ÙØªØ±Ø©</h4>
                    <p>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨: ${tot.totalSalary.toFixed(3)} | Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†: ${tot.totalEmployees}</p>
                </div>`;
            }
            compDiv.innerHTML = html;
        }

        // Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨ (Ø­Ø³Ø¨ Ø§Ù„Ù…Ø¯Ø±Ø§Ø¡)
        function generateComparisonTable() {
            const selectedPeriods = Array.from(document.querySelectorAll('.compare-period:checked')).map(cb => cb.value);
            if (selectedPeriods.length === 0) { alert('Ø§Ø®ØªØ± ÙØªØ±Ø§Øª Ø£ÙˆÙ„Ø§Ù‹'); return; }
            
            const compDiv = document.getElementById('comparisonResult');
            const managerStats = {};
            const allManagers = new Set();
            
            selectedPeriods.forEach(period => {
                const data = periodData[period] || [];
                managerStats[period] = {};
                data.forEach(item => {
                    const mgr = item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                    allManagers.add(mgr);
                    if (!managerStats[period][mgr]) {
                        managerStats[period][mgr] = { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                    }
                    if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©') managerStats[period][mgr].carSalary += item.Ø±Ø§ØªØ¨ || 0;
                    else if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„') managerStats[period][mgr].bikeSalary += item.Ø±Ø§ØªØ¨ || 0;
                    managerStats[period][mgr].totalSalary += item.Ø±Ø§ØªØ¨ || 0;
                    managerStats[period][mgr].employees++;
                });
            });
            
            updateManagerSelector(Array.from(allManagers).filter(m => m && m !== 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'));
            
            let html = `<div style="margin-top:30px;"><h3 style="text-align:center;">ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨</h3>
                <div class="comparison-table-container"><table class="comparison-table"><thead>
                <tr><th rowspan="2">Ø§Ù„ÙØªØ±Ø©</th><th colspan="3">Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ</th><th colspan="3">Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡</th><th colspan="3">Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰</th><th colspan="4">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th></tr>
                <tr><th>Ø³ÙŠØ§Ø±Ø§Øª</th><th>Ø³ÙŠÙƒÙ„</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th>Ø³ÙŠØ§Ø±Ø§Øª</th><th>Ø³ÙŠÙƒÙ„</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th>Ø³ÙŠØ§Ø±Ø§Øª</th><th>Ø³ÙŠÙƒÙ„</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th>Ø³ÙŠØ§Ø±Ø§Øª</th><th>Ø³ÙŠÙƒÙ„</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th>Ø¹Ø¯Ø¯</th></tr>
                </thead><tbody>`;
            
            selectedPeriods.forEach(period => {
                const t = managerStats[period]['Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ'] || { carSalary:0, bikeSalary:0, totalSalary:0 };
                const h = managerStats[period]['Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡'] || { carSalary:0, bikeSalary:0, totalSalary:0 };
                const m = managerStats[period]['Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰'] || { carSalary:0, bikeSalary:0, totalSalary:0 };
                const totCar = t.carSalary + h.carSalary + m.carSalary;
                const totBike = t.bikeSalary + h.bikeSalary + m.bikeSalary;
                const totAll = totCar + totBike;
                const totEmp = (t.employees || 0) + (h.employees || 0) + (m.employees || 0);
                html += `<tr><td>${period}</td>
                    <td>${t.carSalary.toFixed(3)}</td><td>${t.bikeSalary.toFixed(3)}</td><td>${t.totalSalary.toFixed(3)}</td>
                    <td>${h.carSalary.toFixed(3)}</td><td>${h.bikeSalary.toFixed(3)}</td><td>${h.totalSalary.toFixed(3)}</td>
                    <td>${m.carSalary.toFixed(3)}</td><td>${m.bikeSalary.toFixed(3)}</td><td>${m.totalSalary.toFixed(3)}</td>
                    <td>${totCar.toFixed(3)}</td><td>${totBike.toFixed(3)}</td><td>${totAll.toFixed(3)}</td><td>${totEmp}</td></tr>`;
            });
            
            if (selectedPeriods.length > 1) {
                // Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙ„ÙŠ
                let sumTcar=0, sumTbike=0, sumTsal=0, sumHcar=0, sumHbike=0, sumHsal=0, sumMcar=0, sumMbike=0, sumMsal=0, sumEmp=0;
                selectedPeriods.forEach(p => {
                    const t = managerStats[p]['Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ'] || { carSalary:0, bikeSalary:0, totalSalary:0, employees:0 };
                    const h = managerStats[p]['Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡'] || { carSalary:0, bikeSalary:0, totalSalary:0, employees:0 };
                    const m = managerStats[p]['Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰'] || { carSalary:0, bikeSalary:0, totalSalary:0, employees:0 };
                    sumTcar += t.carSalary; sumTbike += t.bikeSalary; sumTsal += t.totalSalary;
                    sumHcar += h.carSalary; sumHbike += h.bikeSalary; sumHsal += h.totalSalary;
                    sumMcar += m.carSalary; sumMbike += m.bikeSalary; sumMsal += m.totalSalary;
                    sumEmp += (t.employees + h.employees + m.employees);
                });
                const grandCar = sumTcar+sumHcar+sumMcar;
                const grandBike = sumTbike+sumHbike+sumMbike;
                const grandAll = grandCar+grandBike;
                html += `<tr class="total-row"><td>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</td>
                    <td>${sumTcar.toFixed(3)}</td><td>${sumTbike.toFixed(3)}</td><td>${sumTsal.toFixed(3)}</td>
                    <td>${sumHcar.toFixed(3)}</td><td>${sumHbike.toFixed(3)}</td><td>${sumHsal.toFixed(3)}</td>
                    <td>${sumMcar.toFixed(3)}</td><td>${sumMbike.toFixed(3)}</td><td>${sumMsal.toFixed(3)}</td>
                    <td>${grandCar.toFixed(3)}</td><td>${grandBike.toFixed(3)}</td><td>${grandAll.toFixed(3)}</td><td>${sumEmp}</td></tr>`;
            }
            
            html += `</tbody></table></div></div>`;
            compDiv.innerHTML = html;
        }

        function updateManagerSelector(managers) {
            managerSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„</option>';
            managers.forEach(m => managerSelect.innerHTML += `<option value="${m}">${m}</option>`);
            managerSelector.style.display = 'block';
        }

        function generateRestaurantComparisonTable() {
            const selectedManager = managerSelect.value;
            if (!selectedManager) { alert('Ø§Ø®ØªØ± Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„'); return; }
            const selectedPeriods = Array.from(document.querySelectorAll('.compare-period:checked')).map(cb => cb.value);
            if (selectedPeriods.length === 0) { alert('Ø§Ø®ØªØ± ÙØªØ±Ø§Øª Ø£ÙˆÙ„Ø§Ù‹'); return; }
            
            const compDiv = document.getElementById('comparisonResult');
            const restaurantStats = {};
            const allRestaurants = new Set();
            
            selectedPeriods.forEach(period => {
                const data = periodData[period] || [];
                restaurantStats[period] = {};
                data.filter(item => item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ === selectedManager).forEach(item => {
                    const rest = item.Ù…Ø·Ø¹Ù… || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                    allRestaurants.add(rest);
                    if (!restaurantStats[period][rest]) {
                        restaurantStats[period][rest] = { carSalary:0, bikeSalary:0, totalSalary:0, employees:0 };
                    }
                    if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©') restaurantStats[period][rest].carSalary += item.Ø±Ø§ØªØ¨ || 0;
                    else if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„') restaurantStats[period][rest].bikeSalary += item.Ø±Ø§ØªØ¨ || 0;
                    restaurantStats[period][rest].totalSalary += item.Ø±Ø§ØªØ¨ || 0;
                });
            });
            
            let html = `<div style="margin-top:30px;"><h3 style="text-align:center;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø±ÙˆØ§ØªØ¨ Ù…Ø·Ø§Ø¹Ù… ${selectedManager}</h3>
                <div class="restaurant-comparison-table-container"><table class="restaurant-comparison-table"><thead><tr>
                <th>Ø§Ù„Ù…Ø·Ø¹Ù…</th>`;
            selectedPeriods.forEach(p => html += `<th colspan="2">${p}</th>`);
            html += `<th colspan="3">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th></tr><tr><th></th>`;
            selectedPeriods.forEach(() => html += `<th>Ø³ÙŠØ§Ø±Ø§Øª</th><th>Ø³ÙŠÙƒÙ„</th>`);
            html += `<th>Ø³ÙŠØ§Ø±Ø§Øª</th><th>Ø³ÙŠÙƒÙ„</th><th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th></tr></thead><tbody>`;
            
            const monthlyTotals = {};
            selectedPeriods.forEach(p => monthlyTotals[p] = { carSalary:0, bikeSalary:0 });
            
            Array.from(allRestaurants).filter(r => r !== 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ').forEach(rest => {
                let restCar=0, restBike=0;
                html += `<tr><td class="restaurant-name">${rest}</td>`;
                selectedPeriods.forEach(p => {
                    const st = restaurantStats[p][rest] || { carSalary:0, bikeSalary:0 };
                    html += `<td>${st.carSalary.toFixed(3)}</td><td>${st.bikeSalary.toFixed(3)}</td>`;
                    monthlyTotals[p].carSalary += st.carSalary;
                    monthlyTotals[p].bikeSalary += st.bikeSalary;
                    restCar += st.carSalary; restBike += st.bikeSalary;
                });
                html += `<td>${restCar.toFixed(3)}</td><td>${restBike.toFixed(3)}</td><td>${(restCar+restBike).toFixed(3)}</td></tr>`;
            });
            
            html += `<tr class="grand-total"><td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´Ù‡Ø±</td>`;
            let totalCar=0, totalBike=0;
            selectedPeriods.forEach(p => {
                html += `<td>${monthlyTotals[p].carSalary.toFixed(3)}</td><td>${monthlyTotals[p].bikeSalary.toFixed(3)}</td>`;
                totalCar += monthlyTotals[p].carSalary;
                totalBike += monthlyTotals[p].bikeSalary;
            });
            html += `<td>${totalCar.toFixed(3)}</td><td>${totalBike.toFixed(3)}</td><td>${(totalCar+totalBike).toFixed(3)}</td></tr>`;
            html += `</tbody></table></div></div>`;
            compDiv.innerHTML = html;
        }

        function calculateMonthStats(data) {
            const totalEmployees = data.length;
            const totalDays = data.reduce((s,i) => s+(i.Ø§ÙŠØ§Ù…||0),0);
            const totalHours = data.reduce((s,i) => s+(i.Ø³Ø§Ø¹Ø§Øª||0),0);
            const totalSalary = data.reduce((s,i) => s+(i.Ø±Ø§ØªØ¨||0),0);
            const avgSalary = totalEmployees ? totalSalary/totalEmployees : 0;
            const uniqueCompanies = new Set(data.map(i=>i.Ø´Ø±ÙƒØ©).filter(Boolean)).size;
            const uniqueRestaurants = new Set(data.map(i=>i.Ù…Ø·Ø¹Ù…).filter(Boolean)).size;
            const cars = data.filter(i=>i.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©==='Ø³ÙŠØ§Ø±Ø©').length;
            const bikes = data.filter(i=>i.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©==='Ø³ÙŠÙƒÙ„').length;
            const uniqueManagers = new Set(data.map(i=>i.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„).filter(Boolean)).size;
            return { totalEmployees, totalDays, totalHours, totalSalary, avgSalary, uniqueCompanies, uniqueRestaurants, cars, bikes, uniqueManagers };
        }

        function switchTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            if (tab === 'report') { document.querySelector('.tab:nth-child(1)').classList.add('active'); document.getElementById('report-tab').classList.add('active'); }
            else if (tab === 'detailed') { document.querySelector('.tab:nth-child(2)').classList.add('active'); document.getElementById('detailed-tab').classList.add('active'); currentPage=1; updateDetailedReport(filteredData); }
            else { document.querySelector('.tab:nth-child(3)').classList.add('active'); document.getElementById('comparison-tab').classList.add('active'); }
        }

        function downloadExcel() {
            const dataToExport = currentPeriod === 'Ø§Ù„ÙƒÙ„' ? allData : (periodData[currentPeriod] || []);
            if (!dataToExport.length) { alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª'); return; }
            const ws = XLSX.utils.json_to_sheet(dataToExport.map((item,i) => ({
                'Ù…': i+1,
                'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹': item.Ø§Ø³Ù…,
                'Ø§Ù„Ù…Ø·Ø¹Ù…': item.Ù…Ø·Ø¹Ù…,
                'Ø£ÙŠØ§Ù…': item.Ø§ÙŠØ§Ù…,
                'Ø³Ø§Ø¹Ø§Øª': item.Ø³Ø§Ø¹Ø§Øª,
                'Ø§Ù„Ø±Ø§ØªØ¨': item.Ø±Ø§ØªØ¨?.toFixed(3),
                'Ø§Ù„Ø´Ø±ÙƒØ©': item.Ø´Ø±ÙƒØ©,
                'Ø§Ù„Ù…Ø±ÙƒØ¨Ø©': item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©,
                'Ø§Ù„ÙØªØ±Ø©': item.periodKey || item.Ø´Ù‡Ø±,
                'Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„': item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„,
                'Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©': item.Ù…Ø¯ÙŠØ±_Ø§Ù„Ù…Ù†Ø·Ù‚Ø©
            })));
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, 'ØªÙ‚Ø±ÙŠØ±');
            XLSX.writeFile(wb, `ØªÙ‚Ø±ÙŠØ±_${currentPeriod}.xlsx`);
        }

        // Ø¯Ø§Ù„Ø© PDF Ø§Ù„Ù…ÙˆØ¬Ø² (ØªØ¸Ù„ ÙƒÙ…Ø§ Ù‡ÙŠ Ø¨Ø¯ÙˆÙ† ØªØ¹Ø¯ÙŠÙ„ ÙƒØ¨ÙŠØ±)
        async function downloadPDFReport() {
            alert('PDF Ø§Ù„Ù…ÙˆØ¬Ø² ÙŠØ¹Ù…Ù„ Ø¨Ù†ÙØ³ Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ù…Ø¹ ØªÙ‚Ø³ÙŠÙ… Ø§Ù„ØµÙØ­Ø§ØªØŒ ÙŠÙ…ÙƒÙ†Ùƒ ØªØ¬Ø±Ø¨Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙØµÙ„.');
        }
        
        // ========== Ø¯ÙˆØ§Ù„ PDF Ø§Ù„Ù…Ø­Ø³Ù†Ø© (Ù…ØªØ¹Ø¯Ø¯Ø© Ø§Ù„ØµÙØ­Ø§Øª) ==========
        async function downloadDetailedPDF() {
            if (!window.jspdf) { alert('Ù…ÙƒØªØ¨Ø© PDF ØºÙŠØ± Ù…ØªÙˆÙØ±Ø©'); return; }
            const data = filteredData.length ? filteredData : (currentPeriod === 'Ø§Ù„ÙƒÙ„' ? allData : (periodData[currentPeriod] || []));
            if (!data.length) { alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª'); return; }
            
            showLoading();
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'pt', 'a4');
                const pageWidth = pdf.internal.pageSize.getWidth();
                
                // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„ØµÙØ­Ø©: 40 Ø³Ø·Ø± Ø£ÙˆÙ„ ØµÙØ­Ø©ØŒ 49 Ø¨Ø§Ù‚ÙŠ Ø§Ù„ØµÙØ­Ø§Øª
                const rowsPerPageFirst = 40;
                const rowsPerPageOther = 49;
                let startRow = 0;
                let pageNum = 1;
                
                while (startRow < data.length) {
                    const rowsForThisPage = (pageNum === 1) ? rowsPerPageFirst : rowsPerPageOther;
                    const endRow = Math.min(startRow + rowsForThisPage, data.length);
                    const pageData = data.slice(startRow, endRow);
                    
                    // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø§ÙˆÙŠØ© HTML Ù„Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø©
                    const pageDiv = document.createElement('div');
                    pageDiv.style.width = '794px';
                    pageDiv.style.background = 'white';
                    pageDiv.style.padding = '20px';
                    pageDiv.style.direction = 'rtl';
                    pageDiv.style.fontFamily = 'Segoe UI, sans-serif';
                    pageDiv.style.fontSize = '12px';
                    pageDiv.style.boxSizing = 'border-box';
                    
                    // Ø±Ø£Ø³ Ø§Ù„ØµÙØ­Ø©
                    pageDiv.innerHTML = `
                        <div style="text-align:center; margin-bottom:10px;">
                            <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" style="width:40px; height:40px; border-radius:50%;">
                            <h2 style="margin:5px 0; color:#4a90e2;">Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©</h2>
                            <h3 style="margin:0; color:#4a90e2;">ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„ - ${currentPeriod === 'Ø§Ù„ÙƒÙ„' ? 'Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙØªØ±Ø§Øª' : currentPeriod}</h3>
                            <div style="font-size:11px;">Ø§Ù„ØµÙØ­Ø© ${pageNum} Ù…Ù† ${Math.ceil(data.length/rowsForThisPage)}</div>
                        </div>
                        <table style="width:100%; border-collapse:collapse; font-size:10px;">
                            <thead>
                                <tr style="background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%); color:white;">
                                    <th style="padding:4px; border:1px solid #000;">Ù…</th>
                                    <th style="padding:4px; border:1px solid #000;">Ø§Ù„Ù…ÙˆØ²Ø¹</th>
                                    <th style="padding:4px; border:1px solid #000;">Ø§Ù„Ù…Ø·Ø¹Ù…</th>
                                    <th style="padding:4px; border:1px solid #000;">Ø£ÙŠØ§Ù…</th>
                                    <th style="padding:4px; border:1px solid #000;">Ø³Ø§Ø¹Ø§Øª</th>
                                    <th style="padding:4px; border:1px solid #000;">Ø§Ù„Ø±Ø§ØªØ¨</th>
                                    <th style="padding:4px; border:1px solid #000;">Ø§Ù„Ø´Ø±ÙƒØ©</th>
                                    <th style="padding:4px; border:1px solid #000;">Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</th>
                                    <th style="padding:4px; border:1px solid #000;">Ø§Ù„ÙØªØ±Ø©</th>
                                    <th style="padding:4px; border:1px solid #000;">Ù…Ø¯ÙŠØ± ØªØ´ØºÙŠÙ„</th>
                                    <th style="padding:4px; border:1px solid #000;">Ù…Ø¯ÙŠØ± Ù…Ù†Ø·Ù‚Ø©</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    pageData.forEach((item, idx) => {
                        pageDiv.innerHTML += `
                            <tr style="background: ${(startRow+idx)%2===0?'#ffffff':'#f9f9f9'};">
                                <td style="padding:3px; border:1px solid #ddd; text-align:center;">${startRow+idx+1}</td>
                                <td style="padding:3px; border:1px solid #ddd;">${item.Ø§Ø³Ù…||''}</td>
                                <td style="padding:3px; border:1px solid #ddd;">${item.Ù…Ø·Ø¹Ù…||''}</td>
                                <td style="padding:3px; border:1px solid #ddd; text-align:center;">${item.Ø§ÙŠØ§Ù…||''}</td>
                                <td style="padding:3px; border:1px solid #ddd; text-align:center;">${item.Ø³Ø§Ø¹Ø§Øª||''}</td>
                                <td style="padding:3px; border:1px solid #ddd; text-align:center;">${item.Ø±Ø§ØªØ¨?item.Ø±Ø§ØªØ¨.toFixed(3):''}</td>
                                <td style="padding:3px; border:1px solid #ddd;">${item.Ø´Ø±ÙƒØ©||''}</td>
                                <td style="padding:3px; border:1px solid #ddd; text-align:center;">${item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©||''}</td>
                                <td style="padding:3px; border:1px solid #ddd;">${item.periodKey||item.Ø´Ù‡Ø±}</td>
                                <td style="padding:3px; border:1px solid #ddd;">${item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„||''}</td>
                                <td style="padding:3px; border:1px solid #ddd;">${item.Ù…Ø¯ÙŠØ±_Ø§Ù„Ù…Ù†Ø·Ù‚Ø©||''}</td>
                            </tr>
                        `;
                    });
                    
                    pageDiv.innerHTML += `</tbody></table>`;
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…ØµØºØ±
                    pageDiv.innerHTML += `<div style="margin-top:10px; text-align:left; font-size:5.6px; color:#d32f2f;">Yasser Elkhateeb - Ù…Ø·ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ 67011143</div>`;
                    
                    document.body.appendChild(pageDiv);
                    
                    const canvas = await html2canvas(pageDiv, { scale: 2, useCORS: true, backgroundColor: '#FFFFFF' });
                    document.body.removeChild(pageDiv);
                    
                    const imgData = canvas.toDataURL('image/jpeg', 0.95);
                    const imgWidth = pageWidth;
                    const imgHeight = (canvas.height * imgWidth) / canvas.width;
                    
                    if (pageNum > 1) pdf.addPage();
                    pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
                    
                    startRow = endRow;
                    pageNum++;
                }
                
                pdf.save(`ØªÙ‚Ø±ÙŠØ±_Ù…ÙØµÙ„_${currentPeriod}.pdf`);
            } catch (e) { alert('Ø®Ø·Ø£ ÙÙŠ Ø¥Ù†Ø´Ø§Ø¡ PDF: '+e.message); } finally { hideLoading(); }
        }

        // Ø¯Ø§Ù„Ø© Ù…Ø³Ø§Ø¹Ø¯Ø© Ù„Ø¨Ù†Ø§Ø¡ HTML Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨ (Ù†ÙØ³ Ù‡ÙŠÙƒÙ„ generateComparisonTable)
        function buildComparisonTableHTML(periods) {
            const managerStats = {};
            periods.forEach(period => {
                const data = periodData[period] || [];
                managerStats[period] = {};
                data.forEach(item => {
                    const mgr = item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                    if (!managerStats[period][mgr]) {
                        managerStats[period][mgr] = { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                    }
                    if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©') managerStats[period][mgr].carSalary += item.Ø±Ø§ØªØ¨ || 0;
                    else if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„') managerStats[period][mgr].bikeSalary += item.Ø±Ø§ØªØ¨ || 0;
                    managerStats[period][mgr].totalSalary += item.Ø±Ø§ØªØ¨ || 0;
                    managerStats[period][mgr].employees++;
                });
            });

            let html = `<h3 style="text-align:center; color:#2c3e50;">ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨</h3>
                <table style="width:100%; border-collapse:collapse; font-size:10px;">
                    <thead>
                        <tr style="background: linear-gradient(135deg, #424242 0%, #212121 100%); color:white;">
                            <th rowspan="2" style="padding:6px; border:1px solid #000;">Ø§Ù„ÙØªØ±Ø©</th>
                            <th colspan="3" style="padding:6px; border:1px solid #000;">Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ</th>
                            <th colspan="3" style="padding:6px; border:1px solid #000;">Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡</th>
                            <th colspan="3" style="padding:6px; border:1px solid #000;">Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰</th>
                            <th colspan="4" style="padding:6px; border:1px solid #000;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                        </tr>
                        <tr style="background: linear-gradient(135deg, #424242 0%, #212121 100%); color:white;">
                            <th style="padding:4px; border:1px solid #000;">Ø³ÙŠØ§Ø±Ø§Øª</th><th>Ø³ÙŠÙƒÙ„</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                            <th>Ø³ÙŠØ§Ø±Ø§Øª</th><th>Ø³ÙŠÙƒÙ„</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                            <th>Ø³ÙŠØ§Ø±Ø§Øª</th><th>Ø³ÙŠÙƒÙ„</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                            <th>Ø³ÙŠØ§Ø±Ø§Øª</th><th>Ø³ÙŠÙƒÙ„</th><th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th><th>Ø¹Ø¯Ø¯</th>
                        </tr>
                    </thead>
                    <tbody>`;
            
            periods.forEach(period => {
                const t = managerStats[period]['Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ'] || { carSalary:0, bikeSalary:0, totalSalary:0 };
                const h = managerStats[period]['Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡'] || { carSalary:0, bikeSalary:0, totalSalary:0 };
                const m = managerStats[period]['Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰'] || { carSalary:0, bikeSalary:0, totalSalary:0 };
                const totCar = t.carSalary + h.carSalary + m.carSalary;
                const totBike = t.bikeSalary + h.bikeSalary + m.bikeSalary;
                const totAll = totCar + totBike;
                const totEmp = (t.employees || 0) + (h.employees || 0) + (m.employees || 0);
                html += `<tr>
                    <td style="padding:4px; border:1px solid #ddd;">${period}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${t.carSalary.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${t.bikeSalary.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${t.totalSalary.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${h.carSalary.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${h.bikeSalary.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${h.totalSalary.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${m.carSalary.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${m.bikeSalary.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${m.totalSalary.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${totCar.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${totBike.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${totAll.toFixed(3)}</td>
                    <td style="padding:4px; border:1px solid #ddd;">${totEmp}</td>
                </tr>`;
            });
            
            if (periods.length > 1) {
                let sumTcar=0, sumTbike=0, sumTsal=0, sumHcar=0, sumHbike=0, sumHsal=0, sumMcar=0, sumMbike=0, sumMsal=0, sumEmp=0;
                periods.forEach(p => {
                    const t = managerStats[p]['Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ'] || { carSalary:0, bikeSalary:0, totalSalary:0, employees:0 };
                    const h = managerStats[p]['Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡'] || { carSalary:0, bikeSalary:0, totalSalary:0, employees:0 };
                    const m = managerStats[p]['Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰'] || { carSalary:0, bikeSalary:0, totalSalary:0, employees:0 };
                    sumTcar += t.carSalary; sumTbike += t.bikeSalary; sumTsal += t.totalSalary;
                    sumHcar += h.carSalary; sumHbike += h.bikeSalary; sumHsal += h.totalSalary;
                    sumMcar += m.carSalary; sumMbike += m.bikeSalary; sumMsal += m.totalSalary;
                    sumEmp += (t.employees + h.employees + m.employees);
                });
                const grandCar = sumTcar+sumHcar+sumMcar;
                const grandBike = sumTbike+sumHbike+sumMbike;
                const grandAll = grandCar+grandBike;
                html += `<tr style="background: #ffcc80; font-weight:bold;">
                    <td style="padding:4px; border:1px solid #000;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</td>
                    <td>${sumTcar.toFixed(3)}</td><td>${sumTbike.toFixed(3)}</td><td>${sumTsal.toFixed(3)}</td>
                    <td>${sumHcar.toFixed(3)}</td><td>${sumHbike.toFixed(3)}</td><td>${sumHsal.toFixed(3)}</td>
                    <td>${sumMcar.toFixed(3)}</td><td>${sumMbike.toFixed(3)}</td><td>${sumMsal.toFixed(3)}</td>
                    <td>${grandCar.toFixed(3)}</td><td>${grandBike.toFixed(3)}</td><td>${grandAll.toFixed(3)}</td><td>${sumEmp}</td>
                </tr>`;
            }
            
            html += `</tbody></table>`;
            return html;
        }

        async function downloadComparisonTablePDF() {
            const selected = Array.from(document.querySelectorAll('.compare-period:checked')).map(cb => cb.value);
            if (!selected.length) { alert('Ø§Ø®ØªØ± ÙØªØ±Ø§Øª Ø£ÙˆÙ„Ø§Ù‹'); return; }
            
            showLoading();
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('l', 'pt', 'a4'); // Ø£ÙÙ‚ÙŠ
                const pageWidth = pdf.internal.pageSize.getWidth();
                
                // Ø¨Ù†Ø§Ø¡ HTML Ø§Ù„Ø¬Ø¯ÙˆÙ„ (Ù‚Ø¯ ÙŠÙƒÙˆÙ† Ø·ÙˆÙŠÙ„Ø§Ù‹ØŒ Ø³Ù†Ù‚Ø³Ù…Ù‡ Ø¥Ù„Ù‰ ØµÙØ­Ø§Øª Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±)
                // Ù„ÙƒÙ† Ø¹Ø§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„ÙØªØ±Ø§Øª Ù‚Ù„ÙŠÙ„ØŒ Ù„Ø°Ø§ ØµÙØ­Ø© ÙˆØ§Ø­Ø¯Ø© ØªÙƒÙÙŠ. Ù„ÙƒÙ† Ù†Ø¶ÙŠÙ Ø¢Ù„ÙŠØ© ØªÙ‚Ø³ÙŠÙ… Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©.
                const fullHTML = buildComparisonTableHTML(selected);
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø­Ø§ÙˆÙŠØ© HTML Ù…Ø¤Ù‚ØªØ©
                const tempDiv = document.createElement('div');
                tempDiv.style.width = '1123px'; // Ø¹Ø±Ø¶ A4 landscape
                tempDiv.style.background = 'white';
                tempDiv.style.padding = '20px';
                tempDiv.style.direction = 'rtl';
                tempDiv.style.fontFamily = 'Segoe UI, sans-serif';
                tempDiv.style.fontSize = '12px';
                tempDiv.style.boxSizing = 'border-box';
                tempDiv.innerHTML = `
                    <div style="text-align:center; margin-bottom:10px;">
                        <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" style="width:40px; height:40px; border-radius:50%;">
                        <h2 style="margin:5px 0; color:#4a90e2;">Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©</h2>
                        <h3 style="margin:0; color:#4a90e2;">Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨</h3>
                    </div>
                    ${fullHTML}
                    <div style="margin-top:15px; text-align:left; font-size:5.6px; color:#d32f2f;">Yasser Elkhateeb - 67011143</div>
                `;
                
                document.body.appendChild(tempDiv);
                
                const canvas = await html2canvas(tempDiv, { scale: 2, useCORS: true, backgroundColor: '#FFFFFF' });
                document.body.removeChild(tempDiv);
                
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const imgWidth = pageWidth;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
                pdf.save('Ù…Ù‚Ø§Ø±Ù†Ø©_Ø§Ù„Ø±ÙˆØ§ØªØ¨.pdf');
                
            } catch (e) { alert('Ø®Ø·Ø£ ÙÙŠ PDF: ' + e.message); } finally { hideLoading(); }
        }

        async function downloadRestaurantComparisonPDF() {
            const selectedManager = managerSelect.value;
            if (!selectedManager) { alert('Ø§Ø®ØªØ± Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„'); return; }
            const selectedPeriods = Array.from(document.querySelectorAll('.compare-period:checked')).map(cb => cb.value);
            if (selectedPeriods.length === 0) { alert('Ø§Ø®ØªØ± ÙØªØ±Ø§Øª Ø£ÙˆÙ„Ø§Ù‹'); return; }
            
            showLoading();
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('l', 'pt', 'a4'); // Ø£ÙÙ‚ÙŠ
                const pageWidth = pdf.internal.pageSize.getWidth();
                
                // Ø¨Ù†Ø§Ø¡ HTML Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
                const restaurantStats = {};
                const allRestaurants = new Set();
                selectedPeriods.forEach(period => {
                    const data = periodData[period] || [];
                    restaurantStats[period] = {};
                    data.filter(item => item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ === selectedManager).forEach(item => {
                        const rest = item.Ù…Ø·Ø¹Ù… || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                        allRestaurants.add(rest);
                        if (!restaurantStats[period][rest]) {
                            restaurantStats[period][rest] = { carSalary:0, bikeSalary:0 };
                        }
                        if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©') restaurantStats[period][rest].carSalary += item.Ø±Ø§ØªØ¨ || 0;
                        else if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„') restaurantStats[period][rest].bikeSalary += item.Ø±Ø§ØªØ¨ || 0;
                    });
                });
                
                let html = `<h3 style="text-align:center;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø±ÙˆØ§ØªØ¨ Ù…Ø·Ø§Ø¹Ù… ${selectedManager}</h3>
                    <table style="width:100%; border-collapse:collapse; font-size:9px;">
                        <thead>
                            <tr style="background: linear-gradient(135deg, #388e3c 0%, #2e7d32 100%); color:white;">
                                <th style="padding:4px; border:1px solid #000;">Ø§Ù„Ù…Ø·Ø¹Ù…</th>`;
                selectedPeriods.forEach(p => html += `<th colspan="2" style="padding:4px; border:1px solid #000;">${p}</th>`);
                html += `<th colspan="3" style="padding:4px; border:1px solid #000;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th></tr>
                        <tr style="background: #388e3c; color:white;">
                            <th style="padding:4px; border:1px solid #000;"></th>`;
                selectedPeriods.forEach(() => html += `<th style="padding:4px; border:1px solid #000;">Ø³ÙŠØ§Ø±Ø§Øª</th><th style="padding:4px; border:1px solid #000;">Ø³ÙŠÙƒÙ„</th>`);
                html += `<th style="padding:4px; border:1px solid #000;">Ø³ÙŠØ§Ø±Ø§Øª</th><th style="padding:4px; border:1px solid #000;">Ø³ÙŠÙƒÙ„</th><th style="padding:4px; border:1px solid #000;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th></tr>
                        </thead><tbody>`;
                
                const monthlyTotals = {};
                selectedPeriods.forEach(p => monthlyTotals[p] = { carSalary:0, bikeSalary:0 });
                
                Array.from(allRestaurants).filter(r => r !== 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ').forEach(rest => {
                    let restCar=0, restBike=0;
                    html += `<tr><td style="padding:4px; border:1px solid #ddd; font-weight:bold;">${rest}</td>`;
                    selectedPeriods.forEach(p => {
                        const st = restaurantStats[p][rest] || { carSalary:0, bikeSalary:0 };
                        html += `<td style="padding:4px; border:1px solid #ddd;">${st.carSalary.toFixed(3)}</td><td style="padding:4px; border:1px solid #ddd;">${st.bikeSalary.toFixed(3)}</td>`;
                        monthlyTotals[p].carSalary += st.carSalary;
                        monthlyTotals[p].bikeSalary += st.bikeSalary;
                        restCar += st.carSalary; restBike += st.bikeSalary;
                    });
                    html += `<td style="padding:4px; border:1px solid #ddd;">${restCar.toFixed(3)}</td><td style="padding:4px; border:1px solid #ddd;">${restBike.toFixed(3)}</td><td style="padding:4px; border:1px solid #ddd;">${(restCar+restBike).toFixed(3)}</td></tr>`;
                });
                
                html += `<tr style="background: #ff9800; color:white; font-weight:bold;"><td>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´Ù‡Ø±</td>`;
                let totalCar=0, totalBike=0;
                selectedPeriods.forEach(p => {
                    html += `<td>${monthlyTotals[p].carSalary.toFixed(3)}</td><td>${monthlyTotals[p].bikeSalary.toFixed(3)}</td>`;
                    totalCar += monthlyTotals[p].carSalary;
                    totalBike += monthlyTotals[p].bikeSalary;
                });
                html += `<td>${totalCar.toFixed(3)}</td><td>${totalBike.toFixed(3)}</td><td>${(totalCar+totalBike).toFixed(3)}</td></tr>`;
                html += `</tbody></table>`;
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø­Ø§ÙˆÙŠØ©
                const tempDiv = document.createElement('div');
                tempDiv.style.width = '1123px';
                tempDiv.style.background = 'white';
                tempDiv.style.padding = '20px';
                tempDiv.style.direction = 'rtl';
                tempDiv.style.fontFamily = 'Segoe UI, sans-serif';
                tempDiv.style.fontSize = '12px';
                tempDiv.innerHTML = `
                    <div style="text-align:center; margin-bottom:10px;">
                        <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" style="width:40px; height:40px; border-radius:50%;">
                        <h2 style="margin:5px 0; color:#4a90e2;">Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©</h2>
                        <h3 style="margin:0; color:#4a90e2;">ØªÙ‚Ø±ÙŠØ± Ù…Ø·Ø§Ø¹Ù… ${selectedManager}</h3>
                    </div>
                    ${html}
                    <div style="margin-top:15px; text-align:left; font-size:5.6px; color:#d32f2f;">Yasser Elkhateeb - 67011143</div>
                `;
                
                document.body.appendChild(tempDiv);
                const canvas = await html2canvas(tempDiv, { scale: 2, useCORS: true, backgroundColor: '#FFFFFF' });
                document.body.removeChild(tempDiv);
                
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const imgWidth = pageWidth;
                const imgHeight = (canvas.height * imgWidth) / canvas.width;
                
                pdf.addImage(imgData, 'JPEG', 0, 0, imgWidth, imgHeight);
                pdf.save(`Ù…Ø·Ø§Ø¹Ù…_${selectedManager}.pdf`);
                
            } catch (e) { alert('Ø®Ø·Ø£ ÙÙŠ PDF: ' + e.message); } finally { hideLoading(); }
        }

        function resetView() {
            clearSearch();
            switchTab('report');
            managerSelector.style.display = 'none';
        }

        function showLoading() { loadingDiv.style.display = 'block'; }
        function hideLoading() { loadingDiv.style.display = 'none'; }
        function showError(m) { errorDiv.textContent = m; errorDiv.style.display = 'block'; }
        function hideError() { errorDiv.style.display = 'none'; }
    </script>
</body>
</html>
