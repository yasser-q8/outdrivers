<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠÙŠÙ† - Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©</title>
    <link rel="icon" href="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" type="image/jpeg">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            direction: rtl;
            color: #333;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            overflow: hidden;
            padding: 25px;
        }
        
        .header {
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
            position: relative;
        }
        
        .header h1 {
            margin: 0 0 15px 0;
            font-size: 28px;
        }
        
        .header p {
            margin: 0;
            opacity: 0.9;
            font-size: 16px;
        }
        
        .company-logo {
            position: absolute;
            left: 30px;
            top: 50%;
            transform: translateY(-50%);
            width: 80px;
            height: 80px;
            border-radius: 50%;
            border: 3px solid white;
            overflow: hidden;
        }
        
        .company-logo img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .month-upload-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 2px dashed #d32f2f;
        }
        
        .upload-section {
            background: #e8f5e9;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            border: 2px dashed #4caf50;
            text-align: center;
        }
        
        .upload-btn {
            background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
        }
        
        .upload-btn:hover {
            background: linear-gradient(135deg, #c62828 0%, #b71c1c 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(211, 47, 47, 0.4);
        }
        
        .month-upload-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin-top: 20px;
        }
        
        .month-upload-item {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .month-label {
            font-weight: 600;
            color: #2c3e50;
            text-align: center;
        }
        
        .month-upload-btn {
            background: linear-gradient(135deg, #4caf50 0%, #2e7d32 100%);
            color: white;
            border: none;
            padding: 12px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
        }
        
        .month-upload-btn:hover {
            background: linear-gradient(135deg, #388e3c 0%, #1b5e20 100%);
            transform: translateY(-2px);
        }
        
        .month-upload-btn.uploaded {
            background: linear-gradient(135deg, #2196f3 0%, #1976d2 100%);
        }
        
        .all-months-btn {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            grid-column: span 4;
            margin-top: 10px;
        }
        
        .controls {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
        }
        
        .control-btn {
            background: linear-gradient(135deg, #5856d6 0%, #4a47d1 100%);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 15px;
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(88, 86, 214, 0.4);
        }
        
        .control-btn.pdf-btn {
            background: linear-gradient(135deg, #f44336 0%, #d32f2f 100%);
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
            gap: 15px;
            margin-bottom: 25px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #5ac8fa 0%, #007aff 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,122,255,0.2);
            animation: float 3s ease-in-out infinite;
        }
        
        .stat-card:nth-child(2) {
            animation-delay: 0.2s;
            background: linear-gradient(135deg, #ff2d55 0%, #d5006d 100%);
        }
        
        .stat-card:nth-child(3) {
            animation-delay: 0.4s;
            background: linear-gradient(135deg, #ff9500 0%, #ff5e3a 100%);
        }
        
        .stat-card:nth-child(4) {
            animation-delay: 0.6s;
            background: linear-gradient(135deg, #4cd964 0%, #2ba245 100%);
        }
        
        .stat-card:nth-child(5) {
            animation-delay: 0.8s;
            background: linear-gradient(135deg, #5856d6 0%, #3634a3 100%);
        }
        
        .stat-card:nth-child(6) {
            animation-delay: 1s;
            background: linear-gradient(135deg, #ffcc00 0%, #ff9500 100%);
        }
        
        .stat-card h3 {
            margin: 0 0 10px 0;
            font-size: 16px;
            opacity: 0.9;
        }
        
        .stat-card .value {
            font-size: 28px;
            font-weight: bold;
            margin: 0;
        }
        
        .search-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        
        .search-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .search-input {
            padding: 12px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            width: 100%;
            transition: border-color 0.3s;
        }
        
        .search-input:focus {
            outline: none;
            border-color: #d32f2f;
        }
        
        .search-btn {
            background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 15px;
            transition: all 0.3s;
        }
        
        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(211, 47, 47, 0.4);
        }
        
        .report-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .report-table th {
            background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%);
            color: white;
            padding: 15px;
            text-align: center;
            font-weight: 600;
            font-size: 15px;
            position: sticky;
            top: 0;
        }
        
        .report-table td {
            padding: 12px 15px;
            border-bottom: 1px solid #e0e0e0;
            text-align: center;
            font-size: 14px;
        }
        
        .report-table tr:nth-child(even) {
            background-color: #f8f9fa;
        }
        
        .report-table tr:hover {
            background-color: #ffebee;
        }
        
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }
        
        .loader {
            border: 5px solid #f3f3f3;
            border-top: 5px solid #d32f2f;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }
        
        .error {
            background: #ff3b30;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            display: none;
        }
        
        .tabs {
            display: flex;
            background: #f8f9fa;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 25px;
        }
        
        .tab {
            flex: 1;
            padding: 15px;
            text-align: center;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            border-bottom: 3px solid transparent;
        }
        
        .tab:hover {
            background: #e0e0e0;
        }
        
        .tab.active {
            background: white;
            border-bottom: 3px solid #d32f2f;
            color: #d32f2f;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .detailed-report {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .detailed-report::-webkit-scrollbar {
            width: 8px;
        }
        
        .detailed-report::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }
        
        .detailed-report::-webkit-scrollbar-thumb {
            background: #d32f2f;
            border-radius: 4px;
        }
        
        .detailed-report::-webkit-scrollbar-thumb:hover {
            background: #b71c1c;
        }
        
        .no-data {
            text-align: center;
            padding: 40px;
            background: #f8f9fa;
            border-radius: 10px;
            color: #666;
        }
        
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .page-btn {
            background: #f0f0f0;
            border: none;
            padding: 8px 15px;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .page-btn:hover {
            background: #d32f2f;
            color: white;
        }
        
        .page-btn.active {
            background: #d32f2f;
            color: white;
        }
        
        .comparison-section {
            background: #e3f2fd;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
        }
        
        .month-checkboxes {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 10px;
            margin: 15px 0;
        }
        
        .month-checkbox {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .comparison-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .comparison-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .comparison-table-container {
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 800px;
        }
        
        .comparison-table th {
            background: linear-gradient(135deg, #424242 0%, #212121 100%);
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: 600;
            font-size: 14px;
            border: 1px solid #ddd;
        }
        
        .comparison-table td {
            padding: 10px 12px;
            border: 1px solid #e0e0e0;
            text-align: center;
            font-size: 13px;
        }
        
        .comparison-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .comparison-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .comparison-table .month-header {
            background: linear-gradient(135deg, #5c6bc0 0%, #3949ab 100%);
            color: white;
            font-weight: bold;
        }
        
        .comparison-table .total-row {
            background: linear-gradient(135deg, #ffcc80 0%, #ffb74d 100%);
            font-weight: bold;
        }
        
        .comparison-table .manager-total {
            background: #e8eaf6;
            font-weight: bold;
        }
        
        .restaurant-comparison-table-container {
            overflow-x: auto;
            margin-top: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .restaurant-comparison-table {
            width: 100%;
            border-collapse: collapse;
            min-width: 1000px;
        }
        
        .restaurant-comparison-table th {
            background: linear-gradient(135deg, #388e3c 0%, #2e7d32 100%);
            color: white;
            padding: 12px;
            text-align: center;
            font-weight: 600;
            font-size: 13px;
            border: 1px solid #ddd;
        }
        
        .restaurant-comparison-table td {
            padding: 10px 12px;
            border: 1px solid #e0e0e0;
            text-align: center;
            font-size: 12px;
        }
        
        .restaurant-comparison-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        
        .restaurant-comparison-table tr:hover {
            background-color: #f5f5f5;
        }
        
        .restaurant-comparison-table .restaurant-name {
            font-weight: bold;
            background: #f0f0f0;
            text-align: right;
            padding-right: 20px;
        }
        
        .restaurant-comparison-table .month-column {
            background: #e3f2fd;
            font-weight: bold;
        }
        
        .restaurant-comparison-table .car-salary {
            background: #fff3e0;
            font-weight: bold;
        }
        
        .restaurant-comparison-table .bike-salary {
            background: #e8f5e9;
            font-weight: bold;
        }
        
        .restaurant-comparison-table .restaurant-total {
            background: #f3e5f5;
            font-weight: bold;
        }
        
        .restaurant-comparison-table .grand-total {
            background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%);
            color: white;
            font-weight: bold;
        }
        
        .manager-selector {
            margin: 15px 0;
            text-align: center;
        }
        
        .manager-select {
            padding: 10px 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            min-width: 200px;
            background: white;
            cursor: pointer;
        }
        
        .manager-select:focus {
            outline: none;
            border-color: #d32f2f;
        }
        
        @media (max-width: 768px) {
            .month-upload-grid {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .all-months-btn {
                grid-column: span 2;
            }
            
            .month-checkboxes {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .report-table {
                display: block;
                overflow-x: auto;
            }
            
            .company-logo {
                position: relative;
                left: 0;
                top: 0;
                transform: none;
                margin: 0 auto 15px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .tab {
                padding: 12px;
                font-size: 14px;
            }
            
            .comparison-table, .restaurant-comparison-table {
                min-width: 100%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="company-logo">
                <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" alt="Ø´Ø¹Ø§Ø± Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©">
            </div>
            <h1>ğŸ“Š Ø¨Ø±Ù†Ø§Ù…Ø¬ ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠÙŠÙ†</h1>
            <p>Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ© | Ù†Ø¸Ø§Ù… Ø¥Ø¯Ø§Ø±Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† ÙˆØ§Ù„Ù…Ø·Ø§Ø¹Ù…</p>
        </div>
        
        <div class="month-upload-section">
            <h3 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">ğŸ“… ØªØ­Ù…ÙŠÙ„ Ù…Ù„ÙØ§Øª Ø§Ù„Ø£Ø´Ù‡Ø±</h3>
            <div class="month-upload-grid">
                <div class="month-upload-item">
                    <div class="month-label">ÙŠÙ†Ø§ÙŠØ±</div>
                    <input type="file" id="januaryFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('ÙŠÙ†Ø§ÙŠØ±', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('januaryFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">ÙØ¨Ø±Ø§ÙŠØ±</div>
                    <input type="file" id="februaryFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('ÙØ¨Ø±Ø§ÙŠØ±', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('februaryFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">Ù…Ø§Ø±Ø³</div>
                    <input type="file" id="marchFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('Ù…Ø§Ø±Ø³', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('marchFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">Ø£Ø¨Ø±ÙŠÙ„</div>
                    <input type="file" id="aprilFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('Ø£Ø¨Ø±ÙŠÙ„', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('aprilFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">Ù…Ø§ÙŠÙˆ</div>
                    <input type="file" id="mayFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('Ù…Ø§ÙŠÙˆ', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('mayFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">ÙŠÙˆÙ†ÙŠÙˆ</div>
                    <input type="file" id="juneFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('ÙŠÙˆÙ†ÙŠÙˆ', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('juneFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">ÙŠÙˆÙ„ÙŠÙˆ</div>
                    <input type="file" id="julyFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('ÙŠÙˆÙ„ÙŠÙˆ', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('julyFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">Ø£ØºØ³Ø·Ø³</div>
                    <input type="file" id="augustFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('Ø£ØºØ³Ø·Ø³', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('augustFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">Ø³Ø¨ØªÙ…Ø¨Ø±</div>
                    <input type="file" id="septemberFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('Ø³Ø¨ØªÙ…Ø¨Ø±', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('septemberFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">Ø£ÙƒØªÙˆØ¨Ø±</div>
                    <input type="file" id="octoberFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('Ø£ÙƒØªÙˆØ¨Ø±', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('octoberFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">Ù†ÙˆÙÙ…Ø¨Ø±</div>
                    <input type="file" id="novemberFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('Ù†ÙˆÙÙ…Ø¨Ø±', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('novemberFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <div class="month-upload-item">
                    <div class="month-label">Ø¯ÙŠØ³Ù…Ø¨Ø±</div>
                    <input type="file" id="decemberFile" accept=".xlsx, .xls" style="display: none;" onchange="handleMonthUpload('Ø¯ÙŠØ³Ù…Ø¨Ø±', this)">
                    <button class="month-upload-btn" onclick="document.getElementById('decemberFile').click()">ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù</button>
                </div>
                <button class="month-upload-btn all-months-btn" onclick="loadAllMonths()">ğŸ“Š ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</button>
            </div>
        </div>
        
        <div id="loading" class="loading">
            <div class="loader"></div>
            <p>Ø¬Ø§Ø±ÙŠ Ù…Ø¹Ø§Ù„Ø¬Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</p>
        </div>
        
        <div id="error" class="error"></div>
        
        <div id="controls" style="display: none;">
            <!-- ØªØ­Ø³ÙŠÙ† Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„ØªÙ†Ù‚Ù„ -->
            <div class="tabs">
                <div class="tab active" onclick="switchTab('report')" style="background: linear-gradient(135deg, #5c6bc0 0%, #3949ab 100%); color: white; border-bottom: 3px solid #3949ab;">
                    ğŸ“‹ ØªÙ‚Ø±ÙŠØ± Ù…ÙˆØ¬Ø²
                </div>
                <div class="tab" onclick="switchTab('detailed')" style="background: linear-gradient(135deg, #42a5f5 0%, #1976d2 100%); color: white; border-bottom: 3px solid #1976d2;">
                    ğŸ“Š ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„
                </div>
                <div class="tab" onclick="switchTab('comparison')" style="background: linear-gradient(135deg, #66bb6a 0%, #388e3c 100%); color: white; border-bottom: 3px solid #388e3c;">
                    ğŸ“ˆ Ù…Ù‚Ø§Ø±Ù†Ø§Øª Ù…ØªØ¹Ø¯Ø¯Ø©
                </div>
            </div>
            
            <div id="report-tab" class="tab-content active">
                <div class="controls">
                    <button class="control-btn" onclick="downloadExcel()">ğŸ“¥ ØªØµØ¯ÙŠØ± Excel</button>
                    <button class="control-btn pdf-btn" onclick="downloadPDFReport()">ğŸ“„ Ø­ÙØ¸ PDF</button>
                    <button class="control-btn" onclick="resetView()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                </div>
                
                <div id="stats" class="stats" style="display: none;"></div>
                
                <div id="reportContainer"></div>
            </div>
            
            <div id="detailed-tab" class="tab-content">
                <div class="controls">
                    <button class="control-btn" onclick="downloadExcel()">ğŸ“¥ ØªØµØ¯ÙŠØ± Excel</button>
                    <button class="control-btn pdf-btn" onclick="downloadDetailedPDF()">ğŸ“„ Ø­ÙØ¸ PDF Ù…ÙØµÙ„</button>
                    <button class="control-btn" onclick="resetView()">ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
                </div>
                
                <div class="search-section">
                    <div class="search-grid">
                        <input type="text" id="searchCompany" class="search-input" placeholder="ğŸ” Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©" oninput="searchData()">
                        <input type="text" id="searchDistributor" class="search-input" placeholder="ğŸ‘¤ Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹" oninput="searchData()">
                        <input type="text" id="searchVehicle" class="search-input" placeholder="ğŸš— Ø¨Ø­Ø« Ø¨Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø© (Ø³ÙŠØ§Ø±Ø©/Ø³ÙŠÙƒÙ„)" oninput="searchData()">
                        <input type="text" id="searchRestaurant" class="search-input" placeholder="ğŸª Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…" oninput="searchData()">
                        <input type="text" id="searchManager" class="search-input" placeholder="ğŸ‘¨â€ğŸ’¼ Ø¨Ø­Ø« Ø¨Ø§Ø³Ù… Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„" oninput="searchData()">
                    </div>
                    <button class="search-btn" onclick="searchData()">Ø¨Ø­Ø«</button>
                    <button class="search-btn" onclick="clearSearch()" style="background: #757575; margin-right: 10px;">Ù…Ø³Ø­ Ø§Ù„Ø¨Ø­Ø«</button>
                </div>
                
                <div id="detailedReportContainer"></div>
            </div>
            
            <div id="comparison-tab" class="tab-content">
                <div class="comparison-section">
                    <h3 style="text-align: center; color: #2c3e50; margin-bottom: 15px;">Ù…Ù‚Ø§Ø±Ù†Ø© Ù…ØªØ¹Ø¯Ø¯Ø© Ø¨ÙŠÙ† Ø§Ù„Ø£Ø´Ù‡Ø±</h3>
                    <p style="text-align: center; color: #666; margin-bottom: 15px;">Ø§Ø®ØªØ± Ø§Ù„Ø£Ø´Ù‡Ø± Ø§Ù„ØªÙŠ ØªØ±ÙŠØ¯ Ù…Ù‚Ø§Ø±Ù†ØªÙ‡Ø§:</p>
                    
                    <div class="month-checkboxes">
                        <label class="month-checkbox"><input type="checkbox" value="ÙŠÙ†Ø§ÙŠØ±" class="compare-month"> ÙŠÙ†Ø§ÙŠØ±</label>
                        <label class="month-checkbox"><input type="checkbox" value="ÙØ¨Ø±Ø§ÙŠØ±" class="compare-month"> ÙØ¨Ø±Ø§ÙŠØ±</label>
                        <label class="month-checkbox"><input type="checkbox" value="Ù…Ø§Ø±Ø³" class="compare-month"> Ù…Ø§Ø±Ø³</label>
                        <label class="month-checkbox"><input type="checkbox" value="Ø£Ø¨Ø±ÙŠÙ„" class="compare-month"> Ø£Ø¨Ø±ÙŠÙ„</label>
                        <label class="month-checkbox"><input type="checkbox" value="Ù…Ø§ÙŠÙˆ" class="compare-month"> Ù…Ø§ÙŠÙˆ</label>
                        <label class="month-checkbox"><input type="checkbox" value="ÙŠÙˆÙ†ÙŠÙˆ" class="compare-month"> ÙŠÙˆÙ†ÙŠÙˆ</label>
                        <label class="month-checkbox"><input type="checkbox" value="ÙŠÙˆÙ„ÙŠÙˆ" class="compare-month"> ÙŠÙˆÙ„ÙŠÙˆ</label>
                        <label class="month-checkbox"><input type="checkbox" value="Ø£ØºØ³Ø·Ø³" class="compare-month"> Ø£ØºØ³Ø·Ø³</label>
                        <label class="month-checkbox"><input type="checkbox" value="Ø³Ø¨ØªÙ…Ø¨Ø±" class="compare-month"> Ø³Ø¨ØªÙ…Ø¨Ø±</label>
                        <label class="month-checkbox"><input type="checkbox" value="Ø£ÙƒØªÙˆØ¨Ø±" class="compare-month"> Ø£ÙƒØªÙˆØ¨Ø±</label>
                        <label class="month-checkbox"><input type="checkbox" value="Ù†ÙˆÙÙ…Ø¨Ø±" class="compare-month"> Ù†ÙˆÙÙ…Ø¨Ø±</label>
                        <label class="month-checkbox"><input type="checkbox" value="Ø¯ÙŠØ³Ù…Ø¨Ø±" class="compare-month"> Ø¯ÙŠØ³Ù…Ø¨Ø±</label>
                    </div>
                    
                    <div style="text-align: center; margin-top: 20px;">
                        <button class="search-btn" onclick="compareSelectedMonths()">Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø´Ù‡Ø± Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©</button>
                        <button class="search-btn" onclick="compareAllMonths()" style="background: #ff9800;">Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø³Ù†Ø© ÙƒØ§Ù…Ù„Ø©</button>
                        <button class="search-btn" onclick="generateComparisonTable()" style="background: #9c27b0;">ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨</button>
                        <button class="search-btn" onclick="downloadComparisonTablePDF()" style="background: #d32f2f;">ğŸ“„ ØªØµØ¯ÙŠØ± Ø¬Ø¯ÙˆÙ„ PDF</button>
                    </div>
                    
                    <div id="managerSelector" class="manager-selector" style="display: none;">
                        <select class="manager-select" id="managerSelect" onchange="generateRestaurantComparisonTable()">
                            <option value="">Ø§Ø®ØªØ± Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„</option>
                        </select>
                        <button class="search-btn" onclick="generateRestaurantComparisonTable()" style="margin-right: 10px; background: #5c6bc0;">ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</button>
                        <button class="search-btn" onclick="downloadRestaurantComparisonPDF()" style="background: #388e3c;">ğŸ“„ ØªØµØ¯ÙŠØ± Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ø·Ø§Ø¹Ù… PDF</button>
                    </div>
                </div>
                
                <div id="comparisonResult"></div>
            </div>
        </div>
    </div>

    <!-- Ù†Ù…ÙˆØ°Ø¬ PDF Ù…Ù„ÙˆÙ† Ù„Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙØµÙ„ -->
    <div id="pdf-detailed-template" style="position: fixed; left: -10000px; top: -10000px; width: 794px; height: auto; min-height: 1123px; background: white; padding: 10px; box-sizing: border-box; z-index: -1000; font-size: 12px; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; direction: rtl;">
        <div class="pdf-header" style="padding: 5px; margin-bottom: 10px; padding-right: 30px;">
            <div class="pdf-header-row" style="text-align: center;">
                <div style="text-align: center; margin-bottom: 10px;">
                    <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø´Ø±ÙƒØ©" 
                         style="width: 50px; height: 50px; border-radius: 50%; border: 2px solid #4a90e2; margin-bottom: 5px; margin: 0 auto 5px; display: block;">
                    <h2 style="color: #4a90e2; margin: 0; font-size: 18px;" id="pdf-detailed-company-name">
                        Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©
                    </h2>
                </div>
                <h3 style="color: #4a90e2; margin: 0 0 8px 0; font-size: 16px;" id="pdf-detailed-report-title">ÙƒØ´Ù Ø­Ø³Ø§Ø¨ Ù…ÙˆØ²Ø¹ÙŠÙ† - ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„</h3>
                <div style="margin-bottom: 8px; text-align: center;">
                    <div style="font-size: 14px; font-weight: bold; display: inline-block;">
                        Ø§Ù„ØªÙ‚Ø±ÙŠØ±: <span id="pdf-detailed-report-type"></span>
                    </div>
                    <div style="display: inline-block; width: 1cm;"></div>
                    <div style="font-size: 12px; display: inline-block;">
                        Ø§Ù„ÙØªØ±Ø©: <span id="pdf-detailed-period"></span>
                    </div>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 11px;">
                    <div>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø¬Ù„Ø§Øª: <span id="pdf-detailed-total-records"></span></div>
                    <div>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©: <span id="pdf-detailed-print-date"></span></div>
                </div>
            </div>
        </div>
        
        <div id="pdf-detailed-summary" style="margin-bottom: 10px; padding: 8px; background: #f8f9fa; border-radius: 4px; font-size: 11px; padding-right: 30px;">
        </div>
        
        <table class="detailed-statement-table" id="pdf-detailed-statement-table" style="font-size: 10px; border-collapse: collapse; width: calc(100% - 40px); margin-right: 30px;">
            <thead>
                <tr>
                    <th width="5%" style="padding: 4px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%); color: white;">Ù…</th>
                    <th width="15%" style="padding: 4px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%); color: white;">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹</th>
                    <th width="15%" style="padding: 4px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%); color: white;">Ø§Ù„Ù…Ø·Ø¹Ù…</th>
                    <th width="8%" style="padding: 4px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%); color: white;">Ø£ÙŠØ§Ù… Ø§Ù„Ø¯ÙˆØ§Ù…</th>
                    <th width="8%" style="padding: 4px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%); color: white;">Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</th>
                    <th width="12%" style="padding: 4px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%); color: white;">Ø§Ù„Ø±Ø§ØªØ¨</th>
                    <th width="18%" style="padding: 4px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%); color: white;">Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©</th>
                    <th width="10%" style="padding: 4px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%); color: white;">Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</th>
                    <th width="9%" style="padding: 4px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #d32f2f 0%, #b71c1c 100%); color: white;">Ø§Ù„Ø´Ù‡Ø±</th>
                </tr>
            </thead>
            <tbody id="pdf-detailed-table-body" style="font-size: 9px;">
            </tbody>
        </table>
        
        <div id="pdf-detailed-totals" style="margin-top: 15px; padding: 10px; background: #f8f9fa; border-radius: 4px; font-size: 11px; font-weight: bold; padding-right: 30px;">
        </div>
        
        <div id="pdf-detailed-signature" style="margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; text-align: left; font-size: 8px; color: #d32f2f;">
            Yasser Elkhateeb - Ù…Ø·ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ 67011143
        </div>
    </div>

    <!-- ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø·ÙˆØ± -->
    <div class="signature-card">
        <div class="name">Yasser Elkhateeb</div>
        <div class="title">Ù…Ø·ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ 67011143</div>
    </div>

    <script>
        // Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
        let allData = [];
        let monthlyData = {};
        let uploadedMonths = {};
        let currentMonth = 'Ø§Ù„ÙƒÙ„';
        let currentPage = 1;
        const itemsPerPage = 50;
        let filteredData = [];
        
        // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
        const restaurantData = {
            "Ø§Ø³ÙˆØ§Ù‚ Ø§Ù„Ù‚Ø±ÙŠÙ†": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ© Ø¨Ù†Øª Ø§Ù„Ø¯ÙŠÙƒ": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ© ØªÙƒØ§ Ùˆ ÙØ±Ø§ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ - Ù„ÙŠØ§Ù„ÙŠ Ø§Ù„Ø´Ø±Ù‚": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ - Ù…Ø¬Ù…Ø¹ Ù…ÙƒØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ Ø§Ù„Ø²ÙˆÙŠØ®": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆØªÙ„ÙŠØª": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆÙŠØ§": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø®ÙŠÙˆÙ„": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø§Ù„Ø¯Ø³Ù…Ø© ÙˆØ¨Ù†ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø±": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„Ø±Ø­Ø§Ø¨": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„Ø±Ù‚Ø©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø§Ù„Ø±Ù‚Ø¹ÙŠ": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø±ÙŠ": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø³Ù†Ø¯Ø¨Ø§Ø¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø´Ø±Ù‚": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„Ø´ÙˆÙŠØ® ÙˆØ§Ø±Ù‡": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„Ø¶Ø¨Ø§Ø¹ÙŠØ©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø¹Ø§Ø±Ø¶ÙŠØ© Ø§Ù„Ø­Ø±ÙÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„ÙØ­Ø§Ø­ÙŠÙ„": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ© ÙØ±Ø¹ 2": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„ÙÙ†Ø·Ø§Ø³": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„ÙÙŠØ­Ø§Ø¡": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ù‚Ø§Ø¯Ø³ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ù…Ø·Ø§Ø±": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ù…Ù†Ù‚Ù": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ù†Ø§ÙÙˆØ±Ø©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø£Ø¨ÙˆØ­Ù„ÙŠÙØ©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡ Ø§Ù„ØªØ¹Ø§ÙˆÙ†ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø´Ù‡Ø¯Ø§Ø¡": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø¹Ø¯Ø§Ù† ÙˆØ§Ù„Ù‚ØµÙˆØ±": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù‚ÙŠØ±ÙˆØ§Ù†": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ÙˆÙØ±Ø©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø£Ø¨Ùˆ ÙØ·ÙŠØ±Ø©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø¬Ø§Ø¨Ø± Ø§Ù„Ø£Ø­Ù…Ø¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø­ÙˆÙ„ÙŠ Ø§Ù„ØªØ±ÙÙŠÙ‡ÙŠ": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø®ÙŠØ·Ø§Ù† Ø§Ù„Ø¹ØµÙŠÙ…ÙŠ": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø³Ù„ÙˆÙ‰": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ù„ÙŠØ¨": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø³ÙŠØ¯ ÙŠØ§Ø³ÙŠÙ†": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ†": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø´Ø±Ù‚ Ø§Ù„Ø§Ø­Ù…Ø¯ÙŠ": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø³Ø§Ù„Ù…": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø³Ø§Ù„Ù… - Ø§Ù„Ø¹Ø±ÙŠÙ†": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "ØºØ±Ø¨ Ø£Ø¨Ùˆ ÙØ·ÙŠØ±Ø© Ø§Ù„Ø­Ø±ÙÙŠØ©": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "ÙƒØ¨Ø¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ù…Ø§Ø±ÙŠÙ†Ø§ Ù…ÙˆÙ„ - Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ø§Ø±ÙŠÙ†Ø§": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø§ÙÙ†ÙŠÙˆØ²": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ù…Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙˆØª": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ù…Ø¯ÙŠÙ†Ø© Ø³Ø¹Ø¯ Ø§Ù„Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ù…Ø¯ÙŠÙ†Ø© ØµØ¨Ø§Ø­ Ø§Ù„Ø§Ø­Ù…Ø¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ù…Ø´Ø±Ù": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ù…ÙˆÙ„ 360": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ù†Ø§Ø¯ÙŠ Ø§Ù„ØµÙ„ÙŠØ¨Ø®Ø§Øª": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ù‡Ø¯ÙŠØ©": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø£Ø³ÙˆØ§Ù‚ Ø§Ù„Ù‚Ø±ÙŠÙ†": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ© Ø¨Ù†Øª Ø§Ù„Ø¯ÙŠÙƒ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø¬Ø§Ø¨Ø±ÙŠØ© ØªÙƒØ§ Ùˆ ÙØ±Ø§ÙŠØ¯ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ - Ù„ÙŠØ§Ù„ÙŠ Ø§Ù„Ø´Ø±Ù‚ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ - Ù…Ø¬Ù…Ø¹ Ù…ÙƒØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ø¬Ù‡Ø±Ø§Ø¡ Ø§Ù„ØµÙ†Ø§Ø¹ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆØªÙ„ÙŠØª - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø®ÙŠØ±Ø§Ù† Ø£ÙˆÙŠØ§ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø®ÙŠÙˆÙ„ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø§Ù„Ø¯Ø³Ù…Ø© ÙˆØ¨Ù†ÙŠØ¯ Ø§Ù„Ù‚Ø§Ø± - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„Ø±Ø­Ø§Ø¨ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„Ø±Ù‚Ø© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø§Ù„Ø±Ù‚Ø¹ÙŠ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ø±ÙŠ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø³Ù†Ø¯Ø¨Ø§Ø¯ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø§Ù„Ø´Ø±Ù‚ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„Ø´ÙˆÙŠØ® ÙˆØ§Ø±Ù‡ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„Ø¶Ø¨Ø§Ø¹ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ø¹Ø§Ø±Ø¶ÙŠØ© Ø§Ù„Ø­Ø±ÙÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„ÙØ­Ø§Ø­ÙŠÙ„ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„ÙØ±ÙˆØ§Ù†ÙŠØ© ÙØ±Ø¹ 2 - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø§Ù„ÙÙ†Ø·Ø§Ø³ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø§Ù„ÙÙŠØ­Ø§Ø¡ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ù‚Ø§Ø¯Ø³ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø§Ù„Ù…Ø·Ø§Ø± - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø§Ù„Ù…Ù†Ù‚Ù - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø§Ù„Ù†Ø§ÙÙˆØ±Ø© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø£Ø¨ÙˆØ­Ù„ÙŠÙØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø²Ù‡Ø±Ø§Ø¡ Ø§Ù„ØªØ¹Ø§ÙˆÙ†ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø´Ù‡Ø¯Ø§Ø¡ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ØµÙ„ÙŠØ¨ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ø¹Ø¯Ø§Ù† ÙˆØ§Ù„Ù‚ØµÙˆØ± - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„Ù‚ÙŠØ±ÙˆØ§Ù† - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø§Ù„ÙˆÙØ±Ø© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ø¬Ù…Ø¹ÙŠØ© Ø£Ø¨Ùˆ ÙØ·ÙŠØ±Ø© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ø¬Ù…Ø¹ÙŠØ© Ù…Ø¯ÙŠÙ†Ø© Ø¬Ø§Ø¨Ø± Ø§Ù„Ø£Ø­Ù…Ø¯ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ø­ÙˆÙ„ÙŠ Ø§Ù„ØªØ±ÙÙŠÙ‡ÙŠ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ø®ÙŠØ·Ø§Ù† Ø§Ù„Ø¹ØµÙŠÙ…ÙŠ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ø³Ù„ÙˆÙ‰ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ø³ÙˆÙ‚ Ø§Ù„Ø¬Ù„ÙŠØ¨ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ø³ÙŠØ¯ ÙŠØ§Ø³ÙŠÙ† - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø´Ø§Ø±Ø¹ Ø§Ù„Ø¨Ø­Ø±ÙŠÙ† - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ø´Ø±Ù‚ Ø§Ù„Ø§Ø­Ù…Ø¯ÙŠ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø³Ø§Ù„Ù… - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "ØµØ¨Ø§Ø­ Ø§Ù„Ø³Ø§Ù„Ù… - Ø§Ù„Ø¹Ø±ÙŠÙ† - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "ØºØ±Ø¨ Ø£Ø¨Ùˆ ÙØ·ÙŠØ±Ø© Ø§Ù„Ø­Ø±ÙÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "ÙƒØ¨Ø¯ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø®ØªØ§Ø±" },
            "Ù…Ø§Ø±ÙŠÙ†Ø§ Ù…ÙˆÙ„ - Ø¹Ø§Ù„Ù… Ø§Ù„Ù…Ø§Ø±ÙŠÙ†Ø§ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø·Ø§Ø±Ù‚" },
            "Ù…Ø¬Ù…Ø¹ Ø§Ù„Ø§ÙÙ†ÙŠÙˆØ² - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ù…Ø±ØªØ¶Ù‰" },
            "Ù…Ø¬Ù…Ø¹ Ø§Ù„ÙƒÙˆØª - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø¹Ù…Ø§Ø¯" },
            "Ù…Ø¯ÙŠÙ†Ø© Ø³Ø¹Ø¯ Ø§Ù„Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡ - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ù…Ø¯ÙŠÙ†Ø© ØµØ¨Ø§Ø­ Ø§Ù„Ø§Ø­Ù…Ø¯ - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" },
            "Ù…Ø´Ø±Ù - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø§Ù†ÙˆØ±" },
            "Ù…ÙˆÙ„ 360 - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "ÙˆÙ„ÙŠØ¯" },
            "Ù†Ø§Ø¯ÙŠ Ø§Ù„ØµÙ„ÙŠØ¨Ø®Ø§Øª - Ø¬Ø¯ÙŠØ¯": { manager: "Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ", areaManager: "Ø«Ø±ÙˆØª" },
            "Ù‡Ø¯ÙŠØ© - Ø¬Ø¯ÙŠØ¯": { manager: "Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡", areaManager: "Ø­Ø¬Ø§Ø²ÙŠ" }
        };

        // Ø¹Ù†Ø§ØµØ± DOM
        const loadingDiv = document.getElementById('loading');
        const errorDiv = document.getElementById('error');
        const controlsDiv = document.getElementById('controls');
        const reportContainer = document.getElementById('reportContainer');
        const detailedReportContainer = document.getElementById('detailedReportContainer');
        const statsDiv = document.getElementById('stats');
        const managerSelector = document.getElementById('managerSelector');
        const managerSelect = document.getElementById('managerSelect');

        // Ø§Ù„Ø¨Ø­Ø« Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠ
        let searchTimeout;
        const searchInputs = ['searchCompany', 'searchDistributor', 'searchVehicle', 'searchRestaurant', 'searchManager'];
        
        searchInputs.forEach(id => {
            document.getElementById(id).addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(searchData, 300);
            });
        });

        async function handleMonthUpload(month, input) {
            const file = input.files[0];
            if (!file) return;
            
            showLoading();
            hideError();
            
            try {
                const workbook = await readExcelFile(file);
                const data = await processMonthData(workbook, month);
                
                // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø²Ø±
                const button = input.previousElementSibling;
                button.classList.add('uploaded');
                button.textContent = 'âœ“ ØªÙ… Ø§Ù„ØªØ­Ù…ÙŠÙ„';
                
                uploadedMonths[month] = true;
                
                // Ø¯Ù…Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                monthlyData[month] = data;
                updateAllData();
                
                // Ø¥Ø°Ø§ ÙƒØ§Ù† Ù‡Ø°Ø§ Ø£ÙˆÙ„ Ù…Ù„Ù ÙŠØªÙ… ØªØ­Ù…ÙŠÙ„Ù‡ØŒ Ù‚Ù… Ø¨Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ…
                if (Object.keys(uploadedMonths).length > 0 && controlsDiv.style.display === 'none') {
                    controlsDiv.style.display = 'block';
                    showReport('Ø§Ù„ÙƒÙ„');
                }
                
            } catch (error) {
                showError(`Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù ${month}: ${error.message}`);
            } finally {
                hideLoading();
            }
        }

        async function loadAllMonths() {
            showLoading();
            hideError();
            
            try {
                if (Object.keys(monthlyData).length === 0) {
                    showError('ÙŠØ±Ø¬Ù‰ ØªØ­Ù…ÙŠÙ„ Ù…Ù„ÙØ§Øª Ø§Ù„Ø£Ø´Ù‡Ø± Ø£ÙˆÙ„Ø§Ù‹');
                    return;
                }
                
                updateAllData();
                showReport('Ø§Ù„ÙƒÙ„');
                
            } catch (error) {
                showError(`Ø­Ø¯Ø« Ø®Ø·Ø£: ${error.message}`);
            } finally {
                hideLoading();
            }
        }

        function readExcelFile(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    try {
                        const data = new Uint8Array(e.target.result);
                        const workbook = XLSX.read(data, { type: 'array' });
                        resolve(workbook);
                    } catch (error) {
                        reject(error);
                    }
                };
                
                reader.onerror = function() {
                    reject(new Error('ÙØ´Ù„ ÙÙŠ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ù…Ù„Ù'));
                };
                
                reader.readAsArrayBuffer(file);
            });
        }

        async function processMonthData(workbook, month) {
            const monthData = [];
            
            workbook.SheetNames.forEach(sheetName => {
                // ØªØ¬Ø§Ù‡Ù„ Ø´ÙŠØª Ø¨Ø§Ø³Ù… "list"
                if (sheetName.toLowerCase().includes('list')) {
                    console.log(`ØªÙ… ØªØ¬Ø§Ù‡Ù„ Ø´ÙŠØª: ${sheetName}`);
                    return;
                }
                
                const worksheet = workbook.Sheets[sheetName];
                const data = XLSX.utils.sheet_to_json(worksheet, { header: 1 });
                
                // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© Ù…Ù† Ø§Ù„Ø®Ù„ÙŠØ© G2 (Ø§Ù„ØµÙ 2ØŒ Ø§Ù„Ø¹Ù…ÙˆØ¯ 7) Ø£Ùˆ Ø£ÙŠ Ù…ÙƒØ§Ù† Ø¢Ø®Ø±
                let companyName = '';
                if (data[1] && data[1][6]) {
                    companyName = String(data[1][6]).trim();
                    // ØªÙ†Ø¸ÙŠÙ Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© - Ø¨Ø¯ÙˆÙ† Ø¥Ø¬Ø¨Ø§Ø± Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø© "Ø´Ø±ÙƒØ©"
                    if (companyName) {
                        companyName = companyName.replace(/^\s*Ø´Ø±ÙƒØ©\s*/i, '').replace(/\s*Ø´Ø±ÙƒØ©\s*$/i, '').trim();
                        // Ø¥Ø°Ø§ Ù„Ù… ÙŠÙƒÙ† ÙØ§Ø±ØºØ§Ù‹ØŒ Ù†ØªØ±ÙƒÙ‡ ÙƒÙ…Ø§ Ù‡Ùˆ Ø¨Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ© "Ø´Ø±ÙƒØ©"
                    }
                }
                
                // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ© ÙÙŠ G2ØŒ Ø¬Ø±Ø¨ Ø§Ù„Ø¨Ø­Ø« ÙÙŠ Ø§Ù„Ø®Ù„Ø§ÙŠØ§ Ø§Ù„Ø£Ø®Ø±Ù‰
                if (!companyName || companyName === '') {
                    for (let i = 0; i < Math.min(5, data.length); i++) {
                        for (let j = 0; j < data[i]?.length; j++) {
                            const cell = data[i][j];
                            if (typeof cell === 'string') {
                                const cellLower = cell.toLowerCase();
                                // Ø§Ù„Ø¨Ø­Ø« Ø¹Ù† Ø£ÙŠ Ø§Ø³Ù… ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ÙƒÙ„Ù…Ø§Øª ØªØ¯Ù„ Ø¹Ù„Ù‰ Ø´Ø±ÙƒØ©
                                if ((cellLower.includes('Ø´Ø±ÙƒØ©') || cellLower.includes('Ù…Ø¤Ø³Ø³Ø©') || cellLower.includes('Ù…ÙƒØªØ¨')) && !cellLower.includes('Ù†Ø§ÙŠÙ')) {
                                    let extractedName = cell.trim();
                                    // ØªÙ†Ø¸ÙŠÙ Ø¯ÙˆÙ† Ø¥Ø¶Ø§ÙØ© ÙƒÙ„Ù…Ø© "Ø´Ø±ÙƒØ©"
                                    extractedName = extractedName.replace(/^\s*(Ø´Ø±ÙƒØ©|Ù…Ø¤Ø³Ø³Ø©|Ù…ÙƒØªØ¨)\s*/i, '').replace(/\s*(Ø´Ø±ÙƒØ©|Ù…Ø¤Ø³Ø³Ø©|Ù…ÙƒØªØ¨)\s*$/i, '').trim();
                                    if (extractedName !== '') {
                                        companyName = extractedName;
                                        break;
                                    }
                                }
                            }
                        }
                        if (companyName && companyName !== '') break;
                    }
                }
                
                // Ø¥Ø°Ø§ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©ØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø§Ø³Ù… Ø§Ù„ÙˆØ±Ù‚Ø©
                if (!companyName || companyName === '') {
                    companyName = sheetName;
                }
                
                const startRow = findDataStartRow(data);
                if (startRow === -1) return;
                
                const headers = data[startRow];
                
                for (let i = startRow + 1; i < data.length; i++) {
                    const row = data[i];
                    if (!row || row.length < 2) continue;
                    
                    const distributorData = extractDistributorData(row, headers, companyName, month, sheetName);
                    if (distributorData && distributorData.Ø§Ø³Ù… && distributorData.Ø§Ø³Ù….trim() !== '') {
                        monthData.push(distributorData);
                    }
                }
            });
            
            console.log(`ØªÙ… Ù…Ø¹Ø§Ù„Ø¬Ø© Ø¨ÙŠØ§Ù†Ø§Øª ${month}:`, monthData.length, 'Ø³Ø¬Ù„');
            return monthData;
        }

        function findDataStartRow(data) {
            for (let i = 0; i < Math.min(20, data.length); i++) {
                const row = data[i];
                if (!row) continue;
                
                for (let j = 0; j < Math.min(10, row.length); j++) {
                    const cell = row[j];
                    if (typeof cell === 'string') {
                        const cellLower = cell.toLowerCase();
                        if (cellLower.includes('Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹') || cellLower.includes('Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…')) {
                            return i;
                        }
                    }
                }
            }
            return -1;
        }

        function extractDistributorData(row, headers, companyName, month, sheetName) {
            if (!row[0] || String(row[0]).trim() === '') return null;
            
            const data = {
                Ø±Ù‚Ù…: '',
                Ø§Ø³Ù…: '',
                Ù…Ø·Ø¹Ù…: '',
                Ø§ÙŠØ§Ù…: 0,
                Ø³Ø§Ø¹Ø§Øª: 0,
                Ø±Ø§ØªØ¨: 0,
                Ø´Ø±ÙƒØ©: companyName,
                Ø´Ù‡Ø±: month,
                Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©: 'Ø³ÙŠØ§Ø±Ø©',
                Ù…Ù„Ø§Ø­Ø¸Ø§Øª: '',
                Ø´ÙŠØª: sheetName,
                Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„: '',
                Ù…Ø¯ÙŠØ±_Ø§Ù„Ù…Ù†Ø·Ù‚Ø©: ''
            };
            
            // Ø®Ø±ÙŠØ·Ø© Ø±Ø¨Ø· Ø§Ù„Ø£Ø¹Ù…Ø¯Ø© Ø¨Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
            const columnMap = {};
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø®Ø±ÙŠØ·Ø© Ù„Ù„Ø£Ø¹Ù…Ø¯Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
            headers.forEach((header, index) => {
                if (header && typeof header === 'string') {
                    const headerLower = header.toLowerCase().trim();
                    columnMap[headerLower] = index;
                }
            });
            
            // Ø§Ø³ØªØ®Ø±Ø§Ø¬ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©
            data.Ø§Ø³Ù… = getCellValue(row, columnMap, ['Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹', 'Ø§Ø³Ù…', 'Ø§Ù„Ù…ÙˆØ²Ø¹', 'Ø§Ù„Ø§Ø³Ù…', 'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù']);
            data.mØ·Ø¹Ù… = getCellValue(row, columnMap, ['Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…', 'Ø§Ù„Ù…Ø·Ø¹Ù…', 'Ù…Ø·Ø¹Ù…', 'Ø§Ù„Ù…Ø·Ø¹Ù… / Ø§Ù„ÙØ±Ø¹']);
            
            const daysValue = getCellValue(row, columnMap, ['Ø¹Ø¯Ø¯ Ø£ÙŠØ§Ù… Ø§Ù„Ø¯ÙˆØ§Ù…', 'Ø£ÙŠØ§Ù… Ø§Ù„Ø¯ÙˆØ§Ù…', 'Ø§ÙŠØ§Ù…', 'Ø£ÙŠØ§Ù…', 'Ø¹Ø¯Ø¯ Ø§Ù„Ø£ÙŠØ§Ù…', 'Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„']);
            if (daysValue && daysValue !== '' && !isNaN(parseFloat(daysValue))) {
                data.Ø§ÙŠØ§Ù… = parseFloat(daysValue);
            }
            
            const hoursValue = getCellValue(row, columnMap, ['Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª', 'Ø§Ø¬Ù…Ø§Ù„ÙŠ Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„', 'Ø³Ø§Ø¹Ø§Øª', 'Ø§Ù„Ø³Ø§Ø¹Ø§Øª', 'Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª', 'Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„']);
            if (hoursValue && hoursValue !== '' && !isNaN(parseFloat(hoursValue))) {
                data.Ø³Ø§Ø¹Ø§Øª = parseFloat(hoursValue);
            }
            
            const salaryValue = getCellValue(row, columnMap, ['Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ù…Ø³ØªØ­Ù‚', 'Ø±Ø§ØªØ¨', 'Ø§Ù„Ø±Ø§ØªØ¨', 'Ø£Ø¬Ø± Ø§Ù„Ø³Ø§Ø¹Ø©', 'Ø§Ù„Ù…Ø³ØªØ­Ù‚', 'Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ']);
            if (salaryValue && salaryValue !== '' && !isNaN(parseFloat(salaryValue))) {
                data.Ø±Ø§ØªØ¨ = parseFloat(salaryValue);
            }
            
            data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© = getCellValue(row, columnMap, ['Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©', 'Ø§Ù„Ù…Ø±ÙƒØ¨Ø©', 'Ù†ÙˆØ¹', 'ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ù†Ù‚Ù„', 'Ù†ÙˆØ¹ ÙˆØ³ÙŠÙ„Ø© Ø§Ù„Ù†Ù‚Ù„']) || 'Ø³ÙŠØ§Ø±Ø©';
            data.Ù…Ù„Ø§Ø­Ø¸Ø§Øª = getCellValue(row, columnMap, ['Ù…Ù„Ø§Ø­Ø¸Ø§Øª', 'Ù…Ù„Ø§Ø­Ø¸Ø©']) || '';
            
            // ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
            if (data.Ø§Ø³Ù…) data.Ø§Ø³Ù… = data.Ø§Ø³Ù….trim();
            if (data.mØ·Ø¹Ù…) {
                data.mØ·Ø¹Ù… = data.mØ·Ø¹Ù….trim();
                // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ ÙˆÙ…Ø¯ÙŠØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…
                const restaurantInfo = restaurantData[data.mØ·Ø¹Ù…];
                if (restaurantInfo) {
                    data.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ = restaurantInfo.manager;
                    data.Ù…Ø¯ÙŠØ±_Ø§Ù„Ù…Ù†Ø·Ù‚Ø© = restaurantInfo.areaManager;
                }
            }
            if (data.Ø´Ø±ÙƒØ©) data.Ø´Ø±ÙƒØ© = data.Ø´Ø±ÙƒØ©.trim();
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©
            if (data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.toLowerCase().includes('Ø³ÙŠÙƒÙ„') || data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.toLowerCase().includes('Ø¯Ø±Ø§Ø¬Ø©')) {
                data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© = 'Ø³ÙŠÙƒÙ„';
            } else if (data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.toLowerCase().includes('Ø³ÙŠØ§Ø±Ø©') || data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.toLowerCase().includes('Ù…Ø±ÙƒØ¨Ø©')) {
                data.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© = 'Ø³ÙŠØ§Ø±Ø©';
            }
            
            return data;
        }

        function getCellValue(row, columnMap, possibleHeaders) {
            for (const header of possibleHeaders) {
                if (columnMap[header.toLowerCase()] !== undefined) {
                    const value = row[columnMap[header.toLowerCase()]];
                    if (value !== undefined && value !== null && value !== '') {
                        return String(value).trim();
                    }
                }
            }
            return '';
        }

        function updateAllData() {
            allData = [];
            Object.values(monthlyData).forEach(monthData => {
                allData = [...allData, ...monthData];
            });
            console.log('Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª:', allData.length);
        }

        function showReport(month) {
            currentMonth = month;
            filteredData = month === 'Ø§Ù„ÙƒÙ„' ? allData : (monthlyData[month] || []);
            
            displayReport(filteredData);
            updateStats(filteredData, month);
            
            if (document.getElementById('detailed-tab').classList.contains('active')) {
                currentPage = 1;
                updateDetailedReport(filteredData);
            }
        }

        function displayReport(data) {
            if (data.length === 0) {
                reportContainer.innerHTML = `
                    <div class="no-data">
                        <h3 style="color: #666;">âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§</h3>
                        <p>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ${currentMonth === 'Ø§Ù„ÙƒÙ„' ? '' : 'Ù„Ø´Ù‡Ø± ' + currentMonth}</p>
                    </div>
                `;
                return;
            }
            
            let html = `
                <div style="margin-bottom: 20px; text-align: center;">
                    <h3 style="color: #2c3e50; margin: 0;">
                        ${currentMonth === 'Ø§Ù„ÙƒÙ„' ? 'ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…Ø¬Ù…Ø¹ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø´Ù‡Ø±' : 'ğŸ“… ØªÙ‚Ø±ÙŠØ± Ø´Ù‡Ø± ' + currentMonth}
                    </h3>
                    <p style="color: #666; margin-top: 5px;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ ${data.length} Ø³Ø¬Ù„</p>
                </div>
                
                <div class="detailed-report">
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Ù…</th>
                                <th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹</th>
                                <th>Ø§Ù„Ù…Ø·Ø¹Ù…</th>
                                <th>Ø£ÙŠØ§Ù… Ø§Ù„Ø¯ÙˆØ§Ù…</th>
                                <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</th>
                                <th>Ø§Ù„Ø±Ø§ØªØ¨</th>
                                <th>Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©</th>
                                <th>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</th>
                                <th>Ø§Ù„Ø´Ù‡Ø±</th>
                                <th>Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            data.slice(0, 100).forEach((item, index) => {
                html += `
                    <tr>
                        <td>${index + 1}</td>
                        <td>${item.Ø§Ø³Ù… || ''}</td>
                        <td>${item.mØ·Ø¹Ù… || ''}</td>
                        <td>${item.Ø§ÙŠØ§Ù… > 0 ? item.Ø§ÙŠØ§Ù… : ''}</td>
                        <td>${item.Ø³Ø§Ø¹Ø§Øª > 0 ? item.Ø³Ø§Ø¹Ø§Øª : ''}</td>
                        <td>${item.Ø±Ø§ØªØ¨ > 0 ? item.Ø±Ø§ØªØ¨.toFixed(3) : ''}</td>
                        <td>${item.Ø´Ø±ÙƒØ© || ''}</td>
                        <td>${item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© || ''}</td>
                        <td>${item.Ø´Ù‡Ø± || ''}</td>
                        <td>${item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ || ''}</td>
                    </tr>
                `;
            });
            
            html += `</tbody></table></div>`;
            
            if (data.length > 100) {
                html += `<p style="text-align: center; color: #666; margin-top: 10px;">
                    ÙŠØªÙ… Ø¹Ø±Ø¶ Ø£ÙˆÙ„ 100 Ø³Ø¬Ù„ Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ ${data.length} Ø³Ø¬Ù„. Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙØµÙ„ Ù„Ø¹Ø±Ø¶ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.
                </p>`;
            }
            
            reportContainer.innerHTML = html;
        }

        function updateDetailedReport(data) {
            if (data.length === 0) {
                detailedReportContainer.innerHTML = `
                    <div class="no-data">
                        <h3 style="color: #666;">âš ï¸ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø¹Ø±Ø¶Ù‡Ø§</h3>
                        <p>Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø¨ÙŠØ§Ù†Ø§Øª ${currentMonth === 'Ø§Ù„ÙƒÙ„' ? '' : 'Ù„Ø´Ù‡Ø± ' + currentMonth}</p>
                    </div>
                `;
                return;
            }
            
            const startIndex = (currentPage - 1) * itemsPerPage;
            const endIndex = Math.min(startIndex + itemsPerPage, data.length);
            const pageData = data.slice(startIndex, endIndex);
            
            let html = `
                <div style="margin-bottom: 20px; text-align: center;">
                    <h3 style="color: #2c3e50; margin: 0;">
                        ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù…ÙØµÙ„ - ${currentMonth === 'Ø§Ù„ÙƒÙ„' ? 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø´Ù‡Ø±' : 'Ø´Ù‡Ø± ' + currentMonth}
                    </h3>
                    <p style="color: #666; margin-top: 5px;">
                        Ø¹Ø±Ø¶ ${startIndex + 1} Ø¥Ù„Ù‰ ${endIndex} Ù…Ù† Ø¥Ø¬Ù…Ø§Ù„ÙŠ ${data.length} Ø³Ø¬Ù„
                    </p>
                </div>
                
                <div class="detailed-report">
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>Ù…</th>
                                <th>Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹</th>
                                <th>Ø§Ù„Ù…Ø·Ø¹Ù…</th>
                                <th>Ø£ÙŠØ§Ù… Ø§Ù„Ø¯ÙˆØ§Ù…</th>
                                <th>Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</th>
                                <th>Ø§Ù„Ø±Ø§ØªØ¨</th>
                                <th>Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©</th>
                                <th>Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©</th>
                                <th>Ø§Ù„Ø´Ù‡Ø±</th>
                                <th>Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„</th>
                                <th>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©</th>
                            </tr>
                        </thead>
                        <tbody>
            `;
            
            pageData.forEach((item, index) => {
                html += `
                    <tr>
                        <td>${startIndex + index + 1}</td>
                        <td><strong>${item.Ø§Ø³Ù… || ''}</strong></td>
                        <td>${item.mØ·Ø¹Ù… || ''}</td>
                        <td><span style="color: #1976d2; font-weight: bold;">${item.Ø§ÙŠØ§Ù… > 0 ? item.Ø§ÙŠØ§Ù… : ''}</span></td>
                        <td><span style="color: #388e3c; font-weight: bold;">${item.Ø³Ø§Ø¹Ø§Øª > 0 ? item.Ø³Ø§Ø¹Ø§Øª : ''}</span></td>
                        <td><strong style="color: #d32f2f;">${item.Ø±Ø§ØªØ¨ > 0 ? item.Ø±Ø§ØªØ¨.toFixed(3) : ''}</strong></td>
                        <td><span style="background: #e3f2fd; padding: 3px 8px; border-radius: 4px;">${item.Ø´Ø±ÙƒØ© || ''}</span></td>
                        <td>
                            ${item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© ? `
                            <span style="background: ${item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„' ? '#e8f5e9' : '#fff3e0'}; 
                                   padding: 3px 8px; border-radius: 4px; font-weight: 500;">
                                ${item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„' ? 'ğŸš² Ø³ÙŠÙƒÙ„' : 'ğŸš— Ø³ÙŠØ§Ø±Ø©'}
                            </span>
                            ` : ''}
                        </td>
                        <td>${item.Ø´Ù‡Ø± || ''}</td>
                        <td><span style="background: #f3e5f5; padding: 3px 8px; border-radius: 4px;">${item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ || ''}</span></td>
                        <td><span style="background: #e0f2f1; padding: 3px 8px; border-radius: 4px;">${item.Ù…Ø¯ÙŠØ±_Ø§Ù„Ù…Ù†Ø·Ù‚Ø© || ''}</span></td>
                    </tr>
                `;
            });
            
            html += `</tbody></table></div>`;
            
            const totalPages = Math.ceil(data.length / itemsPerPage);
            if (totalPages > 1) {
                html += createPagination(totalPages);
            }
            
            detailedReportContainer.innerHTML = html;
        }

        function createPagination(totalPages) {
            let html = `<div class="pagination">`;
            
            if (currentPage > 1) {
                html += `<button class="page-btn" onclick="changePage(1)">Ø§Ù„Ø£ÙˆÙ„Ù‰</button>`;
                html += `<button class="page-btn" onclick="changePage(${currentPage - 1})">Ø§Ù„Ø³Ø§Ø¨Ù‚</button>`;
            }
            
            const startPage = Math.max(1, currentPage - 2);
            const endPage = Math.min(totalPages, currentPage + 2);
            
            for (let i = startPage; i <= endPage; i++) {
                html += `
                    <button class="page-btn ${i === currentPage ? 'active' : ''}" 
                            onclick="changePage(${i})">
                        ${i}
                    </button>
                `;
            }
            
            if (currentPage < totalPages) {
                html += `<button class="page-btn" onclick="changePage(${currentPage + 1})">Ø§Ù„ØªØ§Ù„ÙŠ</button>`;
                html += `<button class="page-btn" onclick="changePage(${totalPages})">Ø§Ù„Ø£Ø®ÙŠØ±Ø©</button>`;
            }
            
            html += `</div>`;
            return html;
        }

        function changePage(page) {
            currentPage = page;
            updateDetailedReport(filteredData);
        }

        function updateStats(data, month) {
            if (!statsDiv) {
                console.error('statsDiv ØºÙŠØ± Ù…Ø¹Ø±Ù‘Ù');
                return;
            }
            
            if (data.length === 0) {
                statsDiv.style.display = 'none';
                return;
            }
            
            const totalEmployees = data.length;
            const totalDays = data.reduce((sum, item) => sum + (item.Ø§ÙŠØ§Ù… || 0), 0);
            const totalHours = data.reduce((sum, item) => sum + (item.Ø³Ø§Ø¹Ø§Øª || 0), 0);
            const totalSalary = data.reduce((sum, item) => sum + (item.Ø±Ø§ØªØ¨ || 0), 0);
            const avgSalary = totalEmployees > 0 ? totalSalary / totalEmployees : 0;
            const uniqueCompanies = [...new Set(data.map(item => item.Ø´Ø±ÙƒØ©))].filter(c => c && c !== '').length;
            const uniqueRestaurants = [...new Set(data.map(item => item.mØ·Ø¹Ù…))].filter(r => r && r !== '').length;
            const cars = data.filter(item => item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©').length;
            const bikes = data.filter(item => item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„').length;
            const managers = {};
            data.forEach(item => {
                if (item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„) {
                    managers[item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„] = (managers[item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„] || 0) + 1;
                }
            });
            const uniqueManagers = Object.keys(managers).length;
            
            statsDiv.innerHTML = `
                <div class="stat-card">
                    <h3>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†</h3>
                    <p class="value">${totalEmployees}</p>
                </div>
                <div class="stat-card">
                    <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„</h3>
                    <p class="value">${totalDays}</p>
                </div>
                <div class="stat-card">
                    <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª</h3>
                    <p class="value">${totalHours}</p>
                </div>
                <div class="stat-card">
                    <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</h3>
                    <p class="value">${totalSalary.toFixed(3)}</p>
                </div>
                <div class="stat-card">
                    <h3>Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø§ØªØ¨</h3>
                    <p class="value">${avgSalary.toFixed(3)}</p>
                </div>
                <div class="stat-card">
                    <h3>Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø±ÙƒØ§Øª</h3>
                    <p class="value">${uniqueCompanies}</p>
                </div>
                <div class="stat-card">
                    <h3>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·Ø§Ø¹Ù…</h3>
                    <p class="value">${uniqueRestaurants}</p>
                </div>
                <div class="stat-card">
                    <h3>Ø³ÙŠØ§Ø±Ø§Øª ğŸš—</h3>
                    <p class="value">${cars}</p>
                </div>
                <div class="stat-card">
                    <h3>Ø³ÙŠÙƒÙ„ ğŸš²</h3>
                    <p class="value">${bikes}</p>
                </div>
                <div class="stat-card">
                    <h3>Ø¹Ø¯Ø¯ Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„</h3>
                    <p class="value">${uniqueManagers}</p>
                </div>
            `;
            
            statsDiv.style.display = 'grid';
        }

        function searchData() {
            const company = document.getElementById('searchCompany').value.toLowerCase();
            const distributor = document.getElementById('searchDistributor').value.toLowerCase();
            const vehicle = document.getElementById('searchVehicle').value.toLowerCase();
            const restaurant = document.getElementById('searchRestaurant').value.toLowerCase();
            const manager = document.getElementById('searchManager').value.toLowerCase();
            
            let dataToFilter = currentMonth === 'Ø§Ù„ÙƒÙ„' ? allData : (monthlyData[currentMonth] || []);
            
            filteredData = dataToFilter.filter(item => {
                let match = true;
                
                if (company && item.Ø´Ø±ÙƒØ©) {
                    match = match && item.Ø´Ø±ÙƒØ©.toLowerCase().includes(company);
                }
                
                if (distributor && item.Ø§Ø³Ù…) {
                    match = match && item.Ø§Ø³Ù….toLowerCase().includes(distributor);
                }
                
                if (vehicle && item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©) {
                    match = match && item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø©.toLowerCase().includes(vehicle);
                }
                
                if (restaurant && item.mØ·Ø¹Ù…) {
                    match = match && item.mØ·Ø¹Ù….toLowerCase().includes(restaurant);
                }
                
                if (manager && item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„) {
                    match = match && item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„.toLowerCase().includes(manager);
                }
                
                return match;
            });
            
            currentPage = 1;
            updateDetailedReport(filteredData);
            updateStats(filteredData, currentMonth);
        }

        function clearSearch() {
            document.getElementById('searchCompany').value = '';
            document.getElementById('searchDistributor').value = '';
            document.getElementById('searchVehicle').value = '';
            document.getElementById('searchRestaurant').value = '';
            document.getElementById('searchManager').value = '';
            
            filteredData = currentMonth === 'Ø§Ù„ÙƒÙ„' ? allData : (monthlyData[currentMonth] || []);
            currentPage = 1;
            updateDetailedReport(filteredData);
            updateStats(filteredData, currentMonth);
        }

        function compareSelectedMonths() {
            const selectedMonths = Array.from(document.querySelectorAll('.compare-month:checked'))
                .map(cb => cb.value);
            
            if (selectedMonths.length < 2) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø´Ù‡Ø±ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©');
                return;
            }
            
            showComparison(selectedMonths);
        }

        function compareAllMonths() {
            const allMonths = Object.keys(monthlyData);
            if (allMonths.length < 2) {
                alert('ÙŠØ¬Ø¨ ØªØ­Ù…ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø´Ù‡Ø±ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©');
                return;
            }
            
            document.querySelectorAll('.compare-month').forEach(cb => {
                cb.checked = monthlyData[cb.value] ? true : false;
            });
            
            showComparison(allMonths);
        }

        function showComparison(months) {
            const comparisonResult = document.getElementById('comparisonResult');
            let html = `<div class="comparison-results">`;
            
            months.forEach(month => {
                const data = monthlyData[month] || [];
                const stats = calculateMonthStats(data);
                
                html += `
                    <div class="comparison-card">
                        <h4 style="color: #1976d2; text-align: center; margin-bottom: 15px;">${month}</h4>
                        <div style="font-size: 14px;">
                            <p><strong>ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†:</strong> ${stats.totalEmployees}</p>
                            <p><strong>ğŸ“… Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„:</strong> ${stats.totalDays}</p>
                            <p><strong>â° Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª:</strong> ${stats.totalHours}</p>
                            <p><strong>ğŸ’° Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨:</strong> ${stats.totalSalary.toFixed(3)}</p>
                            <p><strong>ğŸ“ˆ Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø§ØªØ¨:</strong> ${stats.avgSalary.toFixed(3)}</p>
                            <p><strong>ğŸ¢ Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø±ÙƒØ§Øª:</strong> ${stats.uniqueCompanies}</p>
                            <p><strong>ğŸª Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·Ø§Ø¹Ù…:</strong> ${stats.uniqueRestaurants}</p>
                            <p><strong>ğŸš— Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª:</strong> ${stats.cars}</p>
                            <p><strong>ğŸš² Ø¹Ø¯Ø¯ Ø§Ù„Ø³ÙŠÙƒÙ„:</strong> ${stats.bikes}</p>
                            <p><strong>ğŸ‘¨â€ğŸ’¼ Ø¹Ø¯Ø¯ Ù…Ø¯Ø±Ø§Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„:</strong> ${stats.uniqueManagers}</p>
                        </div>
                    </div>
                `;
            });
            
            html += `</div>`;
            
            if (months.length > 1) {
                const allDataForComparison = months.flatMap(month => monthlyData[month] || []);
                const totalStats = calculateMonthStats(allDataForComparison);
                
                html += `
                    <div style="margin-top: 30px; background: #fff8e1; padding: 20px; border-radius: 10px;">
                        <h4 style="color: #ff8f00; text-align: center;">ğŸ“ˆ Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© (${months.length} Ø´Ù‡Ø±)</h4>
                        <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px; margin-top: 15px;">
                            <div>
                                <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†:</strong> ${totalStats.totalEmployees}</p>
                                <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„:</strong> ${totalStats.totalDays}</p>
                                <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª:</strong> ${totalStats.totalHours}</p>
                                <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³ÙŠØ§Ø±Ø§Øª:</strong> ${totalStats.cars}</p>
                            </div>
                            <div>
                                <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨:</strong> ${totalStats.totalSalary.toFixed(3)}</p>
                                <p><strong>Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø§ØªØ¨:</strong> ${totalStats.avgSalary.toFixed(3)}</p>
                                <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´Ø±ÙƒØ§Øª:</strong> ${totalStats.uniqueCompanies}</p>
                                <p><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³ÙŠÙƒÙ„:</strong> ${totalStats.bikes}</p>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            comparisonResult.innerHTML = html;
        }

        function generateComparisonTable() {
            const selectedMonths = Array.from(document.querySelectorAll('.compare-month:checked'))
                .map(cb => cb.value);
            
            if (selectedMonths.length === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø´Ù‡Ø± Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const comparisonResult = document.getElementById('comparisonResult');
            
            // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ Ù„ÙƒÙ„ Ø´Ù‡Ø± (Ø¨Ø§Ù„Ø±ÙˆØ§ØªØ¨)
            const managerStats = {};
            const allManagers = new Set();
            
            selectedMonths.forEach(month => {
                const data = monthlyData[month] || [];
                managerStats[month] = {};
                
                // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ (Ø¨Ø§Ù„Ø±ÙˆØ§ØªØ¨)
                data.forEach(item => {
                    const manager = item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                    allManagers.add(manager);
                    
                    if (!managerStats[month][manager]) {
                        managerStats[month][manager] = {
                            carSalary: 0,
                            bikeSalary: 0,
                            totalSalary: 0,
                            employees: 0
                        };
                    }
                    
                    if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©') {
                        managerStats[month][manager].carSalary += item.Ø±Ø§ØªØ¨ || 0;
                    } else if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„') {
                        managerStats[month][manager].bikeSalary += item.Ø±Ø§ØªØ¨ || 0;
                    }
                    
                    managerStats[month][manager].totalSalary += item.Ø±Ø§ØªØ¨ || 0;
                    managerStats[month][manager].employees++;
                });
            });
            
            // ØªØ­Ø¯ÙŠØ« Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø¯ÙŠØ±ÙŠÙ†
            updateManagerSelector(Array.from(allManagers).filter(m => m && m !== 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ'));
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø© (Ø¨Ø§Ù„Ø±ÙˆØ§ØªØ¨)
            let html = `
                <div style="margin-top: 30px;">
                    <h3 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">ğŸ“Š Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ù„Ù„Ø£Ø´Ù‡Ø±</h3>
                    <div class="comparison-table-container">
                        <table class="comparison-table">
                            <thead>
                                <tr>
                                    <th rowspan="2" style="background: linear-gradient(135deg, #424242 0%, #212121 100%); color: white;">Ø§Ù„Ø´Ù‡Ø±</th>
                                    <th colspan="3" class="month-header">Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ</th>
                                    <th colspan="3" class="month-header">Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡</th>
                                    <th colspan="3" class="month-header">Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰</th>
                                    <th colspan="4" style="background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ø´Ù‡Ø±</th>
                                </tr>
                                <tr>
                                    <!-- Ø£Ø¹Ù…Ø¯Ø© Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ -->
                                    <th>Ø±ÙˆØ§ØªØ¨ Ø³ÙŠØ§Ø±Ø§Øª</th>
                                    <th>Ø±ÙˆØ§ØªØ¨ Ø³ÙŠÙƒÙ„</th>
                                    <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</th>
                                    <!-- Ø£Ø¹Ù…Ø¯Ø© Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ -->
                                    <th>Ø±ÙˆØ§ØªØ¨ Ø³ÙŠØ§Ø±Ø§Øª</th>
                                    <th>Ø±ÙˆØ§ØªØ¨ Ø³ÙŠÙƒÙ„</th>
                                    <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</th>
                                    <!-- Ø£Ø¹Ù…Ø¯Ø© Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰ -->
                                    <th>Ø±ÙˆØ§ØªØ¨ Ø³ÙŠØ§Ø±Ø§Øª</th>
                                    <th>Ø±ÙˆØ§ØªØ¨ Ø³ÙŠÙƒÙ„</th>
                                    <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</th>
                                    <!-- Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ -->
                                    <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³ÙŠØ§Ø±Ø§Øª</th>
                                    <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³ÙŠÙƒÙ„</th>
                                    <th>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</th>
                                    <th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†</th>
                                </tr>
                            </thead>
                            <tbody>
            `;
            
            // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø´Ù‡Ø±
            selectedMonths.forEach(month => {
                const monthData = monthlyData[month] || [];
                const tarekStats = managerStats[month]['Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                const haniStats = managerStats[month]['Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                const murtadaStats = managerStats[month]['Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ù„Ù„Ø´Ù‡Ø±
                const totalCarSalary = tarekStats.carSalary + haniStats.carSalary + murtadaStats.carSalary;
                const totalBikeSalary = tarekStats.bikeSalary + haniStats.bikeSalary + murtadaStats.bikeSalary;
                const totalAllSalary = totalCarSalary + totalBikeSalary;
                const totalEmployees = tarekStats.employees + haniStats.employees + murtadaStats.employees;
                
                html += `
                    <tr>
                        <td style="font-weight: bold;">${month}</td>
                        <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ -->
                        <td>${tarekStats.carSalary.toFixed(3)}</td>
                        <td>${tarekStats.bikeSalary.toFixed(3)}</td>
                        <td style="font-weight: bold;">${tarekStats.totalSalary.toFixed(3)}</td>
                        <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ -->
                        <td>${haniStats.carSalary.toFixed(3)}</td>
                        <td>${haniStats.bikeSalary.toFixed(3)}</td>
                        <td style="font-weight: bold;">${haniStats.totalSalary.toFixed(3)}</td>
                        <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰ -->
                        <td>${murtadaStats.carSalary.toFixed(3)}</td>
                        <td>${murtadaStats.bikeSalary.toFixed(3)}</td>
                        <td style="font-weight: bold;">${murtadaStats.totalSalary.toFixed(3)}</td>
                        <!-- Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª -->
                        <td style="background: #e8f5e9; font-weight: bold;">${totalCarSalary.toFixed(3)}</td>
                        <td style="background: #e8f5e9; font-weight: bold;">${totalBikeSalary.toFixed(3)}</td>
                        <td style="background: #c8e6c9; font-weight: bold;">${totalAllSalary.toFixed(3)}</td>
                        <td style="background: #e3f2fd; font-weight: bold;">${totalEmployees}</td>
                    </tr>
                `;
            });
            
            // Ø¥Ø¶Ø§ÙØ© ØµÙ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹
            if (selectedMonths.length > 1) {
                let totalTarekCarSalary = 0, totalTarekBikeSalary = 0, totalTarekSalary = 0, totalTarekEmployees = 0;
                let totalHaniCarSalary = 0, totalHaniBikeSalary = 0, totalHaniSalary = 0, totalHaniEmployees = 0;
                let totalMurtadaCarSalary = 0, totalMurtadaBikeSalary = 0, totalMurtadaSalary = 0, totalMurtadaEmployees = 0;
                let grandTotalCarSalary = 0, grandTotalBikeSalary = 0, grandTotalSalary = 0, grandTotalEmployees = 0;
                
                selectedMonths.forEach(month => {
                    const tarekStats = managerStats[month]['Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                    const haniStats = managerStats[month]['Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                    const murtadaStats = managerStats[month]['Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                    
                    totalTarekCarSalary += tarekStats.carSalary;
                    totalTarekBikeSalary += tarekStats.bikeSalary;
                    totalTarekSalary += tarekStats.totalSalary;
                    totalTarekEmployees += tarekStats.employees;
                    
                    totalHaniCarSalary += haniStats.carSalary;
                    totalHaniBikeSalary += haniStats.bikeSalary;
                    totalHaniSalary += haniStats.totalSalary;
                    totalHaniEmployees += haniStats.employees;
                    
                    totalMurtadaCarSalary += murtadaStats.carSalary;
                    totalMurtadaBikeSalary += murtadaStats.bikeSalary;
                    totalMurtadaSalary += murtadaStats.totalSalary;
                    totalMurtadaEmployees += murtadaStats.employees;
                });
                
                grandTotalCarSalary = totalTarekCarSalary + totalHaniCarSalary + totalMurtadaCarSalary;
                grandTotalBikeSalary = totalTarekBikeSalary + totalHaniBikeSalary + totalMurtadaBikeSalary;
                grandTotalSalary = totalTarekSalary + totalHaniSalary + totalMurtadaSalary;
                grandTotalEmployees = totalTarekEmployees + totalHaniEmployees + totalMurtadaEmployees;
                
                html += `
                    <tr class="total-row">
                        <td style="font-weight: bold;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</td>
                        <!-- Ù…Ø¬Ø§Ù…ÙŠØ¹ Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ -->
                        <td>${totalTarekCarSalary.toFixed(3)}</td>
                        <td>${totalTarekBikeSalary.toFixed(3)}</td>
                        <td style="font-weight: bold;">${totalTarekSalary.toFixed(3)}</td>
                        <!-- Ù…Ø¬Ø§Ù…ÙŠØ¹ Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ -->
                        <td>${totalHaniCarSalary.toFixed(3)}</td>
                        <td>${totalHaniBikeSalary.toFixed(3)}</td>
                        <td style="font-weight: bold;">${totalHaniSalary.toFixed(3)}</td>
                        <!-- Ù…Ø¬Ø§Ù…ÙŠØ¹ Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰ -->
                        <td>${totalMurtadaCarSalary.toFixed(3)}</td>
                        <td>${totalMurtadaBikeSalary.toFixed(3)}</td>
                        <td style="font-weight: bold;">${totalMurtadaSalary.toFixed(3)}</td>
                        <!-- Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„ÙŠØ© -->
                        <td style="background: #ffcc80; font-weight: bold;">${grandTotalCarSalary.toFixed(3)}</td>
                        <td style="background: #ffcc80; font-weight: bold;">${grandTotalBikeSalary.toFixed(3)}</td>
                        <td style="background: #ffb74d; font-weight: bold;">${grandTotalSalary.toFixed(3)}</td>
                        <td style="background: #bbdefb; font-weight: bold;">${grandTotalEmployees}</td>
                    </tr>
                `;
            }
            
            html += `</tbody></table></div></div>`;
            
            comparisonResult.innerHTML = html;
        }

        function updateManagerSelector(managers) {
            managerSelect.innerHTML = '<option value="">Ø§Ø®ØªØ± Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„</option>';
            managers.forEach(manager => {
                if (manager && manager.trim() !== '') {
                    managerSelect.innerHTML += `<option value="${manager}">${manager}</option>`;
                }
            });
            managerSelector.style.display = 'block';
        }

        function generateRestaurantComparisonTable() {
            const selectedManager = managerSelect.value;
            if (!selectedManager) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„');
                return;
            }
            
            const selectedMonths = Array.from(document.querySelectorAll('.compare-month:checked'))
                .map(cb => cb.value);
            
            if (selectedMonths.length === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø´Ù‡Ø± Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            const comparisonResult = document.getElementById('comparisonResult');
            
            // ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù… Ù„Ù„Ø´Ù‡ÙˆØ± Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
            const restaurantStats = {};
            const allRestaurants = new Set();
            
            selectedMonths.forEach(month => {
                const data = monthlyData[month] || [];
                restaurantStats[month] = {};
                
                // ØªØµÙÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯
                const managerData = data.filter(item => item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ === selectedManager);
                
                // ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
                managerData.forEach(item => {
                    const restaurant = item.mØ·Ø¹Ù… || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                    allRestaurants.add(restaurant);
                    
                    if (!restaurantStats[month][restaurant]) {
                        restaurantStats[month][restaurant] = {
                            carSalary: 0,
                            bikeSalary: 0,
                            totalSalary: 0,
                            employees: 0
                        };
                    }
                    
                    if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©') {
                        restaurantStats[month][restaurant].carSalary += item.Ø±Ø§ØªØ¨ || 0;
                    } else if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„') {
                        restaurantStats[month][restaurant].bikeSalary += item.Ø±Ø§ØªØ¨ || 0;
                    }
                    
                    restaurantStats[month][restaurant].totalSalary += item.Ø±Ø§ØªØ¨ || 0;
                    restaurantStats[month][restaurant].employees++;
                });
            });
            
            // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙØªØ±Ø©
            const startMonth = selectedMonths[0];
            const endMonth = selectedMonths[selectedMonths.length - 1];
            const periodText = selectedMonths.length === 1 ? `Ù„Ø´Ù‡Ø± ${startMonth}` : `Ù…Ù† ${startMonth} Ø­ØªÙ‰ ${endMonth}`;
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
            let html = `
                <div style="margin-top: 30px;">
                    <h3 style="text-align: center; color: #2c3e50; margin-bottom: 20px;">ğŸ“Š Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠÙŠÙ† Ù„Ù…Ø·Ø§Ø¹Ù… Ø§Ù„Ø£Ø³ØªØ§Ø°/ ${selectedManager} ${periodText}</h3>
                    <div class="restaurant-comparison-table-container">
                        <table class="restaurant-comparison-table">
                            <thead>
                                <tr>
                                    <th rowspan="2" class="restaurant-name">Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…</th>
            `;
            
            // Ø¥Ø¶Ø§ÙØ© Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø£Ø´Ù‡Ø±
            selectedMonths.forEach(month => {
                html += `<th colspan="2" class="month-column">${month}</th>`;
            });
            
            html += `
                                    <th colspan="3" style="background: linear-gradient(135deg, #5c6bc0 0%, #3949ab 100%); color: white;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ù†Ø©</th>
                                </tr>
                                <tr>
            `;
            
            // Ø¥Ø¶Ø§ÙØ© Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ù„ÙƒÙ„ Ø´Ù‡Ø±
            selectedMonths.forEach(() => {
                html += `
                    <th class="car-salary">Ø±ÙˆØ§ØªØ¨ Ø³ÙŠØ§Ø±Ø§Øª</th>
                    <th class="bike-salary">Ø±ÙˆØ§ØªØ¨ Ø³ÙŠÙƒÙ„</th>
                `;
            });
            
            html += `
                    <th class="car-salary">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³ÙŠØ§Ø±Ø§Øª</th>
                    <th class="bike-salary">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³ÙŠÙƒÙ„</th>
                    <th class="restaurant-total">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                </tr>
            </thead>
            <tbody>
            `;
            
            // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
            const monthlyTotals = {};
            selectedMonths.forEach(month => {
                monthlyTotals[month] = {
                    carSalary: 0,
                    bikeSalary: 0,
                    totalSalary: 0
                };
            });
            
            // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
            Array.from(allRestaurants).filter(r => r && r !== 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ').forEach(restaurant => {
                html += `<tr><td class="restaurant-name">${restaurant}</td>`;
                
                // Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø³Ù†Ø© Ù„Ù„Ù…Ø·Ø¹Ù…
                let restaurantYearCarSalary = 0;
                let restaurantYearBikeSalary = 0;
                let restaurantYearTotalSalary = 0;
                
                // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø´Ù‡Ø±
                selectedMonths.forEach(month => {
                    const stats = restaurantStats[month][restaurant] || { carSalary: 0, bikeSalary: 0, totalSalary: 0 };
                    
                    html += `
                        <td class="car-salary">${stats.carSalary.toFixed(3)}</td>
                        <td class="bike-salary">${stats.bikeSalary.toFixed(3)}</td>
                    `;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
                    monthlyTotals[month].carSalary += stats.carSalary;
                    monthlyTotals[month].bikeSalary += stats.bikeSalary;
                    monthlyTotals[month].totalSalary += stats.totalSalary;
                    
                    // ØªØ­Ø¯ÙŠØ« Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø³Ù†Ø© Ù„Ù„Ù…Ø·Ø¹Ù…
                    restaurantYearCarSalary += stats.carSalary;
                    restaurantYearBikeSalary += stats.bikeSalary;
                    restaurantYearTotalSalary += stats.totalSalary;
                });
                
                // Ø¥Ø¶Ø§ÙØ© Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø³Ù†Ø© Ù„Ù„Ù…Ø·Ø¹Ù…
                html += `
                    <td class="car-salary">${restaurantYearCarSalary.toFixed(3)}</td>
                    <td class="bike-salary">${restaurantYearBikeSalary.toFixed(3)}</td>
                    <td class="restaurant-total">${restaurantYearTotalSalary.toFixed(3)}</td>
                `;
                
                html += `</tr>`;
            });
            
            // Ø¥Ø¶Ø§ÙØ© ØµÙ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
            html += `<tr class="grand-total">`;
            html += `<td class="restaurant-name"><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´Ù‡Ø±</strong></td>`;
            
            selectedMonths.forEach(month => {
                const totals = monthlyTotals[month];
                html += `
                    <td><strong>${totals.carSalary.toFixed(3)}</strong></td>
                    <td><strong>${totals.bikeSalary.toFixed(3)}</strong></td>
                `;
            });
            
            // Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø³Ù†Ø© Ø§Ù„ÙƒÙ„ÙŠØ©
            let yearTotalCarSalary = 0;
            let yearTotalBikeSalary = 0;
            let yearTotalAllSalary = 0;
            
            selectedMonths.forEach(month => {
                const totals = monthlyTotals[month];
                yearTotalCarSalary += totals.carSalary;
                yearTotalBikeSalary += totals.bikeSalary;
                yearTotalAllSalary += totals.totalSalary;
            });
            
            html += `
                <td><strong>${yearTotalCarSalary.toFixed(3)}</strong></td>
                <td><strong>${yearTotalBikeSalary.toFixed(3)}</strong></td>
                <td><strong>${yearTotalAllSalary.toFixed(3)}</strong></td>
            `;
            
            html += `</tr>`;
            
            html += `</tbody></table></div></div>`;
            
            comparisonResult.innerHTML += html;
        }

        function calculateMonthStats(data) {
            const totalEmployees = data.length;
            const totalDays = data.reduce((sum, item) => sum + (item.Ø§ÙŠØ§Ù… || 0), 0);
            const totalHours = data.reduce((sum, item) => sum + (item.Ø³Ø§Ø¹Ø§Øª || 0), 0);
            const totalSalary = data.reduce((sum, item) => sum + (item.Ø±Ø§ØªØ¨ || 0), 0);
            const avgSalary = totalEmployees > 0 ? totalSalary / totalEmployees : 0;
            const uniqueCompanies = [...new Set(data.map(item => item.Ø´Ø±ÙƒØ©))].filter(c => c && c !== '').length;
            const uniqueRestaurants = [...new Set(data.map(item => item.mØ·Ø¹Ù…))].filter(r => r && r !== '').length;
            const cars = data.filter(item => item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©').length;
            const bikes = data.filter(item => item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„').length;
            const managers = {};
            data.forEach(item => {
                if (item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„) {
                    managers[item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„] = (managers[item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„] || 0) + 1;
                }
            });
            const uniqueManagers = Object.keys(managers).length;
            
            return {
                totalEmployees,
                totalDays,
                totalHours,
                totalSalary,
                avgSalary,
                uniqueCompanies,
                uniqueRestaurants,
                cars,
                bikes,
                uniqueManagers
            };
        }

        function switchTab(tabName) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            const tabIndex = tabName === 'report' ? 1 : tabName === 'detailed' ? 2 : 3;
            document.querySelector(`.tab:nth-child(${tabIndex})`).classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            if (tabName === 'detailed') {
                currentPage = 1;
                updateDetailedReport(filteredData.length > 0 ? filteredData : 
                    (currentMonth === 'Ø§Ù„ÙƒÙ„' ? allData : (monthlyData[currentMonth] || [])));
            }
        }

        function downloadExcel() {
            const dataToExport = currentMonth === 'Ø§Ù„ÙƒÙ„' ? allData : 
                (monthlyData[currentMonth] || []);
            
            if (dataToExport.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„ØªØµØ¯ÙŠØ±');
                return;
            }
            
            const worksheet = XLSX.utils.json_to_sheet(dataToExport.map((item, index) => ({
                'Ù…': index + 1,
                'Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ²Ø¹': item.Ø§Ø³Ù… || '',
                'Ø§Ù„Ù…Ø·Ø¹Ù…': item.mØ·Ø¹Ù… || '',
                'Ø£ÙŠØ§Ù… Ø§Ù„Ø¯ÙˆØ§Ù…': item.Ø§ÙŠØ§Ù… > 0 ? item.Ø§ÙŠØ§Ù… : '',
                'Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª': item.Ø³Ø§Ø¹Ø§Øª > 0 ? item.Ø³Ø§Ø¹Ø§Øª : '',
                'Ø§Ù„Ø±Ø§ØªØ¨': item.Ø±Ø§ØªØ¨ > 0 ? item.Ø±Ø§ØªØ¨.toFixed(3) : '',
                'Ø§Ù„Ø´Ø±ÙƒØ© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ©': item.Ø´Ø±ÙƒØ© || '',
                'Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©': item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© || '',
                'Ø§Ù„Ø´Ù‡Ø±': item.Ø´Ù‡Ø± || '',
                'Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„': item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ || '',
                'Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ù†Ø·Ù‚Ø©': item.Ù…Ø¯ÙŠØ±_Ø§Ù„Ù…Ù†Ø·Ù‚Ø© || '',
                'Ù…Ù„Ø§Ø­Ø¸Ø§Øª': item.Ù…Ù„Ø§Ø­Ø¸Ø§Øª || ''
            })));
            
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 
                currentMonth === 'Ø§Ù„ÙƒÙ„' ? 'ØªÙ‚Ø±ÙŠØ±_Ù…Ø¬Ù…Ø¹' : `ØªÙ‚Ø±ÙŠØ±_${currentMonth}`);
            
            const fileName = currentMonth === 'Ø§Ù„ÙƒÙ„' ? 
                'ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†_Ø§Ù„Ù…Ø¬Ù…Ø¹.xlsx' : `ØªÙ‚Ø±ÙŠØ±_Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†_${currentMonth}.xlsx`;
            
            XLSX.writeFile(workbook, fileName);
        }

        async function downloadPDFReport() {
            await generatePDF(false, 'report');
        }

        async function downloadDetailedPDF() {
            await generateDetailedPDF();
        }

        async function downloadComparisonTablePDF() {
            const selectedMonths = Array.from(document.querySelectorAll('.compare-month:checked'))
                .map(cb => cb.value);
            
            if (selectedMonths.length === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø´Ù‡Ø± Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            await generateComparisonTablePDF(selectedMonths);
        }

        async function downloadRestaurantComparisonPDF() {
            const selectedManager = managerSelect.value;
            if (!selectedManager) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„');
                return;
            }
            
            const selectedMonths = Array.from(document.querySelectorAll('.compare-month:checked'))
                .map(cb => cb.value);
            
            if (selectedMonths.length === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø´Ù‡Ø± Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            await generateRestaurantComparisonPDF(selectedManager, selectedMonths);
        }

        async function generatePDF(isDetailed = false, type = 'report', customData = null, selectedMonths = null) {
            if (!window.jspdf) {
                alert('Ù…ÙƒØªØ¨Ø© PDF ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
                return;
            }
            
            let dataToExport;
            let title;
            
            if (type === 'comparison' && customData && selectedMonths) {
                dataToExport = customData;
                title = `Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø£Ø´Ù‡Ø±: ${selectedMonths.join('ØŒ ')}`;
            } else {
                dataToExport = filteredData.length > 0 ? filteredData : 
                    (currentMonth === 'Ø§Ù„ÙƒÙ„' ? allData : (monthlyData[currentMonth] || []));
                title = currentMonth === 'Ø§Ù„ÙƒÙ„' ? 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø´Ù‡Ø±' : 'Ø´Ù‡Ø± ' + currentMonth;
            }
            
            if (dataToExport.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø­ÙØ¸Ù‡Ø§ ÙƒÙ€ PDF');
                return;
            }
            
            showLoading();
            
            try {
                const pdfTemplate = document.getElementById('pdf-template');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙÙŠ Ù‚Ø§Ù„Ø¨ PDF
                document.getElementById('pdf-report-type').textContent = 
                    type === 'comparison' ? 'ØªÙ‚Ø±ÙŠØ± Ù…Ù‚Ø§Ø±Ù†Ø©' : (isDetailed ? 'ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„' : 'ØªÙ‚Ø±ÙŠØ± Ù…ÙˆØ¬Ø²');
                document.getElementById('pdf-period').textContent = title;
                document.getElementById('pdf-total-records').textContent = dataToExport.length;
                document.getElementById('pdf-print-date').textContent = new Date().toLocaleDateString('ar-SA');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ø®Øµ
                const stats = calculateMonthStats(dataToExport);
                document.getElementById('pdf-summary').innerHTML = `
                    <div style="display: flex; justify-content: space-between;">
                        <div>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†: <strong>${stats.totalEmployees}</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„: <strong>${stats.totalDays}</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª: <strong>${stats.totalHours}</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨: <strong>${stats.totalSalary.toFixed(3)} Ø¯.Ùƒ</strong></div>
                    </div>
                `;
                
                // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const pdfTableBody = document.getElementById('pdf-table-body');
                pdfTableBody.innerHTML = '';
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„ (35 ØµÙ Ù„ÙƒÙ„ ØµÙØ­Ø©)
                const rowsPerPage = 35;
                const totalPages = Math.ceil(dataToExport.length / rowsPerPage);
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ù…Ù† Ù‚Ø§Ù„Ø¨ PDF Ù„ÙƒÙ„ ØµÙØ­Ø©
                for (let page = 0; page < totalPages; page++) {
                    const startIndex = page * rowsPerPage;
                    const endIndex = Math.min(startIndex + rowsPerPage, dataToExport.length);
                    const pageData = dataToExport.slice(startIndex, endIndex);
                    
                    if (page > 0) {
                        // Ø¥Ø¶Ø§ÙØ© ÙØ§ØµÙ„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
                        const pageSeparator = document.createElement('div');
                        pageSeparator.style.height = '50px';
                        pageSeparator.style.borderTop = '2px dashed #ddd';
                        pageSeparator.style.marginTop = '20px';
                        pageSeparator.style.paddingTop = '10px';
                        pageSeparator.innerHTML = `<div style="text-align: center; color: #666; font-size: 10px;">Ø§Ù„ØµÙØ­Ø© ${page + 1} Ù…Ù† ${totalPages}</div>`;
                        pdfTableBody.parentNode.insertBefore(pageSeparator, pdfTableBody);
                    }
                    
                    pageData.forEach((item, index) => {
                        const row = document.createElement('tr');
                        const rowNum = startIndex + index + 1;
                        row.innerHTML = `
                            <td style="padding: 4px; border: 1px solid #000; text-align: center;">${rowNum}</td>
                            <td style="padding: 4px; border: 1px solid #000; text-align: center;">${item.Ø§Ø³Ù… || ''}</td>
                            <td style="padding: 4px; border: 1px solid #000; text-align: center;">${item.mØ·Ø¹Ù… || ''}</td>
                            <td style="padding: 4px; border: 1px solid #000; text-align: center;">${item.Ø§ÙŠØ§Ù… > 0 ? item.Ø§ÙŠØ§Ù… : ''}</td>
                            <td style="padding: 4px; border: 1px solid #000; text-align: center;">${item.Ø³Ø§Ø¹Ø§Øª > 0 ? item.Ø³Ø§Ø¹Ø§Øª : ''}</td>
                            <td style="padding: 4px; border: 1px solid #000; text-align: center;">${item.Ø±Ø§ØªØ¨ > 0 ? item.Ø±Ø§ØªØ¨.toFixed(3) : ''}</td>
                            <td style="padding: 4px; border: 1px solid #000; text-align: center;">${item.Ø´Ø±ÙƒØ© || ''}</td>
                            <td style="padding: 4px; border: 1px solid #000; text-align: center;">${item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© || 'Ø³ÙŠØ§Ø±Ø©'}</td>
                            <td style="padding: 4px; border: 1px solid #000; text-align: center;">${item.Ø´Ù‡Ø± || ''}</td>
                        `;
                        pdfTableBody.appendChild(row);
                    });
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
                document.getElementById('pdf-totals').innerHTML = `
                    <div style="display: flex; justify-content: space-between;">
                        <div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <strong>${dataToExport.length} Ø³Ø¬Ù„</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„: <strong>${stats.totalDays} ÙŠÙˆÙ…</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª: <strong>${stats.totalHours} Ø³Ø§Ø¹Ø©</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨: <strong>${stats.totalSalary.toFixed(3)} Ø¯.Ùƒ</strong></div>
                    </div>
                `;
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
                document.getElementById('pdf-signature').innerHTML = `
                    <div style="color: #d32f2f; font-size: 9px; text-align: left;">
                        Yasser Elkhateeb - Ù…Ø·ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ 67011143
                    </div>
                `;
                
                // Ø¹Ø±Ø¶ Ù‚Ø§Ù„Ø¨ PDF Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©
                const originalDisplay = pdfTemplate.style.display;
                const originalPosition = pdfTemplate.style.position;
                const originalLeft = pdfTemplate.style.left;
                const originalTop = pdfTemplate.style.top;
                const originalZIndex = pdfTemplate.style.zIndex;
                
                pdfTemplate.style.display = 'block';
                pdfTemplate.style.position = 'fixed';
                pdfTemplate.style.left = '0';
                pdfTemplate.style.top = '0';
                pdfTemplate.style.zIndex = '10000';
                pdfTemplate.style.background = 'white';
                pdfTemplate.style.overflow = 'visible';
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… html2canvas Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†ÙØ³ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ©
                const canvas = await html2canvas(pdfTemplate, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#FFFFFF',
                    width: 794,
                    height: pdfTemplate.scrollHeight,
                    windowWidth: 794,
                    windowHeight: pdfTemplate.scrollHeight
                });
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ù†ØµØ± Ø¥Ù„Ù‰ ÙˆØ¶Ø¹Ù‡ Ø§Ù„Ø£ØµÙ„ÙŠ
                pdfTemplate.style.display = originalDisplay;
                pdfTemplate.style.position = originalPosition;
                pdfTemplate.style.left = originalLeft;
                pdfTemplate.style.top = originalTop;
                pdfTemplate.style.zIndex = originalZIndex;
                
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const pdf = new window.jspdf.jsPDF('p', 'pt', 'a4');
                
                const imgWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                let imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                const totalPDFPages = Math.ceil(imgHeight / pageHeight);
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
                for (let i = 1; i < totalPDFPages; i++) {
                    position = -i * pageHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                }
                
                const fileName = type === 'comparison' ? 
                    `Ù…Ù‚Ø§Ø±Ù†Ø©_Ø§Ù„Ø§Ø´Ù‡Ø±.pdf` : 
                    (isDetailed ? `ØªÙ‚Ø±ÙŠØ±_Ù…ÙØµÙ„_${currentMonth === 'Ø§Ù„ÙƒÙ„' ? 'Ù…Ø¬Ù…Ø¹' : currentMonth}.pdf` :
                    `ØªÙ‚Ø±ÙŠØ±_${currentMonth === 'Ø§Ù„ÙƒÙ„' ? 'Ù…Ø¬Ù…Ø¹' : currentMonth}.pdf`);
                
                pdf.save(fileName);
                
            } catch (error) {
                console.error('Error generating PDF:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF: ' + error.message);
            } finally {
                hideLoading();
            }
        }

        async function generateDetailedPDF() {
            if (!window.jspdf) {
                alert('Ù…ÙƒØªØ¨Ø© PDF ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
                return;
            }
            
            const dataToExport = filteredData.length > 0 ? filteredData : 
                (currentMonth === 'Ø§Ù„ÙƒÙ„' ? allData : (monthlyData[currentMonth] || []));
            
            if (dataToExport.length === 0) {
                alert('Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ø­ÙØ¸Ù‡Ø§ ÙƒÙ€ PDF');
                return;
            }
            
            showLoading();
            
            try {
                const pdfTemplate = document.getElementById('pdf-detailed-template');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª ÙÙŠ Ù‚Ø§Ù„Ø¨ PDF
                document.getElementById('pdf-detailed-report-type').textContent = 'ØªÙ‚Ø±ÙŠØ± Ù…ÙØµÙ„';
                document.getElementById('pdf-detailed-period').textContent = currentMonth === 'Ø§Ù„ÙƒÙ„' ? 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø´Ù‡Ø±' : 'Ø´Ù‡Ø± ' + currentMonth;
                document.getElementById('pdf-detailed-total-records').textContent = dataToExport.length;
                document.getElementById('pdf-detailed-print-date').textContent = new Date().toLocaleDateString('ar-SA');
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…Ù„Ø®Øµ
                const stats = calculateMonthStats(dataToExport);
                document.getElementById('pdf-detailed-summary').innerHTML = `
                    <div style="display: flex; justify-content: space-between; flex-wrap: wrap;">
                        <div>Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†: <strong>${stats.totalEmployees}</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„: <strong>${stats.totalDays}</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª: <strong>${stats.totalHours}</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨: <strong>${stats.totalSalary.toFixed(3)} Ø¯.Ùƒ</strong></div>
                        <div>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·Ø§Ø¹Ù…: <strong>${stats.uniqueRestaurants}</strong></div>
                        <div>Ø¹Ø¯Ø¯ Ø§Ù„Ø´Ø±ÙƒØ§Øª: <strong>${stats.uniqueCompanies}</strong></div>
                    </div>
                `;
                
                // ØªØ­Ø¯ÙŠØ« Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
                const pdfTableBody = document.getElementById('pdf-detailed-table-body');
                pdfTableBody.innerHTML = '';
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¥Ù„Ù‰ Ø§Ù„Ø¬Ø¯ÙˆÙ„ (35 ØµÙ Ù„ÙƒÙ„ ØµÙØ­Ø©) Ù…Ø¹ Ø§Ù„Ø£Ù„ÙˆØ§Ù†
                const rowsPerPage = 35;
                const totalPages = Math.ceil(dataToExport.length / rowsPerPage);
                
                for (let page = 0; page < totalPages; page++) {
                    const startIndex = page * rowsPerPage;
                    const endIndex = Math.min(startIndex + rowsPerPage, dataToExport.length);
                    const pageData = dataToExport.slice(startIndex, endIndex);
                    
                    if (page > 0) {
                        // Ø¥Ø¶Ø§ÙØ© ÙØ§ØµÙ„ Ø¨ÙŠÙ† Ø§Ù„ØµÙØ­Ø§Øª
                        const pageSeparator = document.createElement('div');
                        pageSeparator.style.height = '50px';
                        pageSeparator.style.borderTop = '2px dashed #ddd';
                        pageSeparator.style.marginTop = '20px';
                        pageSeparator.style.paddingTop = '10px';
                        pageSeparator.innerHTML = `<div style="text-align: center; color: #666; font-size: 10px;">Ø§Ù„ØµÙØ­Ø© ${page + 1} Ù…Ù† ${totalPages}</div>`;
                        pdfTableBody.parentNode.insertBefore(pageSeparator, pdfTableBody);
                    }
                    
                    pageData.forEach((item, index) => {
                        const row = document.createElement('tr');
                        const rowNum = startIndex + index + 1;
                        
                        // ØªØ­Ø¯ÙŠØ¯ Ù„ÙˆÙ† Ø§Ù„Ø®Ù„ÙÙŠØ© Ù„Ù„ØµÙÙˆÙ Ø§Ù„Ø²ÙˆØ¬ÙŠØ©
                        const rowBgColor = rowNum % 2 === 0 ? '#f8f9fa' : '#ffffff';
                        
                        // ØªØ­Ø¯ÙŠØ¯ Ù„ÙˆÙ† ÙˆØ®Ù„ÙÙŠØ© Ù†ÙˆØ¹ Ø§Ù„Ù…Ø±ÙƒØ¨Ø©
                        let vehicleCell = item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© || 'Ø³ÙŠØ§Ø±Ø©';
                        if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„') {
                            vehicleCell = `<span style="background: #e8f5e9; padding: 2px 6px; border-radius: 3px;">ğŸš² Ø³ÙŠÙƒÙ„</span>`;
                        } else {
                            vehicleCell = `<span style="background: #fff3e0; padding: 2px 6px; border-radius: 3px;">ğŸš— Ø³ÙŠØ§Ø±Ø©</span>`;
                        }
                        
                        row.innerHTML = `
                            <td style="padding: 4px; border: 1px solid #ddd; text-align: center; background: ${rowBgColor};">${rowNum}</td>
                            <td style="padding: 4px; border: 1px solid #ddd; text-align: center; background: ${rowBgColor};"><strong>${item.Ø§Ø³Ù… || ''}</strong></td>
                            <td style="padding: 4px; border: 1px solid #ddd; text-align: center; background: ${rowBgColor};">${item.mØ·Ø¹Ù… || ''}</td>
                            <td style="padding: 4px; border: 1px solid #ddd; text-align: center; background: ${rowBgColor}; color: #1976d2; font-weight: bold;">${item.Ø§ÙŠØ§Ù… > 0 ? item.Ø§ÙŠØ§Ù… : ''}</td>
                            <td style="padding: 4px; border: 1px solid #ddd; text-align: center; background: ${rowBgColor}; color: #388e3c; font-weight: bold;">${item.Ø³Ø§Ø¹Ø§Øª > 0 ? item.Ø³Ø§Ø¹Ø§Øª : ''}</td>
                            <td style="padding: 4px; border: 1px solid #ddd; text-align: center; background: ${rowBgColor}; color: #d32f2f; font-weight: bold;">${item.Ø±Ø§ØªØ¨ > 0 ? item.Ø±Ø§ØªØ¨.toFixed(3) : ''}</td>
                            <td style="padding: 4px; border: 1px solid #ddd; text-align: center; background: ${rowBgColor};"><span style="background: #e3f2fd; padding: 2px 6px; border-radius: 3px;">${item.Ø´Ø±ÙƒØ© || ''}</span></td>
                            <td style="padding: 4px; border: 1px solid #ddd; text-align: center; background: ${rowBgColor};">${vehicleCell}</td>
                            <td style="padding: 4px; border: 1px solid #ddd; text-align: center; background: ${rowBgColor};">${item.Ø´Ù‡Ø± || ''}</td>
                        `;
                        pdfTableBody.appendChild(row);
                    });
                }
                
                // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª
                document.getElementById('pdf-detailed-totals').innerHTML = `
                    <div style="display: flex; justify-content: space-between; flex-wrap: wrap;">
                        <div>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: <strong>${dataToExport.length} Ø³Ø¬Ù„</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø£ÙŠØ§Ù… Ø§Ù„Ø¹Ù…Ù„: <strong>${stats.totalDays} ÙŠÙˆÙ…</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ø§Ø¹Ø§Øª: <strong>${stats.totalHours} Ø³Ø§Ø¹Ø©</strong></div>
                        <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨: <strong>${stats.totalSalary.toFixed(3)} Ø¯.Ùƒ</strong></div>
                        <div>Ù…ØªÙˆØ³Ø· Ø§Ù„Ø±Ø§ØªØ¨: <strong>${stats.avgSalary.toFixed(3)} Ø¯.Ùƒ</strong></div>
                    </div>
                `;
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
                document.getElementById('pdf-detailed-signature').innerHTML = `
                    <div style="color: #d32f2f; font-size: 9px; text-align: left;">
                        Yasser Elkhateeb - Ù…Ø·ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ 67011143
                    </div>
                `;
                
                // Ø¹Ø±Ø¶ Ù‚Ø§Ù„Ø¨ PDF Ù…Ø¤Ù‚ØªØ§Ù‹ Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©
                const originalDisplay = pdfTemplate.style.display;
                const originalPosition = pdfTemplate.style.position;
                const originalLeft = pdfTemplate.style.left;
                const originalTop = pdfTemplate.style.top;
                const originalZIndex = pdfTemplate.style.zIndex;
                
                pdfTemplate.style.display = 'block';
                pdfTemplate.style.position = 'fixed';
                pdfTemplate.style.left = '0';
                pdfTemplate.style.top = '0';
                pdfTemplate.style.zIndex = '10000';
                pdfTemplate.style.background = 'white';
                pdfTemplate.style.overflow = 'visible';
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… html2canvas Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†ÙØ³ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø£ØµÙ„ÙŠØ©
                const canvas = await html2canvas(pdfTemplate, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#FFFFFF',
                    width: 794,
                    height: pdfTemplate.scrollHeight,
                    windowWidth: 794,
                    windowHeight: pdfTemplate.scrollHeight
                });
                
                // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¹Ù†ØµØ± Ø¥Ù„Ù‰ ÙˆØ¶Ø¹Ù‡ Ø§Ù„Ø£ØµÙ„ÙŠ
                pdfTemplate.style.display = originalDisplay;
                pdfTemplate.style.position = originalPosition;
                pdfTemplate.style.left = originalLeft;
                pdfTemplate.style.top = originalTop;
                pdfTemplate.style.zIndex = originalZIndex;
                
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const pdf = new window.jspdf.jsPDF('p', 'pt', 'a4');
                
                const imgWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                let imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                const totalPDFPages = Math.ceil(imgHeight / pageHeight);
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
                for (let i = 1; i < totalPDFPages; i++) {
                    position = -i * pageHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                }
                
                const fileName = `ØªÙ‚Ø±ÙŠØ±_Ù…ÙØµÙ„_${currentMonth === 'Ø§Ù„ÙƒÙ„' ? 'Ø¬Ù…ÙŠØ¹_Ø§Ù„Ø§Ø´Ù‡Ø±' : currentMonth}.pdf`;
                pdf.save(fileName);
                
            } catch (error) {
                console.error('Error generating detailed PDF:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF: ' + error.message);
            } finally {
                hideLoading();
            }
        }

        async function generateComparisonTablePDF(selectedMonths) {
            if (!window.jspdf) {
                alert('Ù…ÙƒØªØ¨Ø© PDF ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
                return;
            }
            
            if (selectedMonths.length === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ø£Ø´Ù‡Ø± Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø© Ø£ÙˆÙ„Ø§Ù‹');
                return;
            }
            
            showLoading();
            
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ù…Ø¤Ù‚Øª Ù„Ø¹Ø±Ø¶ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
                const tempDiv = document.createElement('div');
                tempDiv.style.position = 'fixed';
                tempDiv.style.left = '-10000px';
                tempDiv.style.top = '-10000px';
                tempDiv.style.width = '794px';
                tempDiv.style.background = 'white';
                tempDiv.style.padding = '20px';
                tempDiv.style.boxSizing = 'border-box';
                tempDiv.style.direction = 'rtl';
                tempDiv.style.fontFamily = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
                tempDiv.style.fontSize = '12px';
                
                // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ Ù„ÙƒÙ„ Ø´Ù‡Ø± (Ø¨Ø§Ù„Ø±ÙˆØ§ØªØ¨)
                const managerStats = {};
                const allManagers = new Set();
                
                selectedMonths.forEach(month => {
                    const data = monthlyData[month] || [];
                    managerStats[month] = {};
                    
                    // ØªØ¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ (Ø¨Ø§Ù„Ø±ÙˆØ§ØªØ¨)
                    data.forEach(item => {
                        const manager = item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                        allManagers.add(manager);
                        
                        if (!managerStats[month][manager]) {
                            managerStats[month][manager] = {
                                carSalary: 0,
                                bikeSalary: 0,
                                totalSalary: 0,
                                employees: 0
                            };
                        }
                        
                        if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©') {
                            managerStats[month][manager].carSalary += item.Ø±Ø§ØªØ¨ || 0;
                        } else if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„') {
                            managerStats[month][manager].bikeSalary += item.Ø±Ø§ØªØ¨ || 0;
                        }
                        
                        managerStats[month][manager].totalSalary += item.Ø±Ø§ØªØ¨ || 0;
                        managerStats[month][manager].employees++;
                    });
                });
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ù…Ù‚Ø§Ø±Ù†Ø©
                let html = `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø´Ø±ÙƒØ©" 
                             style="width: 50px; height: 50px; border-radius: 50%; border: 2px solid #4a90e2; margin-bottom: 5px; margin: 0 auto 5px; display: block;">
                        <h2 style="color: #4a90e2; margin: 0; font-size: 18px;">Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©</h2>
                        <h3 style="color: #4a90e2; margin: 0 0 8px 0; font-size: 16px;">Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ø±ÙˆØ§ØªØ¨ Ù„Ù„Ø£Ø´Ù‡Ø±</h3>
                        <div style="margin-bottom: 8px; text-align: center;">
                            <div style="font-size: 14px; font-weight: bold; display: inline-block;">
                                Ø§Ù„ÙØªØ±Ø©: ${selectedMonths.length === 1 ? `Ø´Ù‡Ø± ${selectedMonths[0]}` : `Ù…Ù† ${selectedMonths[0]} Ø­ØªÙ‰ ${selectedMonths[selectedMonths.length - 1]}`}
                            </div>
                            <div style="display: inline-block; width: 1cm;"></div>
                            <div style="font-size: 12px; display: inline-block;">
                                Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ù‡Ø±: ${selectedMonths.length}
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 11px;">
                            <div>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©: ${new Date().toLocaleDateString('ar-SA')}</div>
                            <div>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø´Ù‡Ø±: ${selectedMonths.length}</div>
                        </div>
                    </div>
                    
                    <table style="width: 100%; border-collapse: collapse; font-size: 10px; margin-top: 20px;">
                        <thead>
                            <tr>
                                <th rowspan="2" style="padding: 8px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #424242 0%, #212121 100%); color: white;">Ø§Ù„Ø´Ù‡Ø±</th>
                                <th colspan="3" style="padding: 8px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #5c6bc0 0%, #3949ab 100%); color: white;">Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ</th>
                                <th colspan="3" style="padding: 8px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #5c6bc0 0%, #3949ab 100%); color: white;">Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡</th>
                                <th colspan="3" style="padding: 8px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #5c6bc0 0%, #3949ab 100%); color: white;">Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰</th>
                                <th colspan="4" style="padding: 8px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ù„Ù„Ø´Ù‡Ø±</th>
                            </tr>
                            <tr>
                                <!-- Ø£Ø¹Ù…Ø¯Ø© Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ -->
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e8eaf6;">Ø±ÙˆØ§ØªØ¨ Ø³ÙŠØ§Ø±Ø§Øª</th>
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e8eaf6;">Ø±ÙˆØ§ØªØ¨ Ø³ÙŠÙƒÙ„</th>
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e8eaf6;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</th>
                                <!-- Ø£Ø¹Ù…Ø¯Ø© Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ -->
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e8eaf6;">Ø±ÙˆØ§ØªØ¨ Ø³ÙŠØ§Ø±Ø§Øª</th>
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e8eaf6;">Ø±ÙˆØ§ØªØ¨ Ø³ÙŠÙƒÙ„</th>
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e8eaf6;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</th>
                                <!-- Ø£Ø¹Ù…Ø¯Ø© Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰ -->
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e8eaf6;">Ø±ÙˆØ§ØªØ¨ Ø³ÙŠØ§Ø±Ø§Øª</th>
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e8eaf6;">Ø±ÙˆØ§ØªØ¨ Ø³ÙŠÙƒÙ„</th>
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e8eaf6;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</th>
                                <!-- Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ -->
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #fff3e0;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³ÙŠØ§Ø±Ø§Øª</th>
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e8f5e9;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³ÙŠÙƒÙ„</th>
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #ffcc80;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø±ÙˆØ§ØªØ¨</th>
                                <th style="padding: 6px; border: 1px solid #000; text-align: center; background: #e3f2fd;">Ø¹Ø¯Ø¯ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ†</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                
                // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø´Ù‡Ø±
                selectedMonths.forEach(month => {
                    const monthData = monthlyData[month] || [];
                    const tarekStats = managerStats[month]['Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                    const haniStats = managerStats[month]['Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                    const murtadaStats = managerStats[month]['Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                    
                    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ù„Ù„Ø´Ù‡Ø±
                    const totalCarSalary = tarekStats.carSalary + haniStats.carSalary + murtadaStats.carSalary;
                    const totalBikeSalary = tarekStats.bikeSalary + haniStats.bikeSalary + murtadaStats.bikeSalary;
                    const totalAllSalary = totalCarSalary + totalBikeSalary;
                    const totalEmployees = tarekStats.employees + haniStats.employees + murtadaStats.employees;
                    
                    const rowBgColor = selectedMonths.indexOf(month) % 2 === 0 ? '#ffffff' : '#f9f9f9';
                    
                    html += `
                        <tr style="background: ${rowBgColor};">
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${month}</td>
                            <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ -->
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center;">${tarekStats.carSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center;">${tarekStats.bikeSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${tarekStats.totalSalary.toFixed(3)}</td>
                            <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ -->
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center;">${haniStats.carSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center;">${haniStats.bikeSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${haniStats.totalSalary.toFixed(3)}</td>
                            <!-- Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰ -->
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center;">${murtadaStats.carSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center;">${murtadaStats.bikeSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${murtadaStats.totalSalary.toFixed(3)}</td>
                            <!-- Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª -->
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${totalCarSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${totalBikeSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${totalAllSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${totalEmployees}</td>
                        </tr>
                    `;
                });
                
                // Ø¥Ø¶Ø§ÙØ© ØµÙ Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹
                if (selectedMonths.length > 1) {
                    let totalTarekCarSalary = 0, totalTarekBikeSalary = 0, totalTarekSalary = 0, totalTarekEmployees = 0;
                    let totalHaniCarSalary = 0, totalHaniBikeSalary = 0, totalHaniSalary = 0, totalHaniEmployees = 0;
                    let totalMurtadaCarSalary = 0, totalMurtadaBikeSalary = 0, totalMurtadaSalary = 0, totalMurtadaEmployees = 0;
                    let grandTotalCarSalary = 0, grandTotalBikeSalary = 0, grandTotalSalary = 0, grandTotalEmployees = 0;
                    
                    selectedMonths.forEach(month => {
                        const tarekStats = managerStats[month]['Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                        const haniStats = managerStats[month]['Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                        const murtadaStats = managerStats[month]['Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰'] || { carSalary: 0, bikeSalary: 0, totalSalary: 0, employees: 0 };
                        
                        totalTarekCarSalary += tarekStats.carSalary;
                        totalTarekBikeSalary += tarekStats.bikeSalary;
                        totalTarekSalary += tarekStats.totalSalary;
                        totalTarekEmployees += tarekStats.employees;
                        
                        totalHaniCarSalary += haniStats.carSalary;
                        totalHaniBikeSalary += haniStats.bikeSalary;
                        totalHaniSalary += haniStats.totalSalary;
                        totalHaniEmployees += haniStats.employees;
                        
                        totalMurtadaCarSalary += murtadaStats.carSalary;
                        totalMurtadaBikeSalary += murtadaStats.bikeSalary;
                        totalMurtadaSalary += murtadaStats.totalSalary;
                        totalMurtadaEmployees += murtadaStats.employees;
                    });
                    
                    grandTotalCarSalary = totalTarekCarSalary + totalHaniCarSalary + totalMurtadaCarSalary;
                    grandTotalBikeSalary = totalTarekBikeSalary + totalHaniBikeSalary + totalMurtadaBikeSalary;
                    grandTotalSalary = totalTarekSalary + totalHaniSalary + totalMurtadaSalary;
                    grandTotalEmployees = totalTarekEmployees + totalHaniEmployees + totalMurtadaEmployees;
                    
                    html += `
                        <tr style="background: linear-gradient(135deg, #ffcc80 0%, #ffb74d 100%); font-weight: bold;">
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</td>
                            <!-- Ù…Ø¬Ø§Ù…ÙŠØ¹ Ø·Ø§Ø±Ù‚ Ø¨ÙŠÙˆÙ…ÙŠ -->
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${totalTarekCarSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${totalTarekBikeSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${totalTarekSalary.toFixed(3)}</td>
                            <!-- Ù…Ø¬Ø§Ù…ÙŠØ¹ Ù‡Ø§Ù†ÙŠ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ -->
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${totalHaniCarSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${totalHaniBikeSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${totalHaniSalary.toFixed(3)}</td>
                            <!-- Ù…Ø¬Ø§Ù…ÙŠØ¹ Ù…Ø­Ù…Ø¯ Ù…Ø±ØªØ¶Ù‰ -->
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${totalMurtadaCarSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${totalMurtadaBikeSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${totalMurtadaSalary.toFixed(3)}</td>
                            <!-- Ø§Ù„Ù…Ø¬Ø§Ù…ÙŠØ¹ Ø§Ù„ÙƒÙ„ÙŠØ© -->
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${grandTotalCarSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${grandTotalBikeSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${grandTotalSalary.toFixed(3)}</td>
                            <td style="padding: 6px; border: 1px solid #000; text-align: center;">${grandTotalEmployees}</td>
                        </tr>
                    `;
                }
                
                html += `</tbody></table>`;
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
                html += `
                    <div style="margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; text-align: left; font-size: 8px; color: #d32f2f;">
                        Yasser Elkhateeb - Ù…Ø·ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ 67011143
                    </div>
                `;
                
                tempDiv.innerHTML = html;
                document.body.appendChild(tempDiv);
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… html2canvas Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©
                const canvas = await html2canvas(tempDiv, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#FFFFFF',
                    width: 794,
                    height: tempDiv.scrollHeight,
                    windowWidth: 794,
                    windowHeight: tempDiv.scrollHeight
                });
                
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù…Ø¤Ù‚Øª
                document.body.removeChild(tempDiv);
                
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const pdf = new window.jspdf.jsPDF('p', 'pt', 'a4');
                
                const imgWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                let imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                const totalPDFPages = Math.ceil(imgHeight / pageHeight);
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
                for (let i = 1; i < totalPDFPages; i++) {
                    position = -i * pageHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                }
                
                const fileName = `Ø¬Ø¯ÙˆÙ„_Ù…Ù‚Ø§Ø±Ù†Ø©_Ø§Ù„Ø±ÙˆØ§ØªØ¨_${selectedMonths.length}_Ø´Ù‡Ø±.pdf`;
                pdf.save(fileName);
                
            } catch (error) {
                console.error('Error generating comparison table PDF:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF: ' + error.message);
            } finally {
                hideLoading();
            }
        }

        async function generateRestaurantComparisonPDF(selectedManager, selectedMonths) {
            if (!window.jspdf) {
                alert('Ù…ÙƒØªØ¨Ø© PDF ØºÙŠØ± Ù…Ø­Ù…Ù„Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.');
                return;
            }
            
            if (!selectedManager || selectedMonths.length === 0) {
                alert('ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ ÙˆØ§Ù„Ø£Ø´Ù‡Ø± Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©');
                return;
            }
            
            showLoading();
            
            try {
                // Ø¥Ù†Ø´Ø§Ø¡ Ø¹Ù†ØµØ± Ù…Ø¤Ù‚Øª Ù„Ø¹Ø±Ø¶ Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
                const tempDiv = document.createElement('div');
                tempDiv.style.position = 'fixed';
                tempDiv.style.left = '-10000px';
                tempDiv.style.top = '-10000px';
                tempDiv.style.width = '794px';
                tempDiv.style.background = 'white';
                tempDiv.style.padding = '20px';
                tempDiv.style.boxSizing = 'border-box';
                tempDiv.style.direction = 'rtl';
                tempDiv.style.fontFamily = "'Segoe UI', Tahoma, Geneva, Verdana, sans-serif";
                tempDiv.style.fontSize = '12px';
                
                // ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù… Ù„Ù„Ø´Ù‡ÙˆØ± Ø§Ù„Ù…Ø­Ø¯Ø¯Ø©
                const restaurantStats = {};
                const allRestaurants = new Set();
                
                selectedMonths.forEach(month => {
                    const data = monthlyData[month] || [];
                    restaurantStats[month] = {};
                    
                    // ØªØµÙÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ø³Ø¨ Ù…Ø¯ÙŠØ± Ø§Ù„ØªØ´ØºÙŠÙ„ Ø§Ù„Ù…Ø­Ø¯Ø¯
                    const managerData = data.filter(item => item.Ù…Ø¯ÙŠØ±_Ø§Ù„ØªØ´ØºÙŠÙ„ === selectedManager);
                    
                    // ØªØ¬Ù…ÙŠØ¹ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
                    managerData.forEach(item => {
                        const restaurant = item.mØ·Ø¹Ù… || 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ';
                        allRestaurants.add(restaurant);
                        
                        if (!restaurantStats[month][restaurant]) {
                            restaurantStats[month][restaurant] = {
                                carSalary: 0,
                                bikeSalary: 0,
                                totalSalary: 0,
                                employees: 0
                            };
                        }
                        
                        if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠØ§Ø±Ø©') {
                            restaurantStats[month][restaurant].carSalary += item.Ø±Ø§ØªØ¨ || 0;
                        } else if (item.Ù†ÙˆØ¹_Ø§Ù„Ù…Ø±ÙƒØ¨Ø© === 'Ø³ÙŠÙƒÙ„') {
                            restaurantStats[month][restaurant].bikeSalary += item.Ø±Ø§ØªØ¨ || 0;
                        }
                        
                        restaurantStats[month][restaurant].totalSalary += item.Ø±Ø§ØªØ¨ || 0;
                        restaurantStats[month][restaurant].employees++;
                    });
                });
                
                // ØªØ­Ø¯ÙŠØ¯ Ø§Ù„ÙØªØ±Ø©
                const startMonth = selectedMonths[0];
                const endMonth = selectedMonths[selectedMonths.length - 1];
                const periodText = selectedMonths.length === 1 ? `Ù„Ø´Ù‡Ø± ${startMonth}` : `Ù…Ù† ${startMonth} Ø­ØªÙ‰ ${endMonth}`;
                
                // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ø­ØªÙˆÙ‰ Ø¬Ø¯ÙˆÙ„ Ù…Ù‚Ø§Ø±Ù†Ø© Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
                let html = `
                    <div style="text-align: center; margin-bottom: 20px;">
                        <img src="https://i.postimg.cc/NM2zJWZD/NAIF-LOGO.jpg" alt="Ø´Ø¹Ø§Ø± Ø§Ù„Ø´Ø±ÙƒØ©" 
                             style="width: 50px; height: 50px; border-radius: 50%; border: 2px solid #4a90e2; margin-bottom: 5px; margin: 0 auto 5px; display: block;">
                        <h2 style="color: #4a90e2; margin: 0; font-size: 18px;">Ø´Ø±ÙƒØ© Ù†Ø§ÙŠÙ Ù„Ù„Ø£ØºØ°ÙŠØ©</h2>
                        <h3 style="color: #4a90e2; margin: 0 0 8px 0; font-size: 16px;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø±ÙˆØ§ØªØ¨ Ø§Ù„Ù…ÙˆØ²Ø¹ÙŠÙ† Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠÙŠÙ† Ù„Ù…Ø·Ø§Ø¹Ù… Ø§Ù„Ø£Ø³ØªØ§Ø°/ ${selectedManager}</h3>
                        <div style="margin-bottom: 8px; text-align: center;">
                            <div style="font-size: 14px; font-weight: bold; display: inline-block;">
                                Ø§Ù„ÙØªØ±Ø©: ${periodText}
                            </div>
                            <div style="display: inline-block; width: 1cm;"></div>
                            <div style="font-size: 12px; display: inline-block;">
                                Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø´Ù‡Ø±: ${selectedMonths.length}
                            </div>
                        </div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px; font-size: 11px;">
                            <div>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©: ${new Date().toLocaleDateString('ar-SA')}</div>
                            <div>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø·Ø§Ø¹Ù…: ${Array.from(allRestaurants).filter(r => r && r !== 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ').length}</div>
                        </div>
                    </div>
                    
                    <table style="width: 100%; border-collapse: collapse; font-size: 9px; margin-top: 20px;">
                        <thead>
                            <tr>
                                <th rowspan="2" style="padding: 6px; border: 1px solid #000; text-align: right; background: #f0f0f0; font-weight: bold;">Ø§Ø³Ù… Ø§Ù„Ù…Ø·Ø¹Ù…</th>
                `;
                
                // Ø¥Ø¶Ø§ÙØ© Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„Ø£Ø´Ù‡Ø±
                selectedMonths.forEach(month => {
                    html += `<th colspan="2" style="padding: 6px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #5c6bc0 0%, #3949ab 100%); color: white;">${month}</th>`;
                });
                
                html += `
                                <th colspan="3" style="padding: 6px; border: 1px solid #000; text-align: center; background: linear-gradient(135deg, #388e3c 0%, #2e7d32 100%); color: white;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø³Ù†Ø©</th>
                            </tr>
                            <tr>
                `;
                
                // Ø¥Ø¶Ø§ÙØ© Ø£Ø¹Ù…Ø¯Ø© Ø§Ù„ØªÙØ§ØµÙŠÙ„ Ù„ÙƒÙ„ Ø´Ù‡Ø±
                selectedMonths.forEach(() => {
                    html += `
                        <th style="padding: 5px; border: 1px solid #000; text-align: center; background: #fff3e0; font-weight: bold;">Ø±ÙˆØ§ØªØ¨ Ø³ÙŠØ§Ø±Ø§Øª</th>
                        <th style="padding: 5px; border: 1px solid #000; text-align: center; background: #e8f5e9; font-weight: bold;">Ø±ÙˆØ§ØªØ¨ Ø³ÙŠÙƒÙ„</th>
                    `;
                });
                
                html += `
                        <th style="padding: 5px; border: 1px solid #000; text-align: center; background: #fff3e0; font-weight: bold;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³ÙŠØ§Ø±Ø§Øª</th>
                        <th style="padding: 5px; border: 1px solid #000; text-align: center; background: #e8f5e9; font-weight: bold;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø³ÙŠÙƒÙ„</th>
                        <th style="padding: 5px; border: 1px solid #000; text-align: center; background: #f3e5f5; font-weight: bold;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                    </tr>
                </thead>
                <tbody>
                `;
                
                // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
                const monthlyTotals = {};
                selectedMonths.forEach(month => {
                    monthlyTotals[month] = {
                        carSalary: 0,
                        bikeSalary: 0,
                        totalSalary: 0
                    };
                });
                
                // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø·Ø§Ø¹Ù…
                const restaurantArray = Array.from(allRestaurants).filter(r => r && r !== 'ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ');
                restaurantArray.forEach((restaurant, index) => {
                    const rowBgColor = index % 2 === 0 ? '#ffffff' : '#f9f9f9';
                    html += `<tr style="background: ${rowBgColor};">`;
                    html += `<td style="padding: 5px; border: 1px solid #ddd; text-align: right; font-weight: bold;">${restaurant}</td>`;
                    
                    // Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø³Ù†Ø© Ù„Ù„Ù…Ø·Ø¹Ù…
                    let restaurantYearCarSalary = 0;
                    let restaurantYearBikeSalary = 0;
                    let restaurantYearTotalSalary = 0;
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø¨ÙŠØ§Ù†Ø§Øª ÙƒÙ„ Ø´Ù‡Ø±
                    selectedMonths.forEach(month => {
                        const stats = restaurantStats[month][restaurant] || { carSalary: 0, bikeSalary: 0, totalSalary: 0 };
                        
                        html += `
                            <td style="padding: 5px; border: 1px solid #ddd; text-align: center;">${stats.carSalary.toFixed(3)}</td>
                            <td style="padding: 5px; border: 1px solid #ddd; text-align: center;">${stats.bikeSalary.toFixed(3)}</td>
                        `;
                        
                        // ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
                        monthlyTotals[month].carSalary += stats.carSalary;
                        monthlyTotals[month].bikeSalary += stats.bikeSalary;
                        monthlyTotals[month].totalSalary += stats.totalSalary;
                        
                        // ØªØ­Ø¯ÙŠØ« Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø³Ù†Ø© Ù„Ù„Ù…Ø·Ø¹Ù…
                        restaurantYearCarSalary += stats.carSalary;
                        restaurantYearBikeSalary += stats.bikeSalary;
                        restaurantYearTotalSalary += stats.totalSalary;
                    });
                    
                    // Ø¥Ø¶Ø§ÙØ© Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø³Ù†Ø© Ù„Ù„Ù…Ø·Ø¹Ù…
                    html += `
                        <td style="padding: 5px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${restaurantYearCarSalary.toFixed(3)}</td>
                        <td style="padding: 5px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${restaurantYearBikeSalary.toFixed(3)}</td>
                        <td style="padding: 5px; border: 1px solid #ddd; text-align: center; font-weight: bold;">${restaurantYearTotalSalary.toFixed(3)}</td>
                    `;
                    
                    html += `</tr>`;
                });
                
                // Ø¥Ø¶Ø§ÙØ© ØµÙ Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©
                html += `<tr style="background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white; font-weight: bold;">`;
                html += `<td style="padding: 5px; border: 1px solid #000; text-align: right;"><strong>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø´Ù‡Ø±</strong></td>`;
                
                selectedMonths.forEach(month => {
                    const totals = monthlyTotals[month];
                    html += `
                        <td style="padding: 5px; border: 1px solid #000; text-align: center;"><strong>${totals.carSalary.toFixed(3)}</strong></td>
                        <td style="padding: 5px; border: 1px solid #000; text-align: center;"><strong>${totals.bikeSalary.toFixed(3)}</strong></td>
                    `;
                });
                
                // Ø­Ø³Ø§Ø¨ Ø¥Ø¬Ù…Ø§Ù„ÙŠØ§Øª Ø§Ù„Ø³Ù†Ø© Ø§Ù„ÙƒÙ„ÙŠØ©
                let yearTotalCarSalary = 0;
                let yearTotalBikeSalary = 0;
                let yearTotalAllSalary = 0;
                
                selectedMonths.forEach(month => {
                    const totals = monthlyTotals[month];
                    yearTotalCarSalary += totals.carSalary;
                    yearTotalBikeSalary += totals.bikeSalary;
                    yearTotalAllSalary += totals.totalSalary;
                });
                
                html += `
                    <td style="padding: 5px; border: 1px solid #000; text-align: center;"><strong>${yearTotalCarSalary.toFixed(3)}</strong></td>
                    <td style="padding: 5px; border: 1px solid #000; text-align: center;"><strong>${yearTotalBikeSalary.toFixed(3)}</strong></td>
                    <td style="padding: 5px; border: 1px solid #000; text-align: center;"><strong>${yearTotalAllSalary.toFixed(3)}</strong></td>
                `;
                
                html += `</tr>`;
                
                html += `</tbody></table>`;
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
                html += `
                    <div style="margin-top: 20px; padding-top: 10px; border-top: 1px solid #ddd; text-align: left; font-size: 8px; color: #d32f2f;">
                        Yasser Elkhateeb - Ù…Ø·ÙˆØ± Ø§Ù„Ø¨Ø±Ù†Ø§Ù…Ø¬ 67011143
                    </div>
                `;
                
                tempDiv.innerHTML = html;
                document.body.appendChild(tempDiv);
                
                // Ø§Ø³ØªØ®Ø¯Ø§Ù… html2canvas Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØµÙˆØ±Ø©
                const canvas = await html2canvas(tempDiv, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#FFFFFF',
                    width: 794,
                    height: tempDiv.scrollHeight,
                    windowWidth: 794,
                    windowHeight: tempDiv.scrollHeight
                });
                
                // Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¹Ù†ØµØ± Ø§Ù„Ù…Ø¤Ù‚Øª
                document.body.removeChild(tempDiv);
                
                const imgData = canvas.toDataURL('image/jpeg', 0.95);
                const pdf = new window.jspdf.jsPDF('p', 'pt', 'a4');
                
                const imgWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                let imgHeight = (canvas.height * imgWidth) / canvas.width;
                let heightLeft = imgHeight;
                let position = 0;
                
                // Ø­Ø³Ø§Ø¨ Ø¹Ø¯Ø¯ Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
                const totalPDFPages = Math.ceil(imgHeight / pageHeight);
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰
                pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                heightLeft -= pageHeight;
                
                // Ø¥Ø¶Ø§ÙØ© Ø§Ù„ØµÙØ­Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ© Ø¥Ø°Ø§ Ù„Ø²Ù… Ø§Ù„Ø£Ù…Ø±
                for (let i = 1; i < totalPDFPages; i++) {
                    position = -i * pageHeight;
                    pdf.addPage();
                    pdf.addImage(imgData, 'JPEG', 0, position, imgWidth, imgHeight);
                }
                
                const fileName = `Ø¬Ø¯ÙˆÙ„_Ù…Ø·Ø§Ø¹Ù…_${selectedManager}_${selectedMonths.length}_Ø´Ù‡Ø±.pdf`;
                pdf.save(fileName);
                
            } catch (error) {
                console.error('Error generating restaurant comparison PDF:', error);
                alert('Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù PDF: ' + error.message);
            } finally {
                hideLoading();
            }
        }

        function resetView() {
            document.getElementById('searchCompany').value = '';
            document.getElementById('searchDistributor').value = '';
            document.getElementById('searchVehicle').value = '';
            document.getElementById('searchRestaurant').value = '';
            document.getElementById('searchManager').value = '';
            
            currentPage = 1;
            filteredData = [];
            showReport(currentMonth);
            switchTab('report');
            managerSelector.style.display = 'none';
        }

        function showLoading() {
            loadingDiv.style.display = 'block';
        }

        function hideLoading() {
            loadingDiv.style.display = 'none';
        }

        function showError(message) {
            errorDiv.textContent = message;
            errorDiv.style.display = 'block';
        }

        function hideError() {
            errorDiv.style.display = 'none';
        }

        // Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…Ø§Ø· Ø§Ù„ØªÙˆÙ‚ÙŠØ¹
        const style = document.createElement('style');
        style.textContent = `
            .signature-card {
                position: fixed;
                bottom: 20px;
                left: 20px;
                background: linear-gradient(135deg, #FF6E00, #2196F3);
                color: white;
                padding: 10.5px 17.5px;
                border-radius: 8.5px;
                box-shadow: 0 8px 25px rgba(0,0,0,0.3);
                font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
                font-size: 0.8rem;
                font-weight: 600;
                z-index: 1000;
                animation: float 6s ease-in-out infinite;
                transition: all 0.3s ease;
                cursor: pointer;
                border: 2px solid rgba(255,255,255,0.2);
            }
            
            .signature-card:hover { 
                transform: scale(1.05); 
                box-shadow: 0 12px 35px rgba(0,0,0,0.4); 
            }
            
            @keyframes float { 
                0% { transform: translateY(0px); } 
                50% { transform: translateY(-15px); } 
                100% { transform: translateY(0px); } 
            }
            
            .signature-card::before {
                content: '';
                position: absolute;
                top: -2px; left: -2px; right: -2px; bottom: -2px;
                background: linear-gradient(135deg, #80EF80, #2196F3);
                border-radius: 14px;
                z-index: -1;
                animation: borderGlow 3s linear infinite;
                background-size: 400%;
            }
            
            @keyframes borderGlow { 
                0% { background-position: 0% 50%; } 
                50% { background-position: 100% 50%; } 
                100% { background-position: 0% 50%; } 
            }
            
            .signature-card .name { 
                font-size: 0.95rem; 
                font-weight: 700; 
                margin-bottom: 5px; 
                text-shadow: 1px 1px 2px rgba(0,0,0,0.3); 
            }
            
            .signature-card .title { 
                font-size: 0.7rem; 
                opacity: 0.9; 
                font-weight: 500; 
            }
            
            @media (max-width: 768px) { 
                .signature-card { 
                    position: relative; 
                    bottom: auto; 
                    left: auto; 
                    margin: 20px auto 0; 
                    width: fit-content; 
                    animation: none; 
                } 
                .signature-card:hover { 
                    transform: none; 
                } 
            }
            
            @media print {
                .signature-card {
                    display: none;
                }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
